(function(){"use strict";var t={4972:function(t,e,a){var i=a(2856),s=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},o=[],l={name:"App"},n=l,r=a(1656),c=(0,r.A)(n,s,o,!1,null,null,null),d=c.exports,u=a(184),h=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("div",{staticClass:"login-container"},[e("h1",{staticStyle:{"margin-left":"10px"}},[t._v(" Panel "),e("span",{staticClass:"toggle-icon-container",on:{mouseenter:function(e){t.showExtraIcons=!0},mouseleave:function(e){t.showExtraIcons=!1}}},[e("img",{attrs:{src:a(8902),alt:"switch",loading:"lazy"},on:{click:function(e){return t.switchToIndex()}}}),e("transition",{attrs:{name:"fade"}},[t.showExtraIcons?e("div",{staticClass:"extra-icons"},[e("img",{attrs:{src:a(7343),alt:"Icon 2",loading:"lazy"},on:{click:function(e){return t.navigateTo("pandora")}}}),e("img",{attrs:{src:a(864),alt:"Icon 1",loading:"lazy"},on:{click:function(e){return t.navigateTo("claude")}}})]):t._e()])],1)]),e("form",{on:{submit:function(e){return e.preventDefault(),t.userlogin()}}},[e("input",{attrs:{type:"text",id:"username",placeholder:"用户名",required:""}}),e("input",{attrs:{type:"password",id:"password",placeholder:"密码",required:""}}),t._m(0)]),t._m(1),e("div",{staticClass:"alternative-login"},[e("div",{staticClass:"oauth-buttons"},[e("img",{attrs:{src:a(4832),alt:"LINUX DO",loading:"lazy"},on:{click:function(e){return t.initiateOAuth()}}})]),e("button",{attrs:{type:"button"},on:{click:function(e){return t.reset()}}},[t._v("重置密码")])]),e("div",{staticClass:"footer",on:{click:function(e){return t.index()}}},[e("a",{attrs:{href:"https://github.com/Kylsky/pandora-helper-with-linux-do-oauth",target:"_blank"}},[t._v("Powered by Yeelo")])])])])},p=[function(){var t=this,e=t._self._c;return e("button",{attrs:{type:"submit"}},[e("span",{staticClass:"btn-text"},[t._v("登录")]),e("span",{staticClass:"spinner"})])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"divider"},[e("span",[t._v("OR")])])}],m=a(7423);const f={apiBaseUrl:"https://connect.yeelo.fun"},g=async()=>{try{const t=await m.A.get("/oauth2/config");console.log(t.data),f.apiBaseUrl=t.data||f.apiBaseUrl}catch(t){console.error("Error loading config:",t)}};var v=f;a(4114);const b=m.A.create({baseURL:"https://127.0.0.1:8080",headers:{"Content-Type":"application/json"},timeout:1e4});b.interceptors.response.use((t=>t),(t=>{const{response:e}=t;if(console.log(t),e){if(302===e.status){const t=e.headers["location"];t&&(window.location.href=t)}401!==e.status&&403!==e.status||de.push({path:"/"})}return Promise.reject(t)}));var y=b,w=a(2457),C=a.n(w);const _={success(t,e=3e3){(0,w.Message)({message:t,type:"success",duration:e,showClose:!0,customClass:"custom-message"})},error(t,e=3e3){(0,w.Message)({message:t,type:"error",duration:e,showClose:!0,customClass:"custom-message"})},warning(t,e=3e3){(0,w.Message)({message:t,type:"warning",duration:e,showClose:!0,customClass:"custom-message"})},info(t,e=3e3){(0,w.Message)({message:t,type:"info",duration:e,showClose:!0,customClass:"custom-message"})},handleResponse(t,e="操作成功"){return t.data.status?(this.success(e),!0):(this.error(t.data.message||"操作失败"),!1)},handleError(t){t.response?this.error(t.response.data.message||"请求失败"):t.request?this.error("网络连接失败，请检查网络"):this.error("请求配置错误")}};var k=_,x={name:"IndexPage",props:{},data(){return{showExtraIcons:!1}},methods:{reset(){this.$router.replace({name:"reset"})},async userlogin(){const t=document.querySelector('button[type="submit"]');t.classList.add("loading");var e=document.getElementById("username").value,a=document.getElementById("password").value;try{const i=await y.post(`${v.apiBaseUrl}/user/login`,{username:e,password:a});this.loading=!1;const s=i.data.status;if(!s)return k.error(i.data.message),t.classList.remove("loading"),!1;const o=i.data,l=o.data.jwt,n=o.data.avatarUrl;localStorage.setItem("token",l),n&&localStorage.setItem("img",n),t.classList.remove("loading"),this.$router.replace({name:"navi"})}catch(s){t.classList.remove("loading");var i=i;k.error(i)}},async initiateOAuth(){try{const e=await y.get(`${v.apiBaseUrl}/oauth2/initiate?type=panel`);var t=e;console.log(t),t.data?window.location=t.data:console.error("No redirect URL provided")}catch(e){console.error("Request failed with status:",e)}},switchToIndex(){},navigateTo(t){this.$router.replace({name:t})}}},I=x,S=(0,r.A)(I,h,p,!1,null,"4204244c",null),F=S.exports,A=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"reset"}},[e("div",{staticClass:"reset-container"},[e("h1",[t._v("重置密码")]),e("form",{on:{submit:function(e){return e.preventDefault(),t.resetPassword()}}},[t._m(0),e("div",{staticClass:"button-group"},[t._m(1),e("button",{staticClass:"home-button",attrs:{type:"button"},on:{click:function(e){return t.goHome()}}},[t._v("返回主页")])])]),t._m(2)])])},P=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"input-group"},[e("input",{attrs:{type:"text",id:"username",placeholder:"用户名",required:""}}),e("input",{attrs:{type:"password",id:"oldPassword",placeholder:"旧密码",required:""}}),e("input",{attrs:{type:"password",id:"newPassword",placeholder:"新密码",required:""}}),e("input",{attrs:{type:"password",id:"confirmPassword",placeholder:"再次确认新密码",required:""}})])},function(){var t=this,e=t._self._c;return e("button",{staticClass:"primary-button",attrs:{type:"submit"}},[e("span",{staticClass:"btn-text"},[t._v("重置")]),e("span",{staticClass:"spinner"})])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"footer"},[e("span",[t._v("Powered by Yeelo")])])}],V={name:"ResetPage",methods:{async resetPassword(){var t=document.getElementById("username").value,e=document.getElementById("oldPassword").value,a=document.getElementById("newPassword").value,i=document.getElementById("confirmPassword").value;if(e===a)return alert("新密码不能和旧密码相同，请重新输入。"),!1;if(a.length<8)return alert("密码长度必须超过大于等于8位，请重新输入。"),!1;if(a!==i)return alert("两次输入的密码不一致，请重新输入。"),!1;try{const s=await y.post(`${v.apiBaseUrl}/pandora/reset`,{username:t,oldPassword:e,newPassword:a,confirmPassword:i}),o=s.data.status;o?(alert("密码重置成功！"),this.$router.replace({name:"home"})):alert(s.data.message)}catch(s){alert(s)}},async goHome(){this.$router.replace({name:"home"})}}},D=V,T=(0,r.A)(D,A,P,!1,null,"43f6b99a",null),M=T.exports,$=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"pandora"}},[e("div",{staticClass:"login-container"},[e("h1",{staticStyle:{"margin-left":"10px"}},[t._v(" Pandora "),e("span",{staticClass:"toggle-icon-container",on:{mouseenter:function(e){t.showExtraIcons=!0},mouseleave:function(e){t.showExtraIcons=!1}}},[e("img",{attrs:{src:a(8902),alt:"switch",loading:"lazy"},on:{click:function(e){return t.switchToFuclaude()}}}),e("transition",{attrs:{name:"fade"}},[t.showExtraIcons?e("div",{staticClass:"extra-icons"},[e("img",{attrs:{src:a(7343),alt:"Icon 2",loading:"lazy"},on:{click:function(e){return t.navigateTo("pandora")}}}),e("img",{attrs:{src:a(864),alt:"Icon 1",loading:"lazy"},on:{click:function(e){return t.navigateTo("claude")}}})]):t._e()])],1)]),e("form",{on:{submit:function(e){return e.preventDefault(),t.userlogin()}}},[e("input",{attrs:{type:"text",id:"username",placeholder:"用户名",required:""}}),e("input",{attrs:{type:"password",id:"password",placeholder:"密码",required:""}}),t._m(0)]),t._m(1),e("div",{staticClass:"alternative-login"},[e("div",{staticClass:"oauth-buttons"},[e("img",{attrs:{src:a(4832),alt:"LINUX DO",loading:"lazy"},on:{click:function(e){return t.initiateOAuth()}}})]),e("button",{attrs:{type:"button"},on:{click:function(e){return t.reset()}}},[t._v("重置密码")])]),t._m(2)])])},z=[function(){var t=this,e=t._self._c;return e("button",{attrs:{type:"submit"}},[e("span",{staticClass:"btn-text"},[t._v("登录")]),e("span",{staticClass:"spinner"})])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"divider"},[e("span",[t._v("OR")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"footer"},[e("a",{attrs:{href:"https://github.com/Kylsky/pandora-helper-with-linux-do-oauth",target:"_blank"}},[t._v("Powered by Pandora")])])}],B={name:"PandoraPage",data(){return{showExtraIcons:!1}},methods:{reset(){this.$router.replace({name:"reset"})},async userlogin(){const t=document.querySelector('button[type="submit"]');t.classList.add("loading");var e=document.getElementById("username").value,a=document.getElementById("password").value;try{const s=await y.post(`${v.apiBaseUrl}/pandora/login`,{username:e,password:a}),o=s.data.status;if(o)t.classList.remove("loading"),window.open(s.data.data);else{var i=s.data.message;t.classList.remove("loading"),k.error(i)}}catch(s){t.classList.remove("loading"),k.error(s)}},async initiateOAuth(){try{const e=await y.get(`${v.apiBaseUrl}/oauth2/initiate?type=ChatGPT`);var t=e;t.data?window.location=t.data:console.error("No redirect URL provided")}catch(e){k.error(e)}},switchToFuclaude(){this.$router.replace({name:"home"})},navigateTo(t){this.$router.replace({name:t})}}},E=B,L=(0,r.A)(E,$,z,!1,null,"c71a0b6c",null),U=L.exports,q=function(){var t=this;t._self._c;return t._m(0)},N=[function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"loading"}},[e("div",{staticClass:"loading-container"},[e("div",{staticClass:"loader-wrapper"},[e("div",{staticClass:"loader"}),e("div",{staticClass:"loader-inner"})]),e("p",{staticClass:"message"},[t._v("正在授权，请稍候...")]),e("p",{staticClass:"sub-message"},[t._v("Loading...")])])])}],O=(a(4603),a(7566),a(8721),{name:"LoadingPage",methods:{async fetchToken(t,e){console.log(t,e);const a=await y.get(`${v.apiBaseUrl}/oauth2/callback?code=${t}&state=${e}`,{withCredentials:!0});if(a.data.status){let t=JSON.parse(a.data.data);console.log(t.avatar_url),localStorage.setItem("img",t.avatar_url),"ChatGPT"===t.shareType?await this.startGPTChat(t.username,t.jmc):"Claude"===t.shareType?await this.startClaudeChat(t.username,t.jmc):"panel"===t.shareType&&await this.startPanel(t.username,t.jmc)}},async startGPTChat(t,e){const a=await y.get(`${v.apiBaseUrl}/pandora/checkUser?username=${t}&jmc=${e}`,{withCredentials:!0});a.data.status&&a.data.data.isShared?window.open(a.data.data.address):(k.error("您的账号未激活，请联系管理员"),this.$router.replace({name:"pandora"}))},async startClaudeChat(t,e){const a=await y.get(`${v.apiBaseUrl}/fuclaude/checkUser?username=${t}&jmc=${e}`,{withCredentials:!0});a.data.status?window.open(a.data.data):(k.error("您的账号未激活，请联系管理员"),this.$router.replace({name:"claude"}))},async startPanel(t,e){console.log("hi");const a=await y.get(`${v.apiBaseUrl}/share/checkUser?username=${t}&jmc=${e}`,{withCredentials:!0});a.data.status?(localStorage.setItem("token",a.data.data),this.$router.replace({name:"navi"})):(k.error(a.data.message),this.$router.replace({name:""}))}},mounted(){const t=new URL(window.location.href),e=new URLSearchParams(t.search),a=e.get("code"),i=e.get("state");a&&i&&this.fetchToken(a,i)}}),R=O,j=(0,r.A)(R,q,N,!1,null,"26bcbb86",null),G=j.exports,K=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"claude"}},[e("div",{staticClass:"login-container"},[e("h1",{staticStyle:{"margin-left":"10px"}},[t._v(" Fuclaude "),e("span",{staticClass:"toggle-icon-container",on:{mouseenter:function(e){t.showExtraIcons=!0},mouseleave:function(e){t.showExtraIcons=!1}}},[e("img",{attrs:{src:a(8902),alt:"switch",loading:"lazy"},on:{click:function(e){return t.switchToPandora()}}}),e("transition",{attrs:{name:"fade"}},[t.showExtraIcons?e("div",{staticClass:"extra-icons"},[e("img",{attrs:{src:a(7343),alt:"Icon 2",loading:"lazy"},on:{click:function(e){return t.navigateTo("pandora")}}}),e("img",{attrs:{src:a(864),alt:"Icon 1",loading:"lazy"},on:{click:function(e){return t.navigateTo("claude")}}})]):t._e()])],1)]),e("form",{on:{submit:function(e){return e.preventDefault(),t.userlogin()}}},[e("input",{attrs:{type:"text",id:"username",placeholder:"用户名",required:""}}),e("input",{attrs:{type:"password",id:"password",placeholder:"密码",required:""}}),t._m(0)]),t._m(1),e("div",{staticClass:"alternative-login"},[e("div",{staticClass:"oauth-buttons"},[e("img",{attrs:{src:a(4832),alt:"LINUX DO",loading:"lazy"},on:{click:function(e){return t.initiateOAuth()}}})]),e("button",{attrs:{type:"button"},on:{click:function(e){return t.reset()}}},[t._v("重置密码")])]),t._m(2)])])},Q=[function(){var t=this,e=t._self._c;return e("button",{attrs:{type:"submit"}},[e("span",{staticClass:"btn-text"},[t._v("登录")]),e("span",{staticClass:"spinner"})])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"divider"},[e("span",[t._v("OR")])])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"footer"},[e("span",[t._v("Powered by Fuclaude")])])}],Y={name:"ClaudePage",data(){return{showExtraIcons:!1}},methods:{reset(){this.$router.replace({name:"reset"})},async userlogin(){const t=document.querySelector('button[type="submit"]');t.classList.add("loading");var e=document.getElementById("username").value,a=document.getElementById("password").value;try{const s=await y.post(`${v.apiBaseUrl}/fuclaude/login`,{username:e,password:a}),o=s.data.status;if(o)t.classList.remove("loading"),window.open(s.data.data);else{t.classList.remove("loading");var i=s.data.message;alert(i)}}catch(s){t.classList.remove("loading"),alert(s)}},async initiateOAuth(){try{const e=await y.get(`${v.apiBaseUrl}/oauth2/initiate?type=Claude`);var t=e;console.log(t),t.data?window.location=t.data:console.error("No redirect URL provided")}catch(e){alert(e)}},switchToPandora(){this.$router.replace({name:"home"})},navigateTo(t){this.$router.replace({name:t})}}},H=Y,W=(0,r.A)(H,K,Q,!1,null,"4d7a63e3",null),X=W.exports,J=function(){var t=this,e=t._self._c;return e("el-container",{attrs:{id:"navi"}},[t.isMobile&&!t.isCollapse?e("div",{staticClass:"mobile-overlay",on:{click:t.toggleCollapse}}):t._e(),e("el-aside",{class:["sidebar",{"mobile-sidebar":t.isMobile,collapsed:t.isCollapse}],attrs:{width:t.getSidebarWidth}},[e("div",{staticClass:"sidebar-header"},[e("h2",{directives:[{name:"show",rawName:"v-show",value:!t.isCollapse,expression:"!isCollapse"}],staticClass:"site-title"},[t._v("Pandora Helper")]),t.isMobile?t._e():e("el-button",{staticClass:"collapse-btn",attrs:{icon:t.isCollapse?"el-icon-s-unfold":"el-icon-s-fold"},on:{click:t.toggleCollapse}})],1),e("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":"accountNav","background-color":"#ffffff","text-color":"#333","active-text-color":"#fff",collapse:t.isCollapse,"collapse-transition":!1},on:{select:t.handleMenuSelect}},[e("el-menu-item",{attrs:{index:"accountNav"}},[e("i",{staticClass:"el-icon-s-custom"}),e("span",{attrs:{slot:"title"},slot:"title"},[t._v("账号管理")])]),e("el-menu-item",{attrs:{index:"shareNav"}},[e("i",{staticClass:"el-icon-share"}),e("span",{attrs:{slot:"title"},slot:"title"},[t._v("分享管理")])]),e("el-menu-item",{attrs:{index:"redemptionNav"}},[e("i",{staticClass:"el-icon-shopping-cart-full"}),e("span",{attrs:{slot:"title"},slot:"title"},[t._v("兑换码")])]),e("el-menu-item",{attrs:{index:"carNav"}},[e("i",{staticClass:"el-icon-truck"}),e("span",{attrs:{slot:"title"},slot:"title"},[t._v("停车场")])]),e("el-menu-item",{attrs:{index:"freeNav"}},[e("i",{staticClass:"el-icon-medal"}),e("span",{attrs:{slot:"title"},slot:"title"},[t._v("免费号池")])])],1),e("el-dropdown",{staticClass:"user-menu",attrs:{trigger:"click","popper-class":"user-dropdown"}},[e("span",{staticClass:"el-dropdown-link"},[e("el-avatar",{staticClass:"user-avatar",attrs:{size:40,src:t.avatar}})],1),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e("el-dropdown-item",{nativeOn:{click:function(e){return t.showModal.apply(null,arguments)}}},[e("i",{staticClass:"el-icon-key"}),e("span",[t._v("兑换码激活")])]),e("el-dropdown-item",{nativeOn:{click:function(e){return t.showResetModal.apply(null,arguments)}}},[e("i",{staticClass:"el-icon-refresh"}),e("span",[t._v("重置密码")])]),e("el-dropdown-item",{nativeOn:{click:function(e){return t.logout.apply(null,arguments)}}},[e("i",{staticClass:"el-icon-switch-button"}),e("span",[t._v("退出登录")])])],1)],1)],1),e("el-main",{class:["main-content",{"mobile-main":t.isMobile}]},[t.isMobile&&t.isCollapse?e("div",{staticClass:"menu-trigger",on:{click:t.toggleCollapse}},[e("i",{staticClass:"el-icon-s-operation"})]):t._e(),e("enhanced-dialog",{attrs:{isVisible:t.modalVisible,title:t.modalTitle},on:{close:t.closeModal,confirm:t.submitForm}},t._l(t.formFields,(function(a,i){return e("form-input",{key:i,attrs:{field:a},on:{updateValue:t.handleUpdateValue}})})),1),e("enhanced-dialog",{attrs:{isVisible:t.resetModalVisible,title:"重置密码"},on:{close:t.closeResetModal,confirm:t.submitResetForm}},t._l(t.resetFormFields,(function(a,i){return e("form-input",{key:i,attrs:{field:a},on:{updateValue:t.handleResetUpdateValue}})})),1),e(t.currentComponent,{tag:"component"})],1)],1)},Z=[],tt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"form-group"},[t.field.hideLabel?t._e():e("label",{staticClass:"form-label",attrs:{for:t.field.id}},[t._v(t._s(t.field.label))]),"checkbox"===t.field.type&&!t.field.hideLabel&&"number"===t.field.type|"text"===t.field.type|"date"===t.field.type|"password"===t.field.type?e("input",{directives:[{name:"model",rawName:"v-model",value:t.localValue,expression:"localValue"}],staticClass:"form-input",attrs:{id:t.field.id,type:"checkbox"},domProps:{checked:Array.isArray(t.localValue)?t._i(t.localValue,null)>-1:t.localValue},on:{change:function(e){var a=t.localValue,i=e.target,s=!!i.checked;if(Array.isArray(a)){var o=null,l=t._i(a,o);i.checked?l<0&&(t.localValue=a.concat([o])):l>-1&&(t.localValue=a.slice(0,l).concat(a.slice(l+1)))}else t.localValue=s}}}):"radio"===t.field.type&&!t.field.hideLabel&&"number"===t.field.type|"text"===t.field.type|"date"===t.field.type|"password"===t.field.type?e("input",{directives:[{name:"model",rawName:"v-model",value:t.localValue,expression:"localValue"}],staticClass:"form-input",attrs:{id:t.field.id,type:"radio"},domProps:{checked:t._q(t.localValue,null)},on:{change:function(e){t.localValue=null}}}):!t.field.hideLabel&&"number"===t.field.type|"text"===t.field.type|"date"===t.field.type|"password"===t.field.type?e("input",{directives:[{name:"model",rawName:"v-model",value:t.localValue,expression:"localValue"}],staticClass:"form-input",attrs:{id:t.field.id,type:t.field.type},domProps:{value:t.localValue},on:{input:function(e){e.target.composing||(t.localValue=e.target.value)}}}):t._e(),"select"===t.field.type?e("select",{directives:[{name:"model",rawName:"v-model",value:t.localValue,expression:"localValue"}],staticClass:"form-select",attrs:{id:t.field.id},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.localValue=e.target.multiple?a:a[0]},function(e){return t.handleSelectChange(e)}]}},t._l(t.field.options,(function(a){return e("option",{key:a.value,domProps:{value:a.value}},[t._v(" "+t._s(a.text)+" ")])})),0):t._e(),"checkbox"===t.field.type?e("div",{staticClass:"switch-wrapper"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.localValue,expression:"localValue"}],staticClass:"switch-input",attrs:{type:"checkbox",id:t.field.id},domProps:{checked:Array.isArray(t.localValue)?t._i(t.localValue,null)>-1:t.localValue},on:{change:function(e){var a=t.localValue,i=e.target,s=!!i.checked;if(Array.isArray(a)){var o=null,l=t._i(a,o);i.checked?l<0&&(t.localValue=a.concat([o])):l>-1&&(t.localValue=a.slice(0,l).concat(a.slice(l+1)))}else t.localValue=s}}}),e("label",{staticClass:"switch-label",attrs:{for:t.field.id}},[e("span",{staticClass:"switch-button"})])]):t._e()])},et=[],at={props:{field:Object},data(){return{localValue:this.initializeValue()}},methods:{initializeValue(){return"select"===this.field.type&&this.field.options&&this.field.options.length>0?this.field.value||this.field.options[0].value:this.field.value},handleSelectChange(t){const e=t.target.value;this.$emit("handleSelectChange",{type:1,field:this.field,value:e})}},watch:{localValue(t){this.$emit("updateValue",this.field.id,t)},field:{handler(){this.localValue=this.initializeValue()},deep:!0,immediate:!0}}},it=at,st=(0,r.A)(it,tt,et,!1,null,"2886aa49",null),ot=st.exports,lt=function(){var t=this,e=t._self._c;return e("transition",{attrs:{name:"modal"}},[t.isVisible?e("div",{staticClass:"modal-overlay",on:{click:t.close}},[e("div",{staticClass:"modal-content",attrs:{role:"dialog","aria-modal":"true","aria-labelledby":t.title},on:{click:function(t){t.stopPropagation()}}},[e("header",{staticClass:"modal-header"},[e("h3",{attrs:{id:t.title}},[t._v(t._s(t.title))]),e("button",{staticClass:"close-button",attrs:{"aria-label":"关闭对话框"},on:{click:t.close}},[e("svg",{staticClass:"close-icon",attrs:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"}},[e("path",{attrs:{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"}})])])]),e("main",{staticClass:"modal-body"},[t._t("default")],2),e("footer",{staticClass:"modal-footer"},[e("button",{staticClass:"btn btn-cancel",on:{click:t.close}},[t._v("取消")]),e("button",{staticClass:"btn btn-confirm",on:{click:t.confirm}},[t._v("确认")])])])]):t._e()])},nt=[],rt={props:{isVisible:{type:Boolean,default:!1},title:{type:String,default:"标题"}},mounted(){this.isVisible&&this.preventBodyScroll(),window.addEventListener("keydown",this.handleKeydown)},beforeDestroy(){this.enableBodyScroll(),window.removeEventListener("keydown",this.handleKeydown)},watch:{isVisible(t){t?this.preventBodyScroll():this.enableBodyScroll()}},methods:{close(){this.$emit("close")},confirm(){this.$emit("confirm")},handleKeydown(t){this.isVisible&&"Escape"===t.key&&this.close()},preventBodyScroll(){document.body.style.overflow="hidden",document.body.style.position="fixed",document.body.style.width="100%"},enableBodyScroll(){document.body.style.overflow="",document.body.style.position="",document.body.style.width=""}}},ct=rt,dt=(0,r.A)(ct,lt,nt,!1,null,"7ff1380e",null),ut=dt.exports,ht=function(){var t=this,e=t._self._c;return e("el-container",{staticClass:"panel",attrs:{id:"accountPanel"}},[e("el-header",[e("h2",[t._v("账号管理")])]),e("el-main",[e("el-row",{staticClass:"search-bar",attrs:{gutter:20}},[e("el-col",{attrs:{xs:24,sm:24,md:18}},[e("el-input",{staticClass:"search-input",attrs:{id:"email-query",placeholder:"请输入邮箱"},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}},[e("el-button",{attrs:{slot:"append"},on:{click:t.emailQuery},slot:"append"},[t._v("查询")])],1)],1),e("el-col",{staticClass:"create-btn-wrapper",attrs:{xs:24,sm:24,md:6}},[e("el-button",{staticClass:"create-new",attrs:{type:"primary"},on:{click:function(e){return t.showModal()}}},[t._v("新增")])],1)],1),t.isMobile?e("div",{staticClass:"mobile-view"},t._l(t.tableData,(function(a,i){return e("div",{key:i,staticClass:"mobile-card"},[e("div",{staticClass:"mobile-card-header"},[e("div",{staticClass:"email-badge"},[e("i",{staticClass:"el-icon-message"}),t._v(" "+t._s(a.email)+" ")]),e("div",{staticClass:"status-badge",class:{"status-shared":1===a.shared}},[t._v(" "+t._s(1===a.shared?"已共享":"未共享")+" ")])]),e("div",{staticClass:"mobile-card-content"},[e("div",{staticClass:"info-row"},[e("div",{staticClass:"info-item"},[e("div",{staticClass:"info-label"},[e("i",{staticClass:"el-icon-user"}),t._v(" 账号类型 ")]),e("div",{staticClass:"info-value"},[t._v(t._s(a.type))])]),e("div",{staticClass:"info-item"},[e("div",{staticClass:"info-label"},[e("i",{staticClass:"el-icon-time"}),t._v(" 更新时间 ")]),e("div",{staticClass:"info-value"},[t._v(t._s(a.updateTime))])])])]),e("div",{staticClass:"mobile-card-divider"}),e("div",{staticClass:"mobile-card-actions"},[e("div",{staticClass:"action-row"},[1===a.accountType?e("el-button",{attrs:{type:"info",size:"mini"},on:{click:function(e){return t.refresh(a.id)}}},[e("i",{staticClass:"el-icon-refresh"}),t._v(" 刷新 ")]):t._e(),e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.showShareModal(a.id)}}},[e("i",{staticClass:"el-icon-share"}),t._v(" 共享 ")]),e("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(e){return t.editItem(a.id)}}},[e("i",{staticClass:"el-icon-edit"}),t._v(" 编辑 ")])],1),e("div",{staticClass:"action-row"},[e("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){return t.showConfirmDialog(a.id)}}},[e("i",{staticClass:"el-icon-delete"}),t._v(" 删除 ")])],1)])])})),0):e("div",{staticClass:"pc-view"},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData,fit:!0}},[e("el-table-column",{attrs:{prop:"email",label:"邮箱","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{prop:"type",label:"账号类型","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{prop:"shared",label:"共享","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(t){return[1===t.row.shared?e("i",{staticClass:"el-icon-circle-check",staticStyle:{color:"green"}}):e("i",{staticClass:"el-icon-circle-close",staticStyle:{color:"red"}})]}}],null,!1,3895160449)}),e("el-table-column",{attrs:{prop:"updateTime",label:"更新时间"}}),e("el-table-column",{attrs:{label:"操作",width:"350"},scopedSlots:t._u([{key:"default",fn:function(a){return[1===a.row.accountType?e("el-button",{attrs:{type:"info",size:"mini"},on:{click:function(e){return t.refresh(a.row.id)}}},[t._v("刷新")]):t._e(),e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.showShareModal(a.row.id)}}},[t._v("共享")]),e("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(e){return t.editItem(a.row.id)}}},[t._v("编辑")]),e("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(e){return t.showConfirmDialog(a.row.id)}}},[t._v("删除")])]}}],null,!1,274029531)})],1)],1),e("div",{staticClass:"pagination-container"},[e("el-pagination",{staticClass:"pagination-wrapper",attrs:{"current-page":t.currentPage,"page-size":t.pageSize,layout:t.isMobile?"prev, pager, next":"total, prev, pager, next, jumper","pager-count":t.isMobile?5:7,total:t.total},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e}}})],1),t.modalVisible?e("enhanced-dialog",{attrs:{isVisible:t.modalVisible,title:t.modalTitle},on:{close:t.closeModal,confirm:t.submitForm}},t._l(t.formFields,(function(a,i){return e("form-input",{key:i,attrs:{field:a},on:{updateValue:t.handleUpdateValue}})})),1):t._e(),e("confirm-dialog",{attrs:{visible:t.isDialogVisible,title:"确认删除",message:"你确定要删除这个账号吗？"},on:{"update:visible":function(e){t.isDialogVisible=e},confirm:t.handleDelete}}),t.chartsVisible?e("div",{staticClass:"chart-overlay"},[e("div",{staticClass:"chart-container"},[e("div",{ref:"chart",staticClass:"chart-content"}),e("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.closeChart}},[t._v("关闭")])],1)]):t._e()],1)],1)},pt=[],mt=a(3944),ft=function(){var t=this,e=t._self._c;return e("transition",{attrs:{name:"zoom"}},[t.localVisible?e("div",{staticClass:"dialog-overlay",on:{click:function(e){return e.target!==e.currentTarget?null:t.handleClose.apply(null,arguments)}}},[e("div",{staticClass:"dialog-container"},[e("div",{staticClass:"dialog-header"},[e("h3",[t._v(t._s(t.title))]),e("button",{staticClass:"close-button",on:{click:t.handleClose}},[t._v("×")])]),e("div",{staticClass:"dialog-body"},[e("i",{staticClass:"icon-warning"}),e("p",[t._v(t._s(t.message))])]),e("div",{staticClass:"dialog-footer"},[e("button",{staticClass:"btn btn-confirm",on:{click:t.handleConfirm}},[t._v("确定")]),e("button",{staticClass:"btn btn-cancel",on:{click:t.handleClose}},[t._v("取消")])])])]):t._e()])},gt=[],vt={props:{visible:{type:Boolean,default:!1},title:{type:String,default:"确认"},message:{type:String,default:"你确定要执行这个操作吗？"}},data(){return{localVisible:this.visible}},watch:{visible(t){this.localVisible=t}},methods:{handleClose(){this.localVisible=!1,this.$emit("update:visible",!1)},handleConfirm(){this.$emit("confirm"),this.handleClose()}}},bt=vt,yt=(0,r.A)(bt,ft,gt,!1,null,"d393abfa",null),wt=yt.exports,Ct={name:"AccountPage",components:{ConfirmDialog:wt,EnhancedDialog:ut,FormInput:ot},data(){return{loading:!1,isMobile:!1,email:"",tableData:[],currentPage:1,shareAddFlag:!1,total:0,isDialogVisible:!1,isAccDialogVisible:!1,modalVisible:!1,modalTitle:"新增项目",currentIndex:null,chart:null,chartData:[],chartsVisible:!1,formData:{},shareFormData:{},formFields:[{id:"name",label:"账号名称",type:"text",value:"",required:!0},{id:"email",label:"邮箱地址",type:"text",value:"",required:!0},{id:"accountType",label:"账号类型",type:"select",value:"ChatGPT",options:[{value:1,text:"ChatGPT"},{value:2,text:"Claude"}],required:!0},{id:"userLimit",label:"分享人数上限",type:"text",value:"",required:!0},{id:"accessToken",label:"ACCESS_TOKEN",type:"text",value:"",required:!0},{id:"refreshToken",label:"REFRESH_TOKEN",type:"text",value:"",required:!1},{id:"shared",label:"是否共享",type:"checkbox",value:!1,required:!0},{id:"auto",label:"自动加入",type:"checkbox",value:!1,required:!0}],accountFields:[{id:"name",label:"账号名称",type:"text",value:"",required:!0},{id:"email",label:"邮箱地址",type:"text",value:"",required:!0},{id:"accountType",label:"账号类型",type:"select",value:"ChatGPT",options:[{value:1,text:"ChatGPT"},{value:2,text:"Claude"},{value:3,text:"API"}],required:!0},{id:"userLimit",label:"分享人数上限",type:"text",value:"",required:!0},{id:"accessToken",label:"ACCESS_TOKEN",type:"text",value:"",required:!0},{id:"refreshToken",label:"REFRESH_TOKEN",type:"text",value:"",hideLabel:!1},{id:"shared",label:"是否共享",type:"checkbox",value:!1,required:!0},{id:"auto",label:"自动加入",type:"checkbox",value:!1,required:!0}],shareFields:[{id:"username",label:"用户名",type:"text",value:"",required:!0},{id:"password",label:"密码",type:"password",value:"",required:!0},{id:"comment",label:"备注",type:"text",value:"",required:!0},{id:"expiresAt",label:"过期时间",type:"date",value:"",required:!0}]}},methods:{checkIsMobile(){this.isMobile=window.innerWidth<=768},initChart(){this.chart&&this.chart.dispose(),this.$nextTick((()=>{this.chart=mt.Ts(this.$refs.chart);const t={title:{text:"GPT使用情况",left:"center"},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{data:["GPT-4o","GPT-4","GPT-4o-mini","o1-preview","o1-mini"],top:"bottom"},xAxis:{type:"category",data:this.chartData.map((t=>t.uniqueName)),axisLabel:{rotate:45}},yAxis:{type:"value",name:"使用次数"},series:[{name:"GPT-4o",type:"bar",data:this.chartData.map((t=>t.usage.gpt4o)),itemStyle:{color:"#91cc75"}},{name:"GPT-4",type:"bar",data:this.chartData.map((t=>t.usage.gpt4)),itemStyle:{color:"#5470c6"}},{name:"GPT-4o-mini",type:"bar",data:this.chartData.map((t=>t.usage.gpt4omini)),itemStyle:{color:"#fac858"}},{name:"o1-preview",type:"bar",data:this.chartData.map((t=>t.usage.o1Preview)),itemStyle:{color:"#2980b9"}},{name:"o1-mini",type:"bar",data:this.chartData.map((t=>t.usage.o1Mini)),itemStyle:{color:"#f0ad5e"}}]};this.chart.setOption(t)}))},async statistic(t){try{this.chartsVisible=!0;const e=await y.get(`${v.apiBaseUrl}/account/statistic?id=${t}`,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});e.data.status?(this.chartData=e.data.data,this.initChart()):this.$message.error("获取统计数据失败")}catch(e){console.error("Error fetching statistics:",e),this.$message.error("获取统计数据时发生错误")}},closeChart(){this.chartsVisible=!1,this.chart&&(this.chart.dispose(),this.chart=null)},showConfirmDialog(t){this.currentIndex=t,this.isDialogVisible=!0},async fetchAccounts(t){try{this.loading=!0;const e=await y.get(`${v.apiBaseUrl}/account/list?page=`+this.currentPage+"&size=10&emailAddr="+t,{withCredentials:!0,headers:{Authorization:"Bearer "+localStorage.getItem("token")}});e.data.status&&e.data.data.total>0&&(this.tableData=e.data.data.data,this.total=e.data.data.total)}catch(e){console.log(e),k.error("获取账号列表失败")}finally{this.loading=!1}},handleUpdateValue(t,e){this.$set(this.formData,t,e);const a=this.formFields.findIndex((e=>e.id===t));if(-1!==a&&(this.formFields[a].value=e),"accountType"===t){const t=this.formFields.find((t=>"accessToken"===t.id)),a=this.formFields.find((t=>"refreshToken"===t.id));switch(e){case 1:t.label="ACCESS_TOKEN",a.hideLabel=!1,a.label="REFRESH_TOKEN";break;case 2:t.label="SESSION_KEY",a.hideLabel=!0;break;case 3:t.label="API_PROXY",a.hideLabel=!1,a.label="API_KEY";break;default:t.label="ChatGPT",a.hideLabel=!1,a.label="ChatGPT"}}},showModal(){this.modalTitle="新增账号",this.currentIndex=null,this.formFields=this.accountFields,this.resetFormFields(),this.modalVisible=!0},showShareModal(t){this.shareAddFlag=!0,this.modalTitle="新增共享",this.currentIndex=t,this.formFields=this.shareFields,this.resetFormFields(),this.modalVisible=!0},async editItem(t){try{this.modalTitle="编辑账号",this.formFields=this.accountFields,this.currentIndex=t;const e=await y.get(`${v.apiBaseUrl}/account/getById?id=`+t,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});let a=e.data.data,i=1;this.formFields.forEach((t=>{t.value=a[t.id],"accountType"===t.id&&(i=t.value),this.formData[t.id]=a[t.id]}));const s=this.formFields.find((t=>"accessToken"===t.id)),o=this.formFields.find((t=>"refreshToken"===t.id));switch(i){case 1:o.hideLabel=!1,s.label="ACCESS_TOKEN",o.label="REFRESH_TOKEN";break;case 2:s.label="SESSION_KEY",o.hideLabel=!0;break;case 3:s.label="API_PROXY",o.hideLabel=!1,o.label="API_KEY";break;default:o.hideLabel=!1,o.label="ChatGPT"}this.modalVisible=!0}catch(e){k.error("获取账号信息失败")}},closeModal(){this.currentIndex=null,this.modalVisible=!1,this.shareAddFlag=!1},async submitForm(){try{const t={...this.formData};if(this.shareAddFlag){t.uniqueName=t.username,t.accountId=this.currentIndex;const e=await y.post(`${v.apiBaseUrl}/share/add`,t,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});e.data.status?k.success("新增账号共享成功"):k.error(e.data.message)}else null!==this.currentIndex?(t.auto=t.auto?1:0,t.shared=t.shared?1:0,t.accountType=""===t.accountType?1:t.accountType,t.id=this.currentIndex,await y.patch(`${v.apiBaseUrl}/account/update`,t,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}),k.success("修改成功")):(t.auto=t.auto?1:0,t.shared=t.shared?1:0,t.accountType=""===t.accountType?1:t.accountType,await y.post(`${v.apiBaseUrl}/account/add`,t,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}),k.success("新增成功"));this.fetchAccounts(""),this.closeModal()}catch(t){k.error("操作失败，请稍后重试")}},resetFormFields(){this.shareAdd=!1,this.formData={},this.formFields.forEach((t=>{const e="checkbox"!==t.type&&"";t.value=e,this.formData[t.id]=e}))},emailQuery(){this.fetchAccounts(this.email)},async handleDelete(){try{const t=await y.delete(`${v.apiBaseUrl}/account/delete?id=`+this.currentIndex,{withCredentials:!0,headers:{Authorization:"Bearer "+localStorage.getItem("token")}});t.data.status?k.success("删除成功"):k.error("删除失败，请稍后重试"),this.fetchAccounts(""),this.currentIndex=null,this.isDialogVisible=!1}catch(t){k.error("删除失败，请稍后重试")}},handleCurrentChange(){this.fetchAccounts("")},async refresh(t){try{const e=await y.post(`${v.apiBaseUrl}/account/refresh?id=`+t,{},{withCredentials:!0,headers:{Authorization:"Bearer "+localStorage.getItem("token")}});e.data.status?k.success("刷新成功"):k.error(e.data.msg)}catch(e){k.error("刷新失败，请稍后重试")}}},mounted(){this.fetchAccounts(""),this.checkIsMobile(),window.addEventListener("resize",this.checkIsMobile)},beforeDestroy(){window.removeEventListener("resize",this.checkIsMobile),this.chart&&this.chart.dispose()}},_t=Ct,kt=(0,r.A)(_t,ht,pt,!1,null,"174abab4",null),xt=kt.exports,It=function(){var t=this,e=t._self._c;return e("el-container",{staticClass:"panel",attrs:{id:"sharePanel"}},[e("el-header",[e("h2",[t._v("分享管理")])]),e("el-main",[e("el-row",{staticClass:"search-bar"},[e("el-col",{attrs:{xs:24,sm:18,md:18}},[e("el-input",{attrs:{id:"email-query",placeholder:"请输入邮箱或用户名"},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}},[e("el-button",{attrs:{slot:"append"},on:{click:t.emailQuery},slot:"append"},[t._v("查询")])],1)],1)],1),e("div",{staticClass:"pc-view"},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData,fit:!0}},[e("el-table-column",{attrs:{prop:"uniqueName",label:"用户名"}}),e("el-table-column",{attrs:{prop:"gptCarName",label:"ChatGPT账号",width:"180"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("split-button",{attrs:{name:a.row.gptCarName,count:a.row.gptUserCount||0,type:"gpt",loading:a.row.loading},on:{click:function(e){return t.openChat(a.row.gptConfigId,1)}}})]}}])}),e("el-table-column",{attrs:{prop:"claudeCarName",label:"Claude账号",width:"180"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("split-button",{attrs:{name:a.row.claudeCarName,count:a.row.claudeUserCount||0,type:"claude",loading:a.row.loading},on:{click:function(e){return t.openChat(a.row.claudeConfigId,2)}}})]}}])}),e("el-table-column",{attrs:{prop:"apiCarName",label:"API账号",width:"180"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("split-button",{attrs:{name:a.row.apiCarName,count:a.row.apiUserCount||0,type:"api",loading:a.row.loading},on:{click:function(e){return t.openChat(a.row.apiConfigId,3)}}})]}}])}),e("el-table-column",{attrs:{prop:"expiresAt",label:"过期时间"}}),e("el-table-column",{attrs:{label:"操作",width:"250",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticClass:"action-row"},[e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.showShareModal(a.row.id)}}},[t._v("激活")]),e("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(e){return t.editItem(a.row.id)}}},[t._v("编辑")]),e("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){return t.showConfirmDialog(a.row.id)}}},[t._v("删除")])],1)]}}])})],1)],1),e("div",{staticClass:"mobile-view"},t._l(t.tableData,(function(a,i){return e("div",{directives:[{name:"loading",rawName:"v-loading",value:a.loading,expression:"item.loading"}],key:i,staticClass:"mobile-card"},[e("div",{staticClass:"mobile-card-header"},[e("div",{staticClass:"username-badge"},[e("i",{staticClass:"el-icon-user"}),t._v(" "+t._s(a.uniqueName)+" ")]),e("div",{staticClass:"expires-badge"},[t._v(" "+t._s(a.expiresAt)+" ")])]),e("div",{staticClass:"mobile-card-content"},[a.gptCarName?e("div",{staticClass:"account-item"},[e("div",{staticClass:"account-label"},[t._v("ChatGPT账号")]),e("div",{staticClass:"account-value"},[e("split-button",{attrs:{name:a.gptCarName,count:a.gptUserCount||0,type:"gpt",loading:a.loading},on:{click:function(e){return t.openChat(a.gptConfigId,1)}}})],1)]):t._e(),a.claudeCarName?e("div",{staticClass:"account-item"},[e("div",{staticClass:"account-label"},[t._v("Claude账号")]),e("div",{staticClass:"account-value"},[e("split-button",{attrs:{name:a.claudeCarName,count:a.claudeUserCount||0,type:"claude",loading:a.loading},on:{click:function(e){return t.openChat(a.claudeConfigId,2)}}})],1)]):t._e(),a.apiCarName?e("div",{staticClass:"account-item"},[e("div",{staticClass:"account-label"},[t._v("API账号")]),e("div",{staticClass:"account-value"},[e("split-button",{attrs:{name:a.apiCarName,count:a.apiUserCount||0,type:"api",loading:a.loading},on:{click:function(e){return t.openChat(a.apiConfigId,3)}}})],1)]):t._e()]),e("div",{staticClass:"mobile-card-divider"}),e("div",{staticClass:"mobile-card-actions"},[e("div",{staticClass:"action-row"},[e("el-button",{attrs:{type:"primary",size:"mini",loading:a.actionLoading},on:{click:function(e){return t.showShareModal(a.id)}}},[t._v("激活")]),e("el-button",{attrs:{type:"warning",size:"mini",loading:a.actionLoading},on:{click:function(e){return t.editItem(a.id)}}},[t._v("编辑")]),e("el-button",{attrs:{type:"danger",size:"mini",loading:a.actionLoading},on:{click:function(e){return t.showConfirmDialog(a.id)}}},[t._v("删除")])],1)])])})),0),e("div",{staticClass:"pagination-container"},[e("el-pagination",{staticClass:"pagination-wrapper",attrs:{"current-page":t.currentPage,"page-size":t.pageSize,layout:t.isMobile?"prev, pager, next":"total, prev, pager, next, jumper","pager-count":t.isMobile?5:7,total:t.total},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e}}})],1),e("enhanced-dialog",{attrs:{isVisible:t.modalVisible,title:t.modalTitle},on:{close:t.closeModal,confirm:t.submitForm}},t._l(t.formFields,(function(a,i){return e("form-input",{key:i,attrs:{field:a},on:{updateValue:t.handleUpdateValue,handleSelectChange:t.handleSelectChange}})})),1),e("confirm-dialog",{attrs:{visible:t.isDialogVisible,title:"确认删除",message:"你确定要删除这个共享账户吗？"},on:{"update:visible":function(e){t.isDialogVisible=e},confirm:t.handleDelete}})],1)],1)},St=[],Ft=function(){var t=this,e=t._self._c;return e("el-tooltip",{attrs:{content:t.tooltipContent,placement:"top",effect:"light"}},[e("button",{staticClass:"split-button",class:[t.type,{disabled:0===t.count}],on:{click:t.handleClick}},[e("span",{staticClass:"name-section"},[e("i",{staticClass:"type-icon",class:t.typeIcon}),t._v(" "+t._s(t.shortName)+" ")]),e("span",{staticClass:"count-section"},[e("i",{staticClass:"el-icon-user user-icon"}),t._v(" "+t._s(t.count)+" ")])])])},At=[],Pt={name:"SplitButton",props:{name:{type:String,required:!0},count:{type:[String,Number],default:0},type:{type:String,default:"gpt",validator:function(t){return-1!==["gpt","claude","api"].indexOf(t)}},maxLength:{type:Number,default:10}},computed:{typeIcon(){const t={gpt:"el-icon-chat-dot-round",claude:"el-icon-message",api:"el-icon-connection"};return t[this.type]||"el-icon-chat-dot-round"},shortName(){return this.name.length>this.maxLength?this.name.substring(0,this.maxLength)+"...":this.name},tooltipContent(){return 0===Number(this.count)?"用户暂未拥有该类型账号":"点击开始对话"}},methods:{handleClick(){Number(this.count)>0&&this.$emit("click")}}},Vt=Pt,Dt=(0,r.A)(Vt,Ft,At,!1,null,"544e47f8",null),Tt=Dt.exports,Mt={name:"SharePage",components:{ConfirmDialog:wt,EnhancedDialog:ut,FormInput:ot,SplitButton:Tt},data(){return{isMobile:!1,email:"",tableData:[],currentPage:1,total:0,isDialogVisible:!1,isAccDialogVisible:!1,modalVisible:!1,modalTitle:"新增项目",currentIndex:null,activateFlag:!1,accountOpts:[],loading:!1,formData:{},shareFormData:{},formFields:[{id:"uniqueName",label:"用户名",type:"text",value:"",required:!0,readonly:"1"},{id:"comment",label:"备注",type:"text",value:"",required:!0,readonly:!0},{id:"expiresAt",label:"过期时间",type:"date",value:"",required:!0}],accountFields:[{id:"uniqueName",label:"用户名",type:"text",value:"",required:!0},{id:"comment",label:"备注",type:"text",value:"",required:!0},{id:"expiresAt",label:"过期时间",type:"date",value:"",required:!0}],shareFields:[{id:"accountType",label:"账号类型",type:"select",value:"ChatGPT",options:[{value:1,text:"ChatGPT"},{value:2,text:"Claude"},{value:3,text:"API"}],required:!0},{id:"accountOptions",label:"选择账号",type:"select",value:"",options:this.accountOpts}]}},methods:{checkIsMobile(){this.isMobile=window.innerWidth<=768},async openChat(t,e){if(null===t)return;const a=w.Loading.service({fullscreen:!0,text:"加载中...",background:"rgba(0, 0, 0, 0.7)"});try{let a;const i={withCredentials:!0,headers:{Authorization:"Bearer "+localStorage.getItem("token")}};switch(e){case 1:a=await y.get(`${v.apiBaseUrl}/share/getGptShare?gptConfigId=${t}`,i);break;case 2:a=await y.get(`${v.apiBaseUrl}/share/getClaudeShare?claudeConfigId=${t}`,i);break;case 3:a=await y.get(`${v.apiBaseUrl}/share/getApiShare?apiConfigId=${t}`,i);break}a?.data?.status&&window.open(a.data.data)}catch(i){console.error("请求失败:",i),this.$message.error("操作失败，请重试")}finally{a.close()}},showConfirmDialog(t){this.currentIndex=t,this.isDialogVisible=!0},async fetchItems(t){this.loading=!0;try{const e=await y.get(`${v.apiBaseUrl}/share/list?page=${this.currentPage}&size=10&emailAddr=${t}`,{withCredentials:!0,headers:{Authorization:"Bearer "+localStorage.getItem("token")}});e.data.status&&(this.tableData=e.data.data.data.map((t=>({...t,loading:!1,actionLoading:!1}))),this.total=e.data.data.total)}catch(e){k.error(e)}finally{this.loading=!1}},handleUpdateValue(t,e){this.$set(this.formData,t,e);const a=this.formFields.findIndex((e=>e.id===t));-1!==a&&(this.formFields[a].value=e)},showModal(){this.modalTitle="新增账号",this.currentIndex=null,this.formFields=this.accountFields,this.resetFormFields(),this.modalVisible=!0},async showShareModal(t){this.shareAddFlag=!0,this.modalTitle="激活",this.currentIndex=t,this.formFields=this.shareFields,this.resetFormFields(),this.modalVisible=!0,this.activateFlag=!0;try{const e=await y.get(`${v.apiBaseUrl}/account/options?type=1`,{withCredentials:!0,headers:{Authorization:"Bearer "+localStorage.getItem("token")}});this.accountOpts=e.data.data;const a=this.shareFields.find((t=>"accountOptions"===t.id));a&&(a.options=this.accountOpts,this.formData={accountId:parseInt(this.accountOpts[0]?.value),id:t})}catch(e){k.error("获取账号选项失败")}},async editItem(t){this.modalTitle="编辑共享",this.formFields=this.accountFields,this.currentIndex=t;try{const e=await y.get(`${v.apiBaseUrl}/share/getById?id=${t}`,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});let a=e.data.data;this.formFields.forEach((t=>{t.value=a[t.id],this.formData[t.id]=a[t.id]})),this.modalVisible=!0}catch(e){k.error("获取共享信息失败")}},closeModal(){this.modalVisible=!1,this.shareAddFlag=!1,this.activateFlag=!1,this.formData={}},async submitForm(){const t={...this.formData},e=this.tableData.find((t=>t.id===this.currentIndex));e&&(e.actionLoading=!0);try{if(this.activateFlag){t.accountId=t.accountOptions?parseInt(t.accountOptions):t.accountId,t.id=this.currentIndex,t.accountType=parseInt(t.accountType);const e=await y.post(`${v.apiBaseUrl}/share/distribute`,t,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});e.data.status?k.success("激活成功"):k.error(e.data.message)}else if(null!==this.currentIndex){t.id=this.currentIndex;const e=await y.patch(`${v.apiBaseUrl}/share/update`,t,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});e.data.status&&k.success("编辑成功")}}catch(a){k.error("操作失败")}finally{e&&(e.actionLoading=!1),await this.fetchItems(""),this.closeModal()}},resetFormFields(){this.shareAdd=!1,this.formData={},this.formFields.forEach((t=>{const e="checkbox"!==t.type&&"";t.value=e,this.formData[t.id]=e}))},emailQuery(){this.fetchItems(this.email)},async handleDelete(){const t=this.tableData.find((t=>t.id===this.currentIndex));t&&(t.actionLoading=!0);try{const t=await y.delete(`${v.apiBaseUrl}/share/delete?id=${this.currentIndex}`,{withCredentials:!0,headers:{Authorization:"Bearer "+localStorage.getItem("token")}});t.data.status?k.success("删除成功"):k.error("删除失败，请稍后重试")}catch(e){k.error("删除失败")}finally{t&&(t.actionLoading=!1),await this.fetchItems(""),this.isDialogVisible=!1}},handleCurrentChange(){this.fetchItems("")},async handleSelectChange({type:t,field:e,value:a}){if(1===t&&"accountOptions"!==e.id)try{const t=await y.get(`${v.apiBaseUrl}/account/options?type=${a}`,{withCredentials:!0,headers:{Authorization:"Bearer "+localStorage.getItem("token")}});this.accountOpts=t.data.data,e.value=a;const i=this.shareFields.find((t=>"accountOptions"===t.id));i&&(i.options=this.accountOpts)}catch(i){k.error("获取账号选项失败")}}},mounted(){this.fetchItems(""),this.checkIsMobile(),window.addEventListener("resize",this.checkIsMobile)},beforeDestroy(){window.removeEventListener("resize",this.checkIsMobile)}},$t=Mt,zt=(0,r.A)($t,It,St,!1,null,"66b91b37",null),Bt=zt.exports,Et=function(){var t=this,e=t._self._c;return e("el-container",{staticClass:"panel"},[e("el-header",[e("div",{staticClass:"header-content"},[e("h2",[t._v("免费号池")]),e("el-switch",{attrs:{"active-color":"#0e8f6f","active-text":"Claude","inactive-text":"ChatGPT"},on:{change:t.toggleAIType},model:{value:t.showClaude,callback:function(e){t.showClaude=e},expression:"showClaude"}})],1)]),e("el-main",{directives:[{name:"loading",rawName:"v-loading",value:t.pageLoading,expression:"pageLoading"}],attrs:{"element-loading-text":"加载中..."}},[t.pageLoading?e("el-skeleton",{attrs:{loading:t.pageLoading,animated:"",count:4}},[e("template",{slot:"template"},[e("el-row",{attrs:{gutter:20}},[e("el-col",{staticStyle:{"padding-bottom":"15px"},attrs:{xs:24,sm:12,md:8,lg:6,xl:4}},[e("el-skeleton-item",{staticStyle:{height:"150px","border-radius":"8px"},attrs:{variant:"rect"}})],1)],1)],1)],2):e("el-row",{attrs:{gutter:20}},t._l(t.filteredAccounts,(function(a,i){return e("el-col",{key:i,staticStyle:{"padding-bottom":"15px"},attrs:{xs:24,sm:12,md:8,lg:6,xl:4}},[e("el-card",{class:{busy:"1"===a.sessionToken},attrs:{shadow:"hover"}},[e("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e("span",{staticClass:"account-title"},[t._v(t._s(a.type)+"账号 "+t._s(i+1))]),e("el-tag",{staticClass:"status-tag",attrs:{type:""===a.sessionToken?"success":"danger",size:"small",effect:"dark"}},[t._v(" "+t._s(""!=a.sessionToken?"繁忙":"空闲")+" ")])],1),e("el-button",{staticClass:"use-button",attrs:{type:"primary",disabled:""!=a.sessionToken,loading:t.loadingId===a.id},on:{click:function(e){return t.useAccount(a.id)}}},[t._v(" "+t._s(""!=a.sessionToken?"暂不可用":"立即使用")+" ")])],1)],1)})),1),t.pageLoading||0!==t.filteredAccounts.length?t._e():e("div",{staticClass:"empty-state"},[e("i",{staticClass:"el-icon-warning-outline"}),e("p",[t._v("暂无可用账号")])])],1)],1)},Lt=[],Ut={name:"App",data(){return{accounts:[],showClaude:!0,loadingId:null,pageLoading:!0,refreshInterval:null,retryCount:0,maxRetries:3}},computed:{filteredAccounts(){return this.accounts.filter((t=>this.showClaude?"Claude"===t.type:"ChatGPT"===t.type))}},async created(){await this.initializeData(),this.startAutoRefresh()},beforeDestroy(){this.stopAutoRefresh()},methods:{async initializeData(){await this.fetchAccounts(),this.pageLoading=!1},startAutoRefresh(){this.refreshInterval=setInterval((()=>{this.fetchAccounts()}),3e4)},stopAutoRefresh(){this.refreshInterval&&clearInterval(this.refreshInterval)},async fetchAccounts(){try{const t=await y.get(`${v.apiBaseUrl}/account/list?type=`+(this.showClaude?2:1),{withCredentials:!0,headers:{Authorization:"Bearer "+localStorage.getItem("token")},timeout:1e4});t.data.status&&(this.accounts=t.data.data.data,this.retryCount=0)}catch(t){this.retryCount<this.maxRetries?(this.retryCount++,setTimeout((()=>{this.fetchAccounts()}),2e3*this.retryCount)):k.error("获取账号列表失败，请刷新页面重试")}},async useAccount(t){this.loadingId=t;try{const e=await y.get(`${v.apiBaseUrl}/account/share?id=`+t,{withCredentials:!0,headers:{Authorization:"Bearer "+localStorage.getItem("token")},timeout:15e3});e.data.status?(window.open(e.data.data),await this.fetchAccounts()):k.error(e.data.message||"使用账号失败")}catch(e){k.error("系统错误,请稍后重试")}finally{this.loadingId=null}},async toggleAIType(){this.pageLoading=!0,await this.fetchAccounts(),this.pageLoading=!1}}},qt=Ut,Nt=(0,r.A)(qt,Et,Lt,!1,null,"43bfbf71",null),Ot=Nt.exports,Rt=function(){var t=this,e=t._self._c;return e("el-container",{staticClass:"panel",attrs:{id:"redemptionPanel"}},[e("el-header",[e("h2",[t._v("兑换码管理")])]),e("el-main",[e("el-row",{staticClass:"search-bar"},[e("el-col",{attrs:{xs:24,sm:18,md:18}},[e("el-input",{attrs:{id:"email-query",placeholder:"请输入邮箱"},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.emailQuery.apply(null,arguments)}},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}},[e("el-button",{attrs:{slot:"append"},on:{click:t.emailQuery},slot:"append"},[t._v("查询")])],1)],1),e("el-col",{staticClass:"btn-col",attrs:{xs:24,sm:6,md:6}},[e("el-button",{staticClass:"create-new",attrs:{type:"primary"},on:{click:function(e){return t.showModal()}}},[t._v("新增")])],1)],1),t.isMobile?e("div",{staticClass:"mobile-view"},[e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}]},t._l(t.tableData,(function(a,i){return e("div",{key:i,staticClass:"mobile-card"},[e("div",{staticClass:"mobile-card-header"},[e("div",{staticClass:"email-badge"},[e("i",{staticClass:"el-icon-message"}),e("el-tooltip",{attrs:{content:a.email,placement:"top",effect:"light"}},[e("span",[t._v(t._s(a.email))])])],1),e("div",{staticClass:"type-badge"},[t._v(" "+t._s(a.accountType)+" ")])]),e("div",{staticClass:"mobile-card-content"},[e("div",{staticClass:"info-row"},[e("div",{staticClass:"info-item"},[e("div",{staticClass:"info-label"},[e("i",{staticClass:"el-icon-key"}),t._v(" 兑换码 ")]),e("div",{staticClass:"info-value"},[e("el-tooltip",{attrs:{content:a.code,placement:"top",effect:"light"}},[e("span",[t._v(t._s(a.code))])])],1)]),e("div",{staticClass:"info-item"},[e("div",{staticClass:"info-label"},[e("i",{staticClass:"el-icon-time"}),t._v(" 兑换时长 ")]),e("div",{staticClass:"info-value"},[t._v(t._s(a.duration)+" 天")])])])]),e("div",{staticClass:"mobile-card-divider"}),e("div",{staticClass:"mobile-card-actions"},[e("div",{staticClass:"action-row"},[e("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(e){return t.editItem(a.id)}}},[e("i",{staticClass:"el-icon-edit"}),t._v(" 编辑 ")]),e("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){return t.showConfirmDialog(a.id)}}},[e("i",{staticClass:"el-icon-delete"}),t._v(" 删除 ")])],1)])])})),0)]):e("div",{staticClass:"pc-view"},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData}},[e("el-table-column",{attrs:{prop:"email",label:"邮箱","min-width":"180"}}),e("el-table-column",{attrs:{prop:"accountType",label:"账号类型",width:"120"}}),e("el-table-column",{attrs:{prop:"code",label:"兑换码","min-width":"150"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-tooltip",{attrs:{content:a.row.code,placement:"top",effect:"light"}},[e("span",[t._v(t._s(a.row.code))])])]}}],null,!1,948657166)}),e("el-table-column",{attrs:{prop:"duration",label:"兑换时长(天)",width:"120"}}),e("el-table-column",{attrs:{label:"操作",width:"200",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticClass:"action-row"},[e("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(e){return t.editItem(a.row.id)}}},[t._v("编辑")]),e("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(e){return t.showConfirmDialog(a.row.id)}}},[t._v("删除")])],1)]}}],null,!1,2456296760)})],1)],1),e("div",{staticClass:"pagination-container"},[e("el-pagination",{staticClass:"pagination-wrapper",attrs:{"current-page":t.currentPage,"page-size":t.pageSize,layout:t.isMobile?"prev, pager, next":"total, prev, pager, next, jumper","pager-count":t.isMobile?5:7,total:t.total},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e}}})],1),e("enhanced-dialog",{attrs:{isVisible:t.modalVisible,title:t.modalTitle},on:{close:t.closeModal,confirm:t.submitForm}},t._l(t.formFields,(function(a,i){return e("form-input",{key:i,attrs:{field:a},on:{updateValue:t.handleUpdateValue,handleSelectChange:t.handleSelectChange}})})),1),e("confirm-dialog",{attrs:{visible:t.isDialogVisible,title:"确认删除",message:"你确定要删除这个兑换码吗？"},on:{"update:visible":function(e){t.isDialogVisible=e},confirm:t.handleDelete}})],1)],1)},jt=[],Gt=a(2522),Kt={name:"RedemptionPage",components:{ConfirmDialog:wt,EnhancedDialog:ut,FormInput:ot},data(){return{isMobile:!1,email:"",tableData:[],currentPage:1,pageSize:10,total:0,loading:!1,isDialogVisible:!1,modalVisible:!1,modalTitle:"新增项目",currentIndex:null,formData:{},formFields:[{id:"accountId",label:"账号",type:"select",value:"",required:!0,readonly:"1",options:[]},{id:"duration",label:"兑换时长(天)",type:"number",value:"",required:!0,readonly:!0},{id:"count",label:"兑换数量",type:"number",value:"",required:!0}],accountFields:[{id:"accountId",label:"账号",type:"select",value:"",required:!0,readonly:"1",options:[]},{id:"duration",label:"兑换时长(天)",type:"number",value:"",required:!0,readonly:!0},{id:"count",label:"兑换数量",type:"number",value:"",required:!0}],shareFields:[{id:"duration",label:"兑换时长(天)",type:"number",value:"",required:!0,readonly:!0}]}},methods:{checkIsMobile:(0,Gt.debounce)((function(){this.isMobile=window.innerWidth<=768}),200),showConfirmDialog(t){this.currentIndex=t,this.isDialogVisible=!0},async fetchItems(t){try{this.loading=!0;const e=await y.get(`${v.apiBaseUrl}/redemption/list`,{params:{page:this.currentPage,size:this.pageSize,emailAddr:t},headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});e.data.status&&(this.tableData=e.data.data.data,this.total=e.data.data.total)}catch(e){k.error(e.message||"获取数据失败")}finally{this.loading=!1}},handleUpdateValue(t,e){this.$set(this.formData,t,e);const a=this.formFields.findIndex((e=>e.id===t));-1!==a&&(this.formFields[a].value=e)},async showModal(){try{this.modalTitle="新增兑换码",this.currentIndex=null,this.formFields=this.accountFields,this.resetFormFields(),this.modalVisible=!0;const t=await y.get(`${v.apiBaseUrl}/account/list`,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}}),e=this.accountFields.find((t=>"accountId"===t.id));e&&t.data.status&&(e.options=t.data.data.data.map((t=>({text:`${t.name}(${1===t.accountType?"ChatGPT":"Claude"})`,value:t.id}))))}catch(t){k.error(t.message||"获取账号列表失败")}},async editItem(t){try{this.modalTitle="编辑兑换码",this.formFields=this.shareFields,this.currentIndex=t;const e=await y.get(`${v.apiBaseUrl}/redemption/getById`,{params:{id:t},headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(e.data.status){const t=e.data.data;this.formFields.forEach((e=>{e.value=t[e.id],this.$set(this.formData,e.id,t[e.id])})),this.modalVisible=!0}}catch(e){k.error(e.message||"获取兑换码详情失败")}},closeModal(){this.modalVisible=!1,this.currentIndex=null,this.formData={}},async submitForm(){try{const t={...this.formData};if(this.currentIndex){t.id=this.currentIndex,t.duration=parseInt(t.duration);const e=await y.patch(`${v.apiBaseUrl}/redemption/update`,t,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!e.data.status)throw new Error("更新失败");k.success("更新成功")}else{t.accountId=parseInt(t.accountId),t.count=parseInt(t.count),t.duration=parseInt(t.duration);const e=await y.post(`${v.apiBaseUrl}/redemption/add`,t,{headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!e.data.status)throw new Error(e.data.message);k.success("新增成功")}this.closeModal(),this.fetchItems("")}catch(t){k.error(t.message||"操作失败")}},resetFormFields(){this.formData={},this.formFields.forEach((t=>{const e="checkbox"!==t.type&&"";t.value=e,this.$set(this.formData,t.id,e)}))},emailQuery:(0,Gt.debounce)((function(){this.currentPage=1,this.fetchItems(this.email)}),300),async handleDelete(){try{const t=await y.delete(`${v.apiBaseUrl}/redemption/delete`,{params:{id:this.currentIndex},headers:{Authorization:`Bearer ${localStorage.getItem("token")}`}});if(!t.data.status)throw new Error("删除失败");k.success("删除成功"),this.fetchItems("")}catch(t){k.error(t.message||"删除失败")}finally{this.isDialogVisible=!1}},handleCurrentChange(t){this.currentPage=t,this.fetchItems(this.email)},handleSelectChange({type:t,field:e,value:a}){console.log("Select changed:",{type:t,field:e,value:a})}},mounted(){this.fetchItems(""),this.checkIsMobile(),window.addEventListener("resize",this.checkIsMobile)},beforeDestroy(){window.removeEventListener("resize",this.checkIsMobile)}},Qt=Kt,Yt=(0,r.A)(Qt,Rt,jt,!1,null,"7ace573e",null),Ht=Yt.exports,Wt=function(){var t=this,e=t._self._c;return e("el-container",{staticClass:"panel",attrs:{id:"carPanel"}},[e("el-header",[e("h2",[t._v("停车场")])]),e("el-main",[e("el-row",{staticClass:"search-bar"},[e("el-col",{attrs:{xs:24,sm:18,md:18}},[e("el-input",{attrs:{id:"email-query",placeholder:"输入车主名称查询"},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}},[e("el-button",{attrs:{slot:"append"},on:{click:t.emailQuery},slot:"append"},[t._v("查询")])],1)],1)],1),e("div",{directives:[{name:"show",rawName:"v-show",value:!t.isMobile,expression:"!isMobile"}],staticClass:"pc-view"},[e("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{width:"100%"},attrs:{data:t.tableData}},[e("el-table-column",{attrs:{prop:"email",label:"账号"}}),e("el-table-column",{attrs:{prop:"type",label:"账号类型"}}),e("el-table-column",{attrs:{prop:"auto",label:"自动上车"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",{class:["status-tag",1===a.row.auto?"status-yes":"status-no"]},[t._v(" "+t._s(1===a.row.auto?"yes!":"No")+" ")])]}}])}),e("el-table-column",{attrs:{prop:"usernameDesc",label:"车主"}}),e("el-table-column",{attrs:{prop:"countDesc",label:"已上车人数 / 总人数"}}),e("el-table-column",{attrs:{label:"操作",width:"300"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticClass:"action-buttons"},[!0===a.row.authorized?e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.showModal(a.row.id)}}},[t._v("审核")]):t._e(),e("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(e){return t.contact(a.row.username)}}},[t._v("联系车主")]),e("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(e){return t.applyCar(a.row.id)}}},[t._v("我要上车")])],1)]}}])})],1)],1),e("div",{directives:[{name:"show",rawName:"v-show",value:t.isMobile,expression:"isMobile"}],staticClass:"mobile-view"},t._l(t.tableData,(function(a,i){return e("div",{key:i,staticClass:"mobile-card"},[e("div",{staticClass:"mobile-card-header"},[e("div",{staticClass:"account-badge"},[e("i",{staticClass:"el-icon-user"}),t._v(" "+t._s(a.email)+" ")]),e("div",{class:["auto-badge",1===a.auto?"auto-yes":"auto-no"]},[t._v(" "+t._s(1===a.auto?"自动上车":"审核上车")+" ")])]),e("div",{staticClass:"mobile-card-content"},[e("div",{staticClass:"info-row"},[e("div",{staticClass:"info-item"},[e("div",{staticClass:"info-label"},[e("i",{staticClass:"el-icon-key"}),t._v(" 账号类型 ")]),e("div",{staticClass:"info-value"},[t._v(t._s(a.type))])]),e("div",{staticClass:"info-item"},[e("div",{staticClass:"info-label"},[e("i",{staticClass:"el-icon-user"}),t._v(" 车主 ")]),e("div",{staticClass:"info-value"},[t._v(t._s(a.usernameDesc))])]),e("div",{staticClass:"info-item"},[e("div",{staticClass:"info-label"},[e("i",{staticClass:"el-icon-s-data"}),t._v(" 上车情况 ")]),e("div",{staticClass:"info-value"},[t._v(t._s(a.countDesc))])])])]),e("div",{staticClass:"mobile-card-divider"}),e("div",{staticClass:"mobile-card-actions"},[e("div",{staticClass:"action-row"},[!0===a.authorized?e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.showModal(a.id)}}},[e("i",{staticClass:"el-icon-check"}),t._v(" 审核 ")]):t._e(),e("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(e){return t.contact(a.username)}}},[e("i",{staticClass:"el-icon-message"}),t._v(" 联系车主 ")]),e("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(e){return t.applyCar(a.id)}}},[e("i",{staticClass:"el-icon-plus"}),t._v(" 上车 ")])],1)])])})),0),e("div",{staticClass:"pagination-container"},[e("el-pagination",{staticClass:"pagination-wrapper",attrs:{"current-page":t.currentPage,"page-size":t.pageSize,layout:t.isMobile?"prev, pager, next":"total, prev, pager, next, jumper","pager-count":t.isMobile?5:7,total:t.total},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e}}})],1),e("el-dialog",{attrs:{visible:t.auditVisible,title:"审核申请",width:t.isMobile?"95%":"360px",fullscreen:!1,"custom-class":"modern-audit-dialog"},on:{"update:visible":function(e){t.auditVisible=e}}},[e("div",{staticClass:"audit-content"},[e("el-checkbox-group",{staticClass:"audit-checkbox-group",model:{value:t.auditValues,callback:function(e){t.auditValues=e},expression:"auditValues"}},t._l(t.auditOptions,(function(a){return e("el-checkbox",{key:a.value,staticClass:"audit-checkbox-item",attrs:{label:a.value}},[t._v(" "+t._s(a.label)+" ")])})),1)],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(e){return t.submitAudit(0)}}},[t._v("拒绝")]),e("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.submitAudit(1)}}},[t._v("通过")])],1)])],1)],1)},Xt=[];const Jt=new i["default"];var Zt={name:"SharePage",data(){return{isMobile:!1,email:"",tableData:[],currentPage:1,total:0,isDialogVisible:!1,isAccDialogVisible:!1,modalVisible:!1,modalTitle:"新增项目",currentIndex:null,activateFlag:!1,accountOpts:[],auditVisible:!1,auditValues:[],auditOptions:[],auditCarId:null,loading:!1,formData:{},shareFormData:{},formFields:[{id:"accountId",label:"账号",type:"select",value:"",required:!0,readonly:"1",options:[]},{id:"duration",label:"兑换时长(天)",type:"number",value:"",required:!0,readonly:!0},{id:"count",label:"兑换数量",type:"number",value:"",required:!0}],accountFields:[{id:"accountId",label:"账号",type:"select",value:"",required:!0,readonly:"1",options:[]},{id:"duration",label:"兑换时长(天)",type:"number",value:"",required:!0,readonly:!0},{id:"count",label:"兑换数量",type:"number",value:"",required:!0}],shareFields:[{id:"duration",label:"兑换时长(天)",type:"number",value:"",required:!0,readonly:!0}]}},methods:{checkIsMobile(){this.isMobile=window.innerWidth<=768},async jump(){Jt.$emit("envVariableChanged","jump")},async submitAudit(t){try{const e=await y.post(`${v.apiBaseUrl}/car/audit`,{accountId:this.auditCarId,allowApply:t,ids:this.auditValues},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});e.data.status?k.success("审核成功"):k.error(e.data.message),this.auditVisible=!1,this.auditValues=[],this.auditCarId=null,this.fetchItems("")}catch(e){k.error(e)}},async applyCar(t){try{const e=await y.post(`${v.apiBaseUrl}/car/apply`,{accountId:t},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});e.data.status?k.success("申请成功"):k.error(e.data.message),this.closeModal()}catch(e){k.error(e)}},async fetchItems(t){this.loading=!0;try{const e=await y.get(`${v.apiBaseUrl}/car/list?page=${this.currentPage}&size=10&owner=${t}`,{withCredentials:!0,headers:{Authorization:"Bearer "+localStorage.getItem("token")}});e.data.status&&(this.tableData=e.data.data.data,this.total=e.data.data.total)}catch(e){k.error(e)}finally{this.loading=!1}},handleUpdateValue(t,e){this.$set(this.formData,t,e);const a=this.formFields.findIndex((e=>e.id===t));-1!==a&&(this.formFields[a].value=e)},async showModal(t){try{this.auditVisible=!0,this.auditCarId=t;const e=await y.get(`${v.apiBaseUrl}/car/fetchApplies?accountId=${this.auditCarId}`,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});this.auditOptions=e.data.data}catch(e){k.error(e)}},contact(t){window.open("https://linux.do/u/"+t+"/summary")},closeModal(){this.modalVisible=!1,this.shareAddFlag=!1,this.currentIndex=null},async submitForm(){const t={...this.formData};try{if(this.currentIndex)t.id=this.currentIndex,t.duration=parseInt(t.duration),await y.patch(`${v.apiBaseUrl}/redemption/update`,t,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});else{t.accountId=parseInt(t.accountId),t.count=parseInt(t.count),t.duration=parseInt(t.duration);const e=await y.post(`${v.apiBaseUrl}/redemption/add`,t,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});e.data.status?k.success("新增成功"):k.error(e.data.message),this.closeModal()}this.fetchItems(""),this.closeModal()}catch(e){k.error(e)}},resetFormFields(){this.shareAdd=!1,this.formData={},this.formFields.forEach((t=>{const e="checkbox"!==t.type&&"";t.value=e,this.formData[t.id]=e}))},emailQuery(){this.fetchItems(this.email)},handleCurrentChange(){this.fetchItems("")},async handleSelectChange({type:t,field:e,value:a}){console.log(t,e,a)}},mounted(){this.fetchItems(""),this.checkIsMobile(),window.addEventListener("resize",this.checkIsMobile)},beforeDestroy(){window.removeEventListener("resize",this.checkIsMobile)}},te=Zt,ee=(0,r.A)(te,Wt,Xt,!1,null,"07bf24a1",null),ae=ee.exports,ie={components:{EnhancedDialog:ut,FormInput:ot},name:"NaviPage",data(){return{isMenuVisible:!1,touchStartX:0,touchStartY:0,swipeWidth:30,isMobile:!1,avatar:"img/linuxdo.webp",activeMenu:"accountNav",currentComponent:xt,modalVisible:!1,resetModalVisible:!1,itemData:"",modalTitle:"",isCollapse:!1,formFields:[{id:"code",label:"兑换码",type:"text",value:"",required:!0}],resetFormFields:[{id:"oldPassword",label:"旧密码",type:"password",value:"",required:!0},{id:"newPassword",label:"新密码",type:"password",value:"",required:!0},{id:"confirmPassword",label:"确认新密码",type:"password",value:"",required:!0}],resetFormData:{oldPassword:"",newPassword:"",confirmPassword:""}}},computed:{getSidebarWidth(){return this.isMobile?this.isCollapse?"0":"240px":this.isCollapse?"66px":"240px"}},methods:{toggleMenu(){this.isMenuVisible=!this.isMenuVisible},handleClickOutside(t){const e=document.querySelector(".user-menu-container");e&&!e.contains(t.target)&&(this.isMenuVisible=!1)},checkMobile(){this.isMobile=window.innerWidth<=768,this.isMobile&&(this.isCollapse=!0)},toggleCollapse(){this.isCollapse=!this.isCollapse},loadAvatar(){const t=localStorage.getItem("img");t&&(this.avatar=t)},handleUpdateValue(t,e){this.itemData=e;const a=this.formFields.findIndex((e=>e.id===t));-1!==a&&(this.formFields[a].value=e)},handleResetUpdateValue(t,e){this.resetFormData[t]=e;const a=this.resetFormFields.findIndex((e=>e.id===t));-1!==a&&(this.resetFormFields[a].value=e)},showModal(){this.modalTitle="兑换码激活",this.resetFormField(),this.modalVisible=!0},showResetModal(){this.resetModalVisible=!0},closeModal(){this.modalVisible=!1},closeResetModal(){this.resetModalVisible=!1,this.resetFormData={oldPassword:"",newPassword:"",confirmPassword:""}},async submitForm(){const t=await y.get(`${v.apiBaseUrl}/redemption/activate?code=`+this.itemData,{withCredentials:!0,headers:{Authorization:"Bearer "+localStorage.getItem("token")}});t.data.status?(this.modalVisible=!1,k.success("兑换成功")):k.error(t.data.message)},async submitResetForm(){try{if(this.resetFormData.newPassword!==this.resetFormData.confirmPassword)return void k.error("两次输入的新密码不一致");const t=await y.post(`${v.apiBaseUrl}/user/reset`,{oldPassword:this.resetFormData.oldPassword,newPassword:this.resetFormData.newPassword,confirmPassword:this.resetFormData.confirmPassword},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});t.data.status?(k.success("密码重置成功"),this.closeResetModal()):k.error(t.data.message),this.resetFormData={oldPassword:"",newPassword:"",confirmPassword:""}}catch(t){k.error("密码重置失败")}},resetFormField(){this.formData={},this.formFields.forEach((t=>{const e="checkbox"!==t.type&&"";t.value=e,this.formData[t.id]=e}))},handleMenuSelect(t){switch(this.activeMenu=t,this.isMobile&&(this.isCollapse=!0),this.activeMenu=t,t){case"accountNav":this.currentComponent=xt;break;case"shareNav":this.currentComponent=Bt;break;case"redemptionNav":this.currentComponent=Ht;break;case"carNav":this.currentComponent=ae;break;case"freeNav":this.currentComponent=Ot;break;default:this.currentComponent=Bt}},logout(){this.$router.replace({name:"home"}),localStorage.removeItem("token"),localStorage.removeItem("img")}},created(){this.loadAvatar(),Jt.$on("envVariableChanged",(t=>{switch(t){case"jump":this.currentComponent=Ot;break;case"car":this.currentComponent=ae;break}})),this.checkMobile(),window.addEventListener("resize",this.checkMobile),"undefined"!==typeof document&&(document.addEventListener("touchstart",this.handleTouchStart),document.addEventListener("touchend",this.handleTouchEnd))},destroyed(){window.removeEventListener("resize",this.checkMobile),"undefined"!==typeof document&&(document.removeEventListener("touchstart",this.handleTouchStart),document.removeEventListener("touchend",this.handleTouchEnd))},mounted(){document.addEventListener("click",this.handleClickOutside)},beforeDestroy(){document.removeEventListener("click",this.handleClickOutside)}},se=ie,oe=(0,r.A)(se,J,Z,!1,null,"cc3e1cc4",null),le=oe.exports;i["default"].use(u.Ay);const ne=[{path:"/",component:F,name:"home",meta:{title:"首页"}},{path:"/account",component:xt,name:"account",meta:{title:"账号管理"}},{path:"/share",component:Bt,name:"share",meta:{title:"分享管理"}},{path:"/redemption",component:Ht,name:"redemption",meta:{title:"兑换码"}},{path:"/car",component:ae,name:"car",meta:{title:"停车场"}},{path:"/jump",component:Ot,name:"jump",meta:{title:"秋名山"}},{path:"/reset",component:M,name:"reset",meta:{title:"重置密码"}},{path:"/pandora",component:U,name:"pandora",meta:{title:"Pandora"}},{path:"/loading",component:G,name:"loading",meta:{title:"Loading"}},{path:"/claude",component:X,name:"claude",meta:{title:"Fuclaude"}},{path:"/navi",component:le,name:"navi",meta:{title:"Helper"}}],re=new u.Ay({mode:"history",routes:ne});function ce(t){let e=document.querySelector("link[rel~='icon']");e||(e=document.createElement("link"),e.rel="icon",document.getElementsByTagName("head")[0].appendChild(e)),e.href=t,e.type="iamge/svg+xml"}re.beforeEach(((t,e,a)=>{t.meta.title?(document.title=t.meta.title,ce("favicon.svg")):document.title="Pandora",a()}));var de=re;i["default"].use(C()),i["default"].config.productionTip=!1;const ue={install(t){t.prototype.$config=v}};async function he(){await g(),new i["default"]({render:t=>t(d),router:de}).$mount("#app")}i["default"].use(ue),he()},7343:function(t,e,a){t.exports=a.p+"img/chatgpt.7fecc220.svg"},864:function(t,e,a){t.exports=a.p+"img/claude.b7c39d41.svg"},8902:function(t,e,a){t.exports=a.p+"img/ph--user-switch.8dbf8a86.svg"},4832:function(t,e,a){t.exports=a.p+"img/linuxdo.7bff183f.webp"}},e={};function a(i){var s=e[i];if(void 0!==s)return s.exports;var o=e[i]={id:i,loaded:!1,exports:{}};return t[i].call(o.exports,o,o.exports,a),o.loaded=!0,o.exports}a.m=t,function(){a.amdO={}}(),function(){var t=[];a.O=function(e,i,s,o){if(!i){var l=1/0;for(d=0;d<t.length;d++){i=t[d][0],s=t[d][1],o=t[d][2];for(var n=!0,r=0;r<i.length;r++)(!1&o||l>=o)&&Object.keys(a.O).every((function(t){return a.O[t](i[r])}))?i.splice(r--,1):(n=!1,o<l&&(l=o));if(n){t.splice(d--,1);var c=s();void 0!==c&&(e=c)}}return e}o=o||0;for(var d=t.length;d>0&&t[d-1][2]>o;d--)t[d]=t[d-1];t[d]=[i,s,o]}}(),function(){a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,{a:e}),e}}(),function(){a.d=function(t,e){for(var i in e)a.o(e,i)&&!a.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){a.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t}}(),function(){a.p="/"}(),function(){var t={524:0};a.O.j=function(e){return 0===t[e]};var e=function(e,i){var s,o,l=i[0],n=i[1],r=i[2],c=0;if(l.some((function(e){return 0!==t[e]}))){for(s in n)a.o(n,s)&&(a.m[s]=n[s]);if(r)var d=r(a)}for(e&&e(i);c<l.length;c++)o=l[c],a.o(t,o)&&t[o]&&t[o][0](),t[o]=0;return a.O(d)},i=self["webpackChunkpandora_helper"]=self["webpackChunkpandora_helper"]||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))}();var i=a.O(void 0,[504],(function(){return a(4972)}));i=a.O(i)})();
//# sourceMappingURL=app.b0857aad.js.map