(function(){"use strict";var e={5399:function(e,t,a){var i=a(2856),s=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},l=[],o={name:"App"},r=o,n=a(1656),c=(0,n.A)(r,s,l,!1,null,null,null),d=c.exports,u=a(184),h=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"app"}},[t("div",{staticClass:"login-container"},[t("h1",{staticStyle:{"margin-left":"10px"}},[e._v(" Panel "),t("span",{staticClass:"toggle-icon-container",on:{mouseenter:function(t){e.showExtraIcons=!0},mouseleave:function(t){e.showExtraIcons=!1}}},[t("img",{attrs:{src:a(8902),alt:"switch"},on:{click:function(t){return e.switchToIndex()}}}),t("transition",{attrs:{name:"fade"}},[e.showExtraIcons?t("div",{staticClass:"extra-icons"},[t("img",{attrs:{src:a(7343),alt:"Icon 2"},on:{click:function(t){return e.navigateTo("pandora")}}}),t("img",{attrs:{src:a(864),alt:"Icon 1"},on:{click:function(t){return e.navigateTo("claude")}}})]):e._e()])],1)]),t("form",{on:{submit:function(t){return t.preventDefault(),e.userlogin()}}},[t("input",{attrs:{type:"text",id:"username",placeholder:"用户名",required:""}}),t("input",{attrs:{type:"password",id:"password",placeholder:"密码",required:""}}),e._m(0)]),e._m(1),t("div",{staticClass:"alternative-login"},[t("div",{staticClass:"oauth-buttons"},[t("img",{attrs:{src:a(4832),alt:"LINUX DO"},on:{click:function(t){return e.initiateOAuth()}}})]),t("button",{attrs:{type:"button"},on:{click:function(t){return e.reset()}}},[e._v("重置密码")])]),t("div",{staticClass:"footer",on:{click:function(t){return e.index()}}},[t("a",{attrs:{href:"https://github.com/Kylsky/pandora-helper-with-linux-do-oauth",target:"_blank"}},[e._v("Powered by Yeelo")])])])])},p=[function(){var e=this,t=e._self._c;return t("button",{attrs:{type:"submit"}},[t("span",{staticClass:"btn-text"},[e._v("登录")]),t("span",{staticClass:"spinner"})])},function(){var e=this,t=e._self._c;return t("div",{staticClass:"divider"},[t("span",[e._v("OR")])])}],m=a(7423);const f={apiBaseUrl:"http://127.0.0.1:8181"},g=async()=>{try{const e=await m.A.get("/oauth2/config");console.log(e.data),f.apiBaseUrl=e.data||f.apiBaseUrl}catch(e){console.error("Error loading config:",e)}};var b=f;a(4114);const v=m.A.create({baseURL:"https://127.0.0.1:8080",headers:{"Content-Type":"application/json"},timeout:1e4});v.interceptors.response.use((e=>e),(e=>{const{response:t}=e;if(console.log(e),t){if(302===t.status){const e=t.headers["location"];e&&(window.location.href=e)}401!==t.status&&403!==t.status||ct.push({path:"/"})}return Promise.reject(e)}));var y=v,w=a(2457),C=a.n(w);const _={success(e,t=3e3){(0,w.Message)({message:e,type:"success",duration:t,showClose:!0})},error(e,t=3e3){(0,w.Message)({message:e,type:"error",duration:t,showClose:!0})},warning(e,t=3e3){(0,w.Message)({message:e,type:"warning",duration:t,showClose:!0})},info(e,t=3e3){(0,w.Message)({message:e,type:"info",duration:t,showClose:!0})},handleResponse(e,t="操作成功"){return e.data.status?(this.success(t),!0):(this.error(e.data.message||"操作失败"),!1)},handleError(e){e.response?this.error(e.response.data.message||"请求失败"):e.request?this.error("网络连接失败，请检查网络"):this.error("请求配置错误")}};var x=_,k={name:"IndexPage",props:{},data(){return{showExtraIcons:!1}},methods:{reset(){this.$router.replace({name:"reset"})},async userlogin(){var e=document.querySelector(".spinner"),t=document.querySelector(".btn-text");t.style.visibility="hidden",e.style.display="block";var a=document.getElementById("username").value,i=document.getElementById("password").value;try{const s=await y.post(`${b.apiBaseUrl}/user/login`,{username:a,password:i});this.loading=!1;const l=s.data.status;if(!l)return x.error(s.data.message),e.style.display="none",t.style.visibility="visible",!1;const o=s.data,r=o.data.jwt,n=o.data.avatarUrl;localStorage.setItem("token",r),n&&localStorage.setItem("img",n),e.style.display="none",t.textContent="登录成功,跳转中...",t.style.visibility="visible",this.$router.replace({name:"navi"})}catch(l){e.style.display="none",t.style.visibility="visible";var s=s;x.error(s)}},async initiateOAuth(){try{const t=await y.get(`${b.apiBaseUrl}/oauth2/initiate?type=panel`);var e=t;console.log(e),e.data?window.location=e.data:console.error("No redirect URL provided")}catch(t){console.error("Request failed with status:",t)}},switchToIndex(){},navigateTo(e){this.$router.replace({name:e})}}},I=k,A=(0,n.A)(I,h,p,!1,null,"354e8860",null),S=A.exports,V=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"reset"}},[t("div",{staticClass:"reset-container"},[t("h1",[e._v("重置密码")]),t("form",{on:{submit:function(t){return t.preventDefault(),e.resetPassword()}}},[t("input",{attrs:{type:"text",id:"username",placeholder:"用户名",required:""}}),t("input",{attrs:{type:"password",id:"oldPassword",placeholder:"旧密码",required:""}}),t("input",{attrs:{type:"password",id:"newPassword",placeholder:"新密码",required:""}}),t("input",{attrs:{type:"password",id:"confirmPassword",placeholder:"再次确认新密码",required:""}}),t("button",{attrs:{type:"submit"}},[e._v("重置")]),t("button",{staticClass:"home-button",attrs:{type:"button"},on:{click:function(t){return e.goHome()}}},[e._v("返回主页")])]),t("div",{staticClass:"footer"},[e._v(" Powered by Yeelo ")])])])},F=[],P={name:"ResetPage",methods:{async resetPassword(){var e=document.getElementById("username").value,t=document.getElementById("oldPassword").value,a=document.getElementById("newPassword").value,i=document.getElementById("confirmPassword").value;if(t===a)return alert("新密码不能和旧密码相同，请重新输入。"),!1;if(a.length<8)return alert("密码长度必须超过大于等于8位，请重新输入。"),!1;if(a!==i)return alert("两次输入的密码不一致，请重新输入。"),!1;try{const s=await y.post(`${b.apiBaseUrl}/pandora/reset`,{username:e,oldPassword:t,newPassword:a,confirmPassword:i}),l=s.data.status;l?(alert("密码重置成功！"),this.$router.replace({name:"home"})):alert(s.data.message)}catch(s){alert(s)}},async goHome(){this.$router.replace({name:"home"})}}},T=P,D=(0,n.A)(T,V,F,!1,null,"ca797f4e",null),B=D.exports,$=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"pandora"}},[t("div",{staticClass:"login-container"},[t("h1",{staticStyle:{"margin-left":"10px"}},[e._v("Pandora"),t("span",{staticClass:"toggle-icon",on:{click:function(t){return e.switchToFuclaude()}}},[t("img",{attrs:{src:a(8902),title:"切换至Panel",alt:"hi"}})])]),t("form",{on:{submit:function(t){return t.preventDefault(),e.userlogin()}}},[t("input",{attrs:{type:"text",id:"username",placeholder:"用户名",required:""}}),t("input",{attrs:{type:"password",id:"password",placeholder:"密码",required:""}}),e._m(0)]),e._m(1),t("div",{staticClass:"alternative-login"},[t("div",{staticClass:"oauth-buttons"},[t("img",{attrs:{src:a(4832),alt:"LINUX DO"},on:{click:function(t){return e.initiateOAuth()}}})]),t("button",{attrs:{type:"button"},on:{click:function(t){return e.reset()}}},[e._v("重置密码")])]),t("div",{staticClass:"footer"},[e._v(" Powered by Pandora ")])])])},U=[function(){var e=this,t=e._self._c;return t("button",{attrs:{type:"submit"}},[t("span",{staticClass:"btn-text"},[e._v("登录")]),t("span",{staticClass:"spinner"})])},function(){var e=this,t=e._self._c;return t("div",{staticClass:"divider"},[t("span",[e._v("OR")])])}],q={name:"PandoraPage",methods:{reset(){this.$router.replace({name:"reset"})},async userlogin(){var e=document.querySelector(".spinner"),t=document.querySelector(".btn-text");t.style.visibility="hidden",e.style.display="block";var a=document.getElementById("username").value,i=document.getElementById("password").value;try{const l=await y.post(`${b.apiBaseUrl}/pandora/login`,{username:a,password:i}),o=l.data.status;if(o)e.style.display="none",t.textContent="登录成功,跳转中...",t.style.visibility="visible",window.open(l.data.data),t.textContent="登录";else{e.style.display="none",t.style.visibility="visible";var s=l.data.message;x.error(s)}}catch(l){e.style.display="none",t.style.visibility="visible",x.error(l)}},async initiateOAuth(){try{const t=await y.get(`${b.apiBaseUrl}/oauth2/initiate?type=ChatGPT`);var e=t;console.log(e),e.data?window.location=e.data:console.error("No redirect URL provided")}catch(t){x.error(t)}},switchToFuclaude(){this.$router.replace({name:"home"})}}},O=q,z=(0,n.A)(O,$,U,!1,null,"6a13d419",null),E=z.exports,N=function(){var e=this;e._self._c;return e._m(0)},M=[function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"loading"}},[t("div",[t("div",{staticClass:"loader"}),t("p",{staticClass:"message"},[e._v("正在授权，请稍候...")])])])}],L=(a(4603),a(7566),a(8721),{name:"LoadingPage",methods:{async fetchToken(e,t){console.log(e,t);const a=await y.get(`${b.apiBaseUrl}/oauth2/callback?code=${e}&state=${t}`,{withCredentials:!0});if(a.data.status){let e=JSON.parse(a.data.data);console.log(e.avatar_url),localStorage.setItem("img",e.avatar_url),"ChatGPT"===e.shareType?await this.startGPTChat(e.username,e.jmc):"Claude"===e.shareType?await this.startClaudeChat(e.username,e.jmc):"panel"===e.shareType&&await this.startPanel(e.username,e.jmc)}},async startGPTChat(e,t){const a=await y.get(`${b.apiBaseUrl}/pandora/checkUser?username=${e}&jmc=${t}`,{withCredentials:!0});a.data.status&&a.data.data.isShared?window.open(a.data.data.address):(x.error("您的账号未激活，请联系管理员"),this.$router.replace({name:"pandora"}))},async startClaudeChat(e,t){const a=await y.get(`${b.apiBaseUrl}/fuclaude/checkUser?username=${e}&jmc=${t}`,{withCredentials:!0});a.data.status?window.open(a.data.data):(x.error("您的账号未激活，请联系管理员"),this.$router.replace({name:"claude"}))},async startPanel(e,t){console.log("hi");const a=await y.get(`${b.apiBaseUrl}/share/checkUser?username=${e}&jmc=${t}`,{withCredentials:!0});a.data.status?(localStorage.setItem("token",a.data.data),this.$router.replace({name:"navi"})):(x.error(a.data.message),this.$router.replace({name:""}))}},mounted(){const e=new URL(window.location.href),t=new URLSearchParams(e.search),a=t.get("code"),i=t.get("state");a&&i&&this.fetchToken(a,i)}}),j=L,G=(0,n.A)(j,N,M,!1,null,"162ddf6e",null),R=G.exports,K=function(){var e=this,t=e._self._c;return t("div",{attrs:{id:"claude"}},[t("div",{staticClass:"login-container"},[t("h1",{staticStyle:{"margin-left":"10px"}},[e._v("Fuclaude"),t("span",{staticClass:"toggle-icon",on:{click:function(t){return e.switchToPandora()}}},[t("img",{attrs:{src:a(8902),title:"切换至Panel",alt:"hi"}})])]),t("form",{on:{submit:function(t){return t.preventDefault(),e.userlogin()}}},[t("input",{attrs:{type:"text",id:"username",placeholder:"用户名",required:""}}),t("input",{attrs:{type:"password",id:"password",placeholder:"密码",required:""}}),e._m(0)]),e._m(1),t("div",{staticClass:"alternative-login"},[t("div",{staticClass:"oauth-buttons"},[t("img",{attrs:{src:a(4832),alt:"LINUX DO"},on:{click:function(t){return e.initiateOAuth()}}})]),t("button",{attrs:{type:"button"},on:{click:function(t){return e.reset()}}},[e._v("重置密码")])]),t("div",{staticClass:"footer"},[e._v(" Powered by Fuclaude ")])])])},H=[function(){var e=this,t=e._self._c;return t("button",{attrs:{type:"submit"}},[t("span",{staticClass:"btn-text"},[e._v("登录")]),t("span",{staticClass:"spinner"})])},function(){var e=this,t=e._self._c;return t("div",{staticClass:"divider"},[t("span",[e._v("OR")])])}],Q={name:"ClaudePage",methods:{reset(){this.$router.replace({name:"reset"})},async userlogin(){var e=document.querySelector(".spinner"),t=document.querySelector(".btn-text");t.style.visibility="hidden",e.style.display="block";var a=document.getElementById("username").value,i=document.getElementById("password").value;try{const l=await y.post(`${b.apiBaseUrl}/fuclaude/login`,{username:a,password:i}),o=l.data.status;if(o)e.style.display="none",t.textContent="登录成功,跳转中...",t.style.visibility="visible",window.open(l.data.data),t.textContent="登录";else{e.style.display="none",t.style.visibility="visible";var s=l.data.message;alert(s)}}catch(l){e.style.display="none",t.style.visibility="visible",alert(l)}},async initiateOAuth(){try{const t=await y.get(`${b.apiBaseUrl}/oauth2/initiate?type=Claude`);var e=t;console.log(e),e.data?window.location=e.data:console.error("No redirect URL provided")}catch(t){alert(t)}},switchToPandora(){this.$router.replace({name:"home"})}}},Y=Q,X=(0,n.A)(Y,K,H,!1,null,"92cb46c8",null),J=X.exports,W=function(){var e=this,t=e._self._c;return t("el-container",{attrs:{id:"navi"}},[t("el-aside",{staticClass:"sidebar",attrs:{width:"240px"}},[t("h2",{staticClass:"site-title",staticStyle:{"text-align":"center"}},[e._v("Pandora Helper")]),t("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":"accountNav","background-color":"#ffffff","text-color":"#333","active-text-color":"#fff"},on:{select:e.handleMenuSelect}},[t("el-menu-item",{attrs:{index:"accountNav"}},[t("span",[e._v("账号管理")])]),t("el-menu-item",{attrs:{index:"shareNav"}},[t("span",[e._v("分享管理")])]),t("el-menu-item",{attrs:{index:"redemptionNav"}},[t("span",[e._v("兑换码")])]),t("el-menu-item",{attrs:{index:"carNav"}},[t("span",[e._v("停车场")])]),t("el-menu-item",{attrs:{index:"freeNav"}},[t("span",[e._v("免费号池")])])],1)],1),t("el-main",{staticClass:"main-content"},[t("el-dropdown",{staticClass:"user-menu",attrs:{trigger:"click"}},[t("span",{staticClass:"el-dropdown-link"},[t("el-avatar",{staticClass:"user-avatar",attrs:{size:44,src:e.avatar}})],1),t("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[t("el-dropdown-item",{nativeOn:{click:function(t){return e.showModal.apply(null,arguments)}}},[e._v("兑换码激活")]),t("el-dropdown-item",{nativeOn:{click:function(t){return e.logout.apply(null,arguments)}}},[e._v("退出登录")])],1)],1),t("enhanced-dialog",{attrs:{isVisible:e.modalVisible,title:e.modalTitle},on:{close:e.closeModal,confirm:e.submitForm}},e._l(e.formFields,(function(a,i){return t("form-input",{key:i,attrs:{field:a},on:{updateValue:e.handleUpdateValue}})})),1),t(e.currentComponent,{tag:"component"})],1)],1)},Z=[],ee=function(){var e=this,t=e._self._c;return t("div",{staticClass:"form-group"},[e.field.hideLabel?e._e():t("label",{staticClass:"form-label",attrs:{for:e.field.id}},[e._v(e._s(e.field.label))]),"checkbox"===e.field.type&&!e.field.hideLabel&&"number"===e.field.type|"text"===e.field.type|"date"===e.field.type|"password"===e.field.type?t("input",{directives:[{name:"model",rawName:"v-model",value:e.localValue,expression:"localValue"}],staticClass:"form-input",attrs:{id:e.field.id,type:"checkbox"},domProps:{checked:Array.isArray(e.localValue)?e._i(e.localValue,null)>-1:e.localValue},on:{change:function(t){var a=e.localValue,i=t.target,s=!!i.checked;if(Array.isArray(a)){var l=null,o=e._i(a,l);i.checked?o<0&&(e.localValue=a.concat([l])):o>-1&&(e.localValue=a.slice(0,o).concat(a.slice(o+1)))}else e.localValue=s}}}):"radio"===e.field.type&&!e.field.hideLabel&&"number"===e.field.type|"text"===e.field.type|"date"===e.field.type|"password"===e.field.type?t("input",{directives:[{name:"model",rawName:"v-model",value:e.localValue,expression:"localValue"}],staticClass:"form-input",attrs:{id:e.field.id,type:"radio"},domProps:{checked:e._q(e.localValue,null)},on:{change:function(t){e.localValue=null}}}):!e.field.hideLabel&&"number"===e.field.type|"text"===e.field.type|"date"===e.field.type|"password"===e.field.type?t("input",{directives:[{name:"model",rawName:"v-model",value:e.localValue,expression:"localValue"}],staticClass:"form-input",attrs:{id:e.field.id,type:e.field.type},domProps:{value:e.localValue},on:{input:function(t){t.target.composing||(e.localValue=t.target.value)}}}):e._e(),"select"===e.field.type?t("select",{directives:[{name:"model",rawName:"v-model",value:e.localValue,expression:"localValue"}],staticClass:"form-select",attrs:{id:e.field.id},on:{change:[function(t){var a=Array.prototype.filter.call(t.target.options,(function(e){return e.selected})).map((function(e){var t="_value"in e?e._value:e.value;return t}));e.localValue=t.target.multiple?a:a[0]},function(t){return e.handleSelectChange(t)}]}},e._l(e.field.options,(function(a){return t("option",{key:a.value,domProps:{value:a.value}},[e._v(" "+e._s(a.text)+" ")])})),0):e._e(),"checkbox"===e.field.type?t("div",{staticClass:"switch-wrapper"},[t("input",{directives:[{name:"model",rawName:"v-model",value:e.localValue,expression:"localValue"}],staticClass:"switch-input",attrs:{type:"checkbox",id:e.field.id},domProps:{checked:Array.isArray(e.localValue)?e._i(e.localValue,null)>-1:e.localValue},on:{change:function(t){var a=e.localValue,i=t.target,s=!!i.checked;if(Array.isArray(a)){var l=null,o=e._i(a,l);i.checked?o<0&&(e.localValue=a.concat([l])):o>-1&&(e.localValue=a.slice(0,o).concat(a.slice(o+1)))}else e.localValue=s}}}),t("label",{staticClass:"switch-label",attrs:{for:e.field.id}},[t("span",{staticClass:"switch-button"})])]):e._e()])},te=[],ae={props:{field:Object},data(){return{localValue:this.initializeValue()}},methods:{initializeValue(){return"select"===this.field.type&&this.field.options&&this.field.options.length>0?this.field.value||this.field.options[0].value:this.field.value},handleSelectChange(e){const t=e.target.value;this.$emit("handleSelectChange",{type:1,field:this.field,value:t})}},watch:{localValue(e){this.$emit("updateValue",this.field.id,e)},field:{handler(){this.localValue=this.initializeValue()},deep:!0,immediate:!0}}},ie=ae,se=(0,n.A)(ie,ee,te,!1,null,"2886aa49",null),le=se.exports,oe=function(){var e=this,t=e._self._c;return t("transition",{attrs:{name:"modal-fade"}},[e.isVisible?t("div",{staticClass:"modal-overlay",on:{click:e.close}},[t("div",{staticClass:"modal-content",on:{click:function(e){e.stopPropagation()}}},[t("header",{staticClass:"modal-header"},[t("h3",[e._v(e._s(e.title))]),t("button",{staticClass:"close-button",on:{click:e.close}},[e._v("×")])]),t("main",{staticClass:"modal-body"},[e._t("default")],2),t("footer",{staticClass:"modal-footer"},[t("button",{staticClass:"btn btn-confirm",on:{click:e.confirm}},[e._v("确认")]),t("button",{staticClass:"btn btn-cancel",on:{click:e.close}},[e._v("取消")])])])]):e._e()])},re=[],ne={props:{isVisible:{type:Boolean,default:!1},title:{type:String,default:"标题"}},methods:{close(){this.$emit("close")},confirm(){this.$emit("confirm")}}},ce=ne,de=(0,n.A)(ce,oe,re,!1,null,"d1d906d4",null),ue=de.exports,he=function(){var e=this,t=e._self._c;return t("el-container",{staticClass:"panel",attrs:{id:"accountPanel"}},[t("el-header",[t("h2",[e._v("账号管理")])]),t("el-main",[t("el-row",{staticClass:"search-bar"},[t("el-col",{attrs:{span:18}},[t("el-input",{attrs:{id:"email-query",placeholder:"请输入邮箱"},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}},[t("el-button",{attrs:{slot:"append"},on:{click:e.emailQuery},slot:"append"},[e._v("查询")])],1)],1),t("el-col",{attrs:{span:6}},[t("el-button",{staticClass:"create-new",attrs:{type:"primary"},on:{click:function(t){return e.showModal()}}},[e._v("新增")]),t("enhanced-dialog",{attrs:{isVisible:e.modalVisible,title:e.modalTitle},on:{close:e.closeModal,confirm:e.submitForm}},e._l(e.formFields,(function(a,i){return t("form-input",{key:i,attrs:{field:a},on:{updateValue:e.handleUpdateValue}})})),1)],1)],1),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,fit:!0}},[t("el-table-column",{attrs:{prop:"email",label:"邮箱","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"type",label:"账号类型","show-overflow-tooltip":""}}),t("el-table-column",{attrs:{prop:"shared",label:"共享","show-overflow-tooltip":""},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",{staticClass:"ellipsis"},[e._v(e._s(1===a.row.shared?"✅":"❌"))])]}}])}),t("el-table-column",{attrs:{prop:"updateTime",label:"更新时间"}}),t("el-table-column",{attrs:{label:"操作",width:"350"},scopedSlots:e._u([{key:"default",fn:function(a){return[1===a.row.accountType?t("el-button",{attrs:{type:"info",size:"mini"},on:{click:function(t){return e.refresh(a.row.id)}}},[e._v("刷新")]):e._e(),t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.showShareModal(a.row.id)}}},[e._v("共享")]),t("enhanced-dialog",{attrs:{visible:e.modalVisible,title:"新增共享",message:""},on:{"update:visible":function(t){e.modalVisible=t},confirm:function(t){return e.submitForm()}}}),t("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(t){return e.editItem(a.row.id)}}},[e._v("编辑")]),t("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.showConfirmDialog(a.row.id)}}},[e._v("删除")]),t("confirm-dialog",{attrs:{visible:e.isDialogVisible,title:"确认删除",message:"你确定要删除这个账号吗？"},on:{"update:visible":function(t){e.isDialogVisible=t},confirm:function(t){return e.handleDelete()}}})]}}])})],1),t("el-pagination",{attrs:{"current-page":e.currentPage,"page-size":10,layout:"prev, pager, next, jumper",total:e.total},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}}),e.chartsVisible?t("div",{staticClass:"mychart"},[t("div",{staticClass:"chart-container"},[t("div",{ref:"chart",staticStyle:{width:"600px",height:"400px"}}),t("el-button",{attrs:{type:"primary",size:"small"},on:{click:e.closeChart}},[e._v("关闭")])],1)]):e._e()],1)],1)},pe=[],me=a(3944),fe=function(){var e=this,t=e._self._c;return t("transition",{attrs:{name:"zoom"}},[e.localVisible?t("div",{staticClass:"dialog-overlay",on:{click:function(t){return t.target!==t.currentTarget?null:e.handleClose.apply(null,arguments)}}},[t("div",{staticClass:"dialog-container"},[t("div",{staticClass:"dialog-header"},[t("h3",[e._v(e._s(e.title))]),t("button",{staticClass:"close-button",on:{click:e.handleClose}},[e._v("×")])]),t("div",{staticClass:"dialog-body"},[t("i",{staticClass:"icon-warning"}),t("p",[e._v(e._s(e.message))])]),t("div",{staticClass:"dialog-footer"},[t("button",{staticClass:"btn btn-confirm",on:{click:e.handleConfirm}},[e._v("确定")]),t("button",{staticClass:"btn btn-cancel",on:{click:e.handleClose}},[e._v("取消")])])])]):e._e()])},ge=[],be={props:{visible:{type:Boolean,default:!1},title:{type:String,default:"确认"},message:{type:String,default:"你确定要执行这个操作吗？"}},data(){return{localVisible:this.visible}},watch:{visible(e){this.localVisible=e}},methods:{handleClose(){this.localVisible=!1,this.$emit("update:visible",!1)},handleConfirm(){this.$emit("confirm"),this.handleClose()}}},ve=be,ye=(0,n.A)(ve,fe,ge,!1,null,"3891bc9e",null),we=ye.exports,Ce={name:"AccountPage",components:{ConfirmDialog:we,EnhancedDialog:ue,FormInput:le},data(){return{email:"",tableData:[],currentPage:1,shareAddFlag:!1,total:0,isDialogVisible:!1,isAccDialogVisible:!1,modalVisible:!1,modalTitle:"新增项目",currentIndex:null,chart:null,chartData:[],chartsVisible:!1,formData:{},shareFormData:{},formFields:[{id:"name",label:"账号名称",type:"text",value:"",required:!0},{id:"email",label:"邮箱地址",type:"text",value:"",required:!0},{id:"accountType",label:"账号类型",type:"select",value:"ChatGPT",options:[{value:1,text:"ChatGPT"},{value:2,text:"Claude"}],required:!0},{id:"userLimit",label:"分享人数上限",type:"text",value:"",required:!0},{id:"accessToken",label:"ACCESS_TOKEN",type:"text",value:"",required:!0},{id:"refreshToken",label:"REFRESH_TOKEN",type:"text",value:"",required:!1},{id:"shared",label:"是否共享",type:"checkbox",value:!1,required:!0},{id:"auto",label:"自动加入",type:"checkbox",value:!1,required:!0}],accountFields:[{id:"name",label:"账号名称",type:"text",value:"",required:!0},{id:"email",label:"邮箱地址",type:"text",value:"",required:!0},{id:"accountType",label:"账号类型",type:"select",value:"ChatGPT",options:[{value:1,text:"ChatGPT"},{value:2,text:"Claude"},{value:3,text:"API"}],required:!0},{id:"userLimit",label:"分享人数上限",type:"text",value:"",required:!0},{id:"accessToken",label:"ACCESS_TOKEN",type:"text",value:"",required:!0},{id:"refreshToken",label:"REFRESH_TOKEN",type:"text",value:"",hideLabel:!1},{id:"shared",label:"是否共享",type:"checkbox",value:!1,required:!0},{id:"auto",label:"自动加入",type:"checkbox",value:!1,required:!0}],shareFields:[{id:"username",label:"用户名",type:"text",value:"",required:!0},{id:"password",label:"密码",type:"password",value:"",required:!0},{id:"comment",label:"备注",type:"text",value:"",required:!0},{id:"expiresAt",label:"过期时间",type:"date",value:"",required:!0}]}},methods:{initChart(){this.chart&&this.chart.dispose(),this.chart=me.Ts(this.$refs.chart);const e={title:{text:"GPT使用情况",left:"center"},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{data:["GPT-4o","GPT-4","GPT-4o-mini","o1-preview","o1-mini"],top:"bottom"},xAxis:{type:"category",data:this.chartData.map((e=>e.uniqueName)),axisLabel:{rotate:45}},yAxis:{type:"value",name:"使用次数"},series:[{name:"GPT-4o",type:"bar",data:this.chartData.map((e=>e.usage.gpt4o)),itemStyle:{color:"#91cc75"}},{name:"GPT-4",type:"bar",data:this.chartData.map((e=>e.usage.gpt4)),itemStyle:{color:"#5470c6"}},{name:"GPT-4o-mini",type:"bar",data:this.chartData.map((e=>e.usage.gpt4omini)),itemStyle:{color:"#fac858"}},{name:"o1-preview",type:"bar",data:this.chartData.map((e=>e.usage.o1Preview)),itemStyle:{color:"#2980b9"}},{name:"o1-mini",type:"bar",data:this.chartData.map((e=>e.usage.o1Mini)),itemStyle:{color:"#f0ad5e"}}]};this.chart.setOption(e)},async statistic(e){try{this.chartsVisible=!0;const t=await y.get(`${b.apiBaseUrl}/account/statistic?id=${e}`,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});t.data.status?(this.chartData=t.data.data,this.$nextTick((()=>{this.initChart()}))):this.$message.error("获取统计数据失败")}catch(t){console.error("Error fetching statistics:",t),this.$message.error("获取统计数据时发生错误")}},closeChart(){this.chartsVisible=!1,this.chart&&(this.chart.dispose(),this.chart=null)},showConfirmDialog(e){this.currentIndex=e,this.isDialogVisible=!0},async fetchAccounts(e){try{const t=await y.get(`${b.apiBaseUrl}/account/list?page=`+this.currentPage+"&size=10&emailAddr="+e,{withCredentials:!0,headers:{Authorization:"Bearer "+localStorage.getItem("token")}});t.data.status&&t.data.data.total>0&&(this.tableData=t.data.data.data,this.total=t.data.data.total)}catch(t){console.log(t)}},handleUpdateValue(e,t){this.$set(this.formData,e,t);const a=this.formFields.findIndex((t=>t.id===e));if(-1!==a&&(this.formFields[a].value=t),"accountType"===e){const e=this.formFields.find((e=>"accessToken"===e.id));switch(t){case 1:e.label="ACCESS_TOKEN";break;case 2:e.label="SESSION_KEY";break;case 3:e.label="API_PROXY";break;default:e.label="ChatGPT"}const a=this.formFields.find((e=>"refreshToken"===e.id));switch(a.hideLabel=!1,t){case 1:a.hideLabel=!1,a.label="REFRESH_TOKEN";break;case 2:a.hideLabel=!0;break;case 3:a.hideLabel=!1,a.label="API_KEY";break;default:a.hideLabel=!1,a.label="ChatGPT"}}},showModal(){this.modalTitle="新增账号",this.currentIndex=null,this.formFields=this.accountFields,this.resetFormFields(),this.modalVisible=!0},showShareModal(e){this.shareAddFlag=!0,this.modalTitle="新增共享",this.currentIndex=e,this.formFields=this.shareFields,this.resetFormFields(),this.modalVisible=!0},async editItem(e){this.modalTitle="编辑账号",this.formFields=this.accountFields,this.currentIndex=e;const t=await y.get(`${b.apiBaseUrl}/account/getById?id=`+e,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});let a=t.data.data,i=1;this.formFields.forEach((e=>{e.value=a[e.id],"accountType"===e.id&&(i=e.value),this.formData[e.id]=a[e.id]}));const s=this.formFields.find((e=>"accessToken"===e.id)),l=this.formFields.find((e=>"refreshToken"===e.id));switch(i){case 1:l.hideLabel=!1,s.label="ACCESS_TOKEN",l.label="REFRESH_TOKEN";break;case 2:s.label="SESSION_KEY",l.hideLabel=!0;break;case 3:s.label="API_PROXY",l.hideLabel=!1,l.label="API_KEY";break;default:l.hideLabel=!1,l.label="ChatGPT"}this.modalVisible=!0},closeModal(){this.currentIndex=null,this.modalVisible=!1,this.shareAddFlag=!1},async submitForm(){console.log(this.formData);const e={...this.formData};if(this.shareAddFlag){e.uniqueName=e.username,e.accountId=this.currentIndex,console.log(e);const t=await y.post(`${b.apiBaseUrl}/share/add`,e,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).catch((function(e){x.error(e)}));t.data.status?x.success("新增账号共享成功"):x.error(t.data.message)}else null!==this.currentIndex?(e.auto=e.auto?1:0,e.shared=e.shared?1:0,e.accountType=""===e.accountType?1:e.accountType,e.id=this.currentIndex,y.patch(`${b.apiBaseUrl}/account/update`,e,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).catch((function(e){x.error(e)})),x.success("修改成功")):(e.auto=e.auto?1:0,e.shared=e.shared?1:0,e.accountType=""===e.accountType?1:e.accountType,y.post(`${b.apiBaseUrl}/account/add`,e,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).catch((function(e){x.error(e)})),x.success("新增成功"));this.fetchAccounts(""),this.closeModal()},resetFormFields(){this.shareAdd=!1,this.formData={},this.formFields.forEach((e=>{const t="checkbox"!==e.type&&"";e.value=t,this.formData[e.id]=t}))},emailQuery(){console.log(this.email),this.fetchAccounts(this.email)},handleEdit(e){console.log(e+123123123)},handleAdd(){console.log()},async handleDelete(){const e=await y.delete(`${b.apiBaseUrl}/account/delete?id=`+this.currentIndex,{withCredentials:!0,headers:{Authorization:"Bearer "+localStorage.getItem("token")}});e.data.status?x.success("删除成功"):x.error("删除失败，请稍后重试"),this.fetchAccounts(""),this.currentIndex=null,this.isDialogVisible=!1},handleCurrentChange(e){console.log(e),this.fetchAccounts("")},async refresh(e){const t=await y.post(`${b.apiBaseUrl}/account/refresh?id=`+e,{},{withCredentials:!0,headers:{Authorization:"Bearer "+localStorage.getItem("token")}});t.data.status?x.success("刷新成功"):x.error("刷新失败，请稍后重试")}},mounted(){this.fetchAccounts("")}},_e=Ce,xe=(0,n.A)(_e,he,pe,!1,null,"0eb7a233",null),ke=xe.exports,Ie=function(){var e=this,t=e._self._c;return t("el-container",{staticClass:"panel",attrs:{id:"sharePanel"}},[t("el-header",[t("h2",[e._v("分享管理")])]),t("el-main",[t("el-row",{staticClass:"search-bar"},[t("el-col",{attrs:{span:18}},[t("el-input",{attrs:{id:"email-query",placeholder:"请输入邮箱或用户名"},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}},[t("el-button",{attrs:{slot:"append"},on:{click:e.emailQuery},slot:"append"},[e._v("查询")])],1)],1),t("el-col",{attrs:{span:6}},[t("enhanced-dialog",{attrs:{isVisible:e.modalVisible,title:e.modalTitle},on:{close:e.closeModal,confirm:e.submitForm}},e._l(e.formFields,(function(a,i){return t("form-input",{key:i,attrs:{field:a},on:{updateValue:e.handleUpdateValue,handleSelectChange:e.handleSelectChange}})})),1)],1)],1),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData,fit:!0}},[t("el-table-column",{attrs:{prop:"uniqueName",label:"用户名"}}),t("el-table-column",{attrs:{prop:"gptCarName",label:"ChatGPT账号",width:"180"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("split-button",{attrs:{name:a.row.gptCarName,count:a.row.gptUserCount||0,type:"gpt"},on:{click:function(t){return e.openChat(a.row.gptConfigId,1)}}})]}}])}),t("el-table-column",{attrs:{prop:"claudeCarName",label:"Claude账号",width:"180"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("split-button",{attrs:{name:a.row.claudeCarName,count:a.row.claudeUserCount||0,type:"claude"},on:{click:function(t){return e.openChat(a.row.claudeConfigId,2)}}})]}}])}),t("el-table-column",{attrs:{prop:"apiCarName",label:"API账号",width:"180"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("split-button",{attrs:{name:a.row.apiCarName,count:a.row.apiUserCount||0,type:"api"},on:{click:function(t){return e.openChat(a.row.apiConfigId,3)}}})]}}])}),t("el-table-column",{attrs:{prop:"expiresAt",label:"过期时间"}}),t("el-table-column",{attrs:{label:"操作",width:"250"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("div",{staticClass:"action-buttons",staticStyle:{display:"flex",gap:"2px"}},[t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.showShareModal(a.row.id)}}},[e._v("激活")]),t("enhanced-dialog",{attrs:{visible:e.modalVisible,title:"新增共享",message:""},on:{"update:visible":function(t){e.modalVisible=t},confirm:function(t){return e.submitForm()}}}),t("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(t){return e.editItem(a.row.id)}}},[e._v("编辑")]),t("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.showConfirmDialog(a.row.id)}}},[e._v("删除")]),t("confirm-dialog",{attrs:{visible:e.isDialogVisible,title:"确认删除",message:"你确定要删除这个账号吗？"},on:{"update:visible":function(t){e.isDialogVisible=t},confirm:function(t){return e.handleDelete()}}})],1)]}}])})],1),t("el-pagination",{attrs:{"current-page":e.currentPage,"page-size":10,layout:"prev, pager, next, jumper",total:e.total},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}})],1)],1)},Ae=[],Se=function(){var e=this,t=e._self._c;return t("el-tooltip",{attrs:{content:e.tooltipContent,placement:"top",effect:"light"}},[t("button",{staticClass:"split-button",class:[e.type,{disabled:0===e.count}],on:{click:e.handleClick}},[t("span",{staticClass:"name-section"},[t("i",{staticClass:"type-icon",class:e.typeIcon}),e._v(" "+e._s(e.shortName)+" ")]),t("span",{staticClass:"count-section"},[t("i",{staticClass:"el-icon-user user-icon"}),e._v(" "+e._s(e.count)+" ")])])])},Ve=[],Fe={name:"SplitButton",props:{name:{type:String,required:!0},count:{type:[String,Number],default:0},type:{type:String,default:"gpt",validator:function(e){return-1!==["gpt","claude","api"].indexOf(e)}},maxLength:{type:Number,default:10}},computed:{typeIcon(){const e={gpt:"el-icon-chat-dot-round",claude:"el-icon-message",api:"el-icon-connection"};return e[this.type]||"el-icon-chat-dot-round"},shortName(){return this.name.length>this.maxLength?this.name.substring(0,this.maxLength)+"...":this.name},tooltipContent(){return 0===Number(this.count)?"用户暂未拥有该类型账号":"点击开始对话"}},methods:{handleClick(){Number(this.count)>0&&this.$emit("click")}}},Pe=Fe,Te=(0,n.A)(Pe,Se,Ve,!1,null,"544e47f8",null),De=Te.exports,Be={name:"SharePage",components:{ConfirmDialog:we,EnhancedDialog:ue,FormInput:le,SplitButton:De},data(){return{email:"",tableData:[],currentPage:1,total:0,isDialogVisible:!1,isAccDialogVisible:!1,modalVisible:!1,modalTitle:"新增项目",currentIndex:null,activateFlag:!1,accountOpts:[],formData:{},shareFormData:{},formFields:[{id:"uniqueName",label:"用户名",type:"text",value:"",required:!0,readonly:"1"},{id:"comment",label:"备注",type:"text",value:"",required:!0,readonly:!0},{id:"expiresAt",label:"过期时间",type:"date",value:"",required:!0}],accountFields:[{id:"uniqueName",label:"用户名",type:"text",value:"",required:!0},{id:"comment",label:"备注",type:"text",value:"",required:!0},{id:"expiresAt",label:"过期时间",type:"date",value:"",required:!0}],shareFields:[{id:"accountType",label:"账号类型",type:"select",value:"ChatGPT",options:[{value:1,text:"ChatGPT"},{value:2,text:"Claude"},{value:3,text:"API"}],required:!0},{id:"accountOptions",label:"选择账号",type:"select",value:"",options:this.accountOpts}]}},methods:{async openChat(e,t){if(null!==e)if(1===t){const t=await y.get(`${b.apiBaseUrl}/share/getGptShare?gptConfigId=`+e,{withCredentials:!0,headers:{Authorization:"Bearer "+localStorage.getItem("token")}});t.data.status&&window.open(t.data.data)}else if(2===t){const t=await y.get(`${b.apiBaseUrl}/share/getClaudeShare?claudeConfigId=`+e,{withCredentials:!0,headers:{Authorization:"Bearer "+localStorage.getItem("token")}});t.data.status&&window.open(t.data.data)}else if(3===t){const t=await y.get(`${b.apiBaseUrl}/share/getApiShare?apiConfigId=`+e,{withCredentials:!0,headers:{Authorization:"Bearer "+localStorage.getItem("token")}});t.data.status&&window.open(t.data.data)}},showConfirmDialog(e){this.currentIndex=e,this.isDialogVisible=!0},async fetchItems(e){try{const t=await y.get(`${b.apiBaseUrl}/share/list?page=`+this.currentPage+"&size=10&emailAddr="+e,{withCredentials:!0,headers:{Authorization:"Bearer "+localStorage.getItem("token")}});t.data.status&&(this.tableData=t.data.data.data,this.total=t.data.data.total)}catch(t){x.error(t)}},handleUpdateValue(e,t){this.$set(this.formData,e,t);const a=this.formFields.findIndex((t=>t.id===e));-1!==a&&(this.formFields[a].value=t)},showModal(){this.modalTitle="新增账号",this.currentIndex=null,this.formFields=this.accountFields,this.resetFormFields(),this.modalVisible=!0},async showShareModal(e){this.shareAddFlag=!0,this.modalTitle="激活",this.currentIndex=e,this.formFields=this.shareFields,this.resetFormFields(),this.modalVisible=!0,this.activateFlag=!0;const t=await y.get(`${b.apiBaseUrl}/account/options?type=1`,{withCredentials:!0,headers:{Authorization:"Bearer "+localStorage.getItem("token")}});this.accountOpts=t.data.data;const a=this.shareFields.find((e=>"accountOptions"===e.id));a&&(a.options=this.accountOpts,this.formData={accountId:parseInt(this.accountOpts[0].value),id:e})},async editItem(e){this.modalTitle="编辑共享",this.formFields=this.accountFields,this.currentIndex=e;const t=await y.get(`${b.apiBaseUrl}/share/getById?id=`+e,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});let a=t.data.data;this.formFields.forEach((e=>{e.value=a[e.id],this.formData[e.id]=a[e.id]})),this.modalVisible=!0},closeModal(){this.modalVisible=!1,this.shareAddFlag=!1},async submitForm(){const e={...this.formData};if(this.activateFlag){console.log(e),e.accountId=e.accountOptions?parseInt(e.accountOptions):e.accountId,e.id=this.currentIndex,e.accountType=parseInt(e.accountType);const t=await y.post(`${b.apiBaseUrl}/share/distribute`,e,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).catch((function(e){x.error(e)}));t.data.status?x.success("激活成功"):x.error(t.data.message),this.fetchItems(""),this.currentIndex=null,this.activateFlag=!1}else if(null!==this.currentIndex){e.id=this.currentIndex;const t=await y.patch(`${b.apiBaseUrl}/share/update`,e,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).catch((function(e){x.error(e)}));t.data.status&&x.success("编辑成功")}this.fetchItems(""),this.closeModal()},resetFormFields(){this.shareAdd=!1,this.formData={},this.formFields.forEach((e=>{const t="checkbox"!==e.type&&"";e.value=t,this.formData[e.id]=t}))},emailQuery(){this.fetchItems(this.email)},async handleDelete(){const e=await y.delete(`${b.apiBaseUrl}/share/delete?id=`+this.currentIndex,{withCredentials:!0,headers:{Authorization:"Bearer "+localStorage.getItem("token")}});e.data.status?x.success("删除成功"):x.error("删除失败，请稍后重试"),this.fetchItems(""),this.isDialogVisible=!1},handleCurrentChange(e){console.log(e),this.fetchItems("")},async handleSelectChange({type:e,field:t,value:a}){if(1==e&&"accountOptions"!=t.id){const e=await y.get(`${b.apiBaseUrl}/account/options?type=`+a,{withCredentials:!0,headers:{Authorization:"Bearer "+localStorage.getItem("token")}});this.accountOpts=e.data.data,t.value=a;const i=this.shareFields.find((e=>"accountOptions"===e.id));i&&(i.options=this.accountOpts)}else console.log(t)}},mounted(){this.fetchItems("")}},$e=Be,Ue=(0,n.A)($e,Ie,Ae,!1,null,"11c084d0",null),qe=Ue.exports,Oe=function(){var e=this,t=e._self._c;return t("el-container",{staticClass:"panel"},[t("el-header",[t("div",{staticClass:"header-content"},[t("h2",[e._v("免费号池")]),t("el-switch",{attrs:{"active-color":"#0e8f6f","active-text":"Claude","inactive-text":"ChatGPT"},on:{change:e.toggleAIType},model:{value:e.showClaude,callback:function(t){e.showClaude=t},expression:"showClaude"}})],1)]),t("el-main",[t("el-row",{attrs:{gutter:20}},e._l(e.filteredAccounts,(function(a,i){return t("el-col",{key:i,staticStyle:{"padding-bottom":"15px"},attrs:{xs:24,sm:12,md:8,lg:6,xl:4}},[t("el-card",{class:{busy:"1"===a.sessionToken}},[t("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[t("span",[e._v(e._s(a.type)+"账号 "+e._s(i+1))]),t("el-tag",{staticStyle:{float:"right"},attrs:{type:""===a.sessionToken?"success":"danger",size:"small"}},[e._v(" "+e._s(""!=a.sessionToken?"繁忙":"空闲")+" ")])],1),t("el-button",{attrs:{type:"primary",disabled:""!=a.sessionToken},on:{click:function(t){return e.useAccount(a.id)}}},[e._v(" 使用账号 ")])],1)],1)})),1)],1)],1)},ze=[],Ee={name:"App",data(){return{accounts:[],showClaude:!0}},computed:{filteredAccounts(){return this.accounts.filter((e=>this.showClaude?"Claude"===e.type:"ChatGPT"===e.type))}},created(){this.fetchAccounts()},methods:{handleSelect(e,t){console.log(e,t)},async fetchAccounts(){try{const e=await y.get(`${b.apiBaseUrl}/account/list?type=`+(this.showClaude?2:1),{withCredentials:!0,headers:{Authorization:"Bearer "+localStorage.getItem("token")}});e.data.status&&(this.accounts=e.data.data.data)}catch(e){x.error(e)}},async useAccount(e){try{const t=await y.get(`${b.apiBaseUrl}/account/share?id=`+e,{withCredentials:!0,headers:{Authorization:"Bearer "+localStorage.getItem("token")}});t.data.status?window.open(t.data.data):x.error(t.data.message)}catch(t){x.error(t)}},toggleAIType(){this.fetchAccounts()},handleCheckboxChange(e,t){console.log(`Account ${e.id} selection changed to ${t}`)}}},Ne=Ee,Me=(0,n.A)(Ne,Oe,ze,!1,null,"5bf1d45a",null),Le=Me.exports,je=function(){var e=this,t=e._self._c;return t("el-container",{staticClass:"panel",attrs:{id:"redemptionPanel"}},[t("el-header",[t("h2",[e._v("兑换码管理")])]),t("el-main",[t("el-row",{staticClass:"search-bar"},[t("el-col",{attrs:{span:18}},[t("el-input",{attrs:{id:"email-query",placeholder:"请输入邮箱"},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}},[t("el-button",{attrs:{slot:"append"},on:{click:e.emailQuery},slot:"append"},[e._v("查询")])],1)],1),t("el-col",{attrs:{span:6}},[t("el-button",{staticClass:"create-new",attrs:{type:"primary"},on:{click:function(t){return e.showModal()}}},[e._v("新增")]),t("enhanced-dialog",{attrs:{isVisible:e.modalVisible,title:e.modalTitle},on:{close:e.closeModal,confirm:e.submitForm}},e._l(e.formFields,(function(a,i){return t("form-input",{key:i,attrs:{field:a},on:{updateValue:e.handleUpdateValue,handleSelectChange:e.handleSelectChange}})})),1)],1)],1),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData}},[t("el-table-column",{attrs:{prop:"email",label:"邮箱"}}),t("el-table-column",{attrs:{prop:"accountType",label:"账号类型"}}),t("el-table-column",{attrs:{prop:"code",label:"兑换码"}}),t("el-table-column",{attrs:{prop:"duration",label:"兑换时长(天)"}}),t("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(t){return e.editItem(a.row.id)}}},[e._v("编辑")]),t("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(t){return e.showConfirmDialog(a.row.id)}}},[e._v("删除")]),t("confirm-dialog",{attrs:{visible:e.isDialogVisible,title:"确认删除",message:"你确定要删除这个账号吗？"},on:{"update:visible":function(t){e.isDialogVisible=t},confirm:function(t){return e.handleDelete()}}})]}}])})],1),t("el-pagination",{attrs:{"current-page":e.currentPage,"page-size":10,layout:"prev, pager, next, jumper",total:e.total},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}})],1)],1)},Ge=[],Re={name:"SharePage",components:{ConfirmDialog:we,EnhancedDialog:ue,FormInput:le},data(){return{email:"",tableData:[],currentPage:1,total:0,isDialogVisible:!1,isAccDialogVisible:!1,modalVisible:!1,modalTitle:"新增项目",currentIndex:null,activateFlag:!1,accountOpts:[],formData:{},shareFormData:{},formFields:[{id:"accountId",label:"账号",type:"select",value:"",required:!0,readonly:"1",options:[]},{id:"duration",label:"兑换时长(天)",type:"number",value:"",required:!0,readonly:!0},{id:"count",label:"兑换数量",type:"number",value:"",required:!0}],accountFields:[{id:"accountId",label:"账号",type:"select",value:"",required:!0,readonly:"1",options:[]},{id:"duration",label:"兑换时长(天)",type:"number",value:"",required:!0,readonly:!0},{id:"count",label:"兑换数量",type:"number",value:"",required:!0}],shareFields:[{id:"duration",label:"兑换时长(天)",type:"number",value:"",required:!0,readonly:!0}]}},methods:{showConfirmDialog(e){this.currentIndex=e,this.isDialogVisible=!0},async fetchItems(e){try{const t=await y.get(`${b.apiBaseUrl}/redemption/list?page=`+this.currentPage+"&size=10&emailAddr="+e,{withCredentials:!0,headers:{Authorization:"Bearer "+localStorage.getItem("token")}});console.log(t.data.data),t.data.status&&(this.tableData=t.data.data.data,this.total=t.data.data.total)}catch(t){x.error(t)}},handleUpdateValue(e,t){this.$set(this.formData,e,t);const a=this.formFields.findIndex((t=>t.id===e));-1!==a&&(this.formFields[a].value=t)},async showModal(){this.modalTitle="新增兑换码",this.currentIndex=null,this.formFields=this.accountFields,this.resetFormFields(),this.modalVisible=!0;const e=await y.get(`${b.apiBaseUrl}/account/list`,{withCredentials:!0,headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).catch((function(e){x.error(e)})),t=this.accountFields.find((e=>"accountId"===e.id));if(t){let a=[];console.log(e.data.data.data);for(const t of e.data.data.data){let e=t.name+"("+(1===t.accountType?"ChatGPT":"Claude")+")",i=t.id,s={text:e,value:i};a.push(s)}t.options=a,console.log(t)}e.data.data},async editItem(e){this.modalTitle="编辑兑换码",this.formFields=this.shareFields,this.currentIndex=e;const t=await y.get(`${b.apiBaseUrl}/redemption/getById?id=`+e,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});let a=t.data.data;this.formFields.forEach((e=>{e.value=a[e.id],this.formData[e.id]=a[e.id]})),this.modalVisible=!0},closeModal(){this.modalVisible=!1,this.shareAddFlag=!1,this.currentIndex=null},async submitForm(){const e={...this.formData};if(this.currentIndex){e.id=this.currentIndex,e.duration=parseInt(e.duration);const t=await y.patch(`${b.apiBaseUrl}/redemption/update`,e,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).catch((function(e){x.error(e)}));t.data.status?x.success("更新成功"):x.error("更新异常，请稍后重试")}else{console.log(e),e.accountId=parseInt(e.accountId),e.count=parseInt(e.count),e.duration=parseInt(e.duration);const t=await y.post(`${b.apiBaseUrl}/redemption/add`,e,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).catch((function(e){x.error(e)}));t.data.status?x.success("新增成功"):x.error(t.data.message),this.closeModal()}this.fetchItems(""),this.closeModal()},resetFormFields(){this.shareAdd=!1,this.formData={},this.formFields.forEach((e=>{const t="checkbox"!==e.type&&"";e.value=t,this.formData[e.id]=t}))},emailQuery(){this.fetchItems(this.email)},async handleDelete(){const e=await y.delete(`${b.apiBaseUrl}/redemption/delete?id=`+this.currentIndex,{withCredentials:!0,headers:{Authorization:"Bearer "+localStorage.getItem("token")}});e.data.status?x.success("删除成功"):x.error("删除失败，请稍后重试"),this.fetchItems(""),this.isDialogVisible=!1},handleCurrentChange(e){console.log(e),this.fetchItems("")},async handleSelectChange({type:e,field:t,value:a}){console.log(e,t,a)}},mounted(){this.fetchItems("")}},Ke=Re,He=(0,n.A)(Ke,je,Ge,!1,null,"781e4410",null),Qe=He.exports,Ye=function(){var e=this,t=e._self._c;return t("el-container",{staticClass:"panel",attrs:{id:"redemptionPanel"}},[t("el-header",[t("h2",[e._v("停车场")])]),t("el-main",[t("el-row",{staticClass:"search-bar"},[t("el-col",{attrs:{span:18}},[t("el-input",{attrs:{id:"email-query",placeholder:"输入车主名称查询"},model:{value:e.email,callback:function(t){e.email=t},expression:"email"}},[t("el-button",{attrs:{slot:"append"},on:{click:e.emailQuery},slot:"append"},[e._v("查询")])],1)],1)],1),t("el-table",{staticStyle:{width:"100%"},attrs:{data:e.tableData}},[t("el-table-column",{attrs:{prop:"email",label:"账号"}}),t("el-table-column",{attrs:{prop:"type",label:"账号类型"}}),t("el-table-column",{attrs:{prop:"auto",label:"自动上车"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("span",{staticClass:"ellipsis"},[e._v(e._s(1===a.row.auto?"yes!":"No"))])]}}])}),t("el-table-column",{attrs:{prop:"usernameDesc",label:"车主"}}),t("el-table-column",{attrs:{prop:"countDesc",label:"已上车人数 / 总人数"}}),t("el-table-column",{attrs:{label:"操作",width:"300"},scopedSlots:e._u([{key:"default",fn:function(a){return[!0===a.row.authorized?t("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.showModal(a.row.id)}}},[e._v("审核")]):e._e(),t("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(t){return e.contact(a.row.username)}}},[e._v("联系车主")]),t("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(t){return e.applyCar(a.row.id)}}},[e._v("我要上车")])]}}])})],1),t("el-dialog",{attrs:{visible:e.auditVisible,title:"审核申请",width:"400px","custom-class":"modern-audit-dialog"},on:{"update:visible":function(t){e.auditVisible=t}}},[t("div",{staticClass:"audit-content"},[t("el-checkbox-group",{staticClass:"audit-checkbox-group",model:{value:e.auditValues,callback:function(t){e.auditValues=t},expression:"auditValues"}},e._l(e.auditOptions,(function(a){return t("el-checkbox",{key:a.value,staticClass:"audit-checkbox-item",attrs:{label:a.value}},[e._v(" "+e._s(a.label)+" ")])})),1)],1),t("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[t("el-button",{staticClass:"cancel-button",attrs:{type:"danger"},on:{click:function(t){return e.submitAudit(0)}}},[e._v("拒绝")]),t("el-button",{staticClass:"submit-button",attrs:{type:"primary"},on:{click:function(t){return e.submitAudit(1)}}},[e._v("通过")])],1)]),t("el-pagination",{attrs:{"current-page":e.currentPage,"page-size":10,layout:"prev, pager, next, jumper",total:e.total},on:{"current-change":e.handleCurrentChange,"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t}}})],1)],1)},Xe=[];const Je=new i["default"];var We={name:"SharePage",data(){return{email:"",tableData:[],currentPage:1,total:0,isDialogVisible:!1,isAccDialogVisible:!1,modalVisible:!1,modalTitle:"新增项目",currentIndex:null,activateFlag:!1,accountOpts:[],auditVisible:!1,auditValues:[],auditOptions:[],auditCarId:null,formData:{},shareFormData:{},formFields:[{id:"accountId",label:"账号",type:"select",value:"",required:!0,readonly:"1",options:[]},{id:"duration",label:"兑换时长(天)",type:"number",value:"",required:!0,readonly:!0},{id:"count",label:"兑换数量",type:"number",value:"",required:!0}],accountFields:[{id:"accountId",label:"账号",type:"select",value:"",required:!0,readonly:"1",options:[]},{id:"duration",label:"兑换时长(天)",type:"number",value:"",required:!0,readonly:!0},{id:"count",label:"兑换数量",type:"number",value:"",required:!0}],shareFields:[{id:"duration",label:"兑换时长(天)",type:"number",value:"",required:!0,readonly:!0}]}},methods:{async jump(){Je.$emit("envVariableChanged","jump")},async submitAudit(e){console.log("提交审核",this.auditCarId,this.auditValues);const t=await y.post(`${b.apiBaseUrl}/car/audit`,{accountId:this.auditCarId,allowApply:e,ids:this.auditValues},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).catch((function(e){x.error(e)}));t.data.status?(console.log("audit success"),x.success("审核成功")):x.error(t.data.message),this.auditVisible=!1,this.auditValues=[],this.auditCarId=null,this.fetchItems("")},async applyCar(e){const t=await y.post(`${b.apiBaseUrl}/car/apply`,{accountId:e},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).catch((function(e){x.error(e)}));t.data.status?x.success("申请成功"):x.error(t.data.message),this.closeModal()},async fetchItems(e){try{const t=await y.get(`${b.apiBaseUrl}/car/list?page=`+this.currentPage+"&size=10&owner="+e,{withCredentials:!0,headers:{Authorization:"Bearer "+localStorage.getItem("token")}});t.data.status&&(this.tableData=t.data.data.data,this.total=t.data.data.total)}catch(t){x.error(t)}},handleUpdateValue(e,t){this.$set(this.formData,e,t);const a=this.formFields.findIndex((t=>t.id===e));-1!==a&&(this.formFields[a].value=t)},async showModal(e){console.log(this.auditVisible),this.auditVisible=!0,this.auditCarId=e;const t=await y.get(`${b.apiBaseUrl}/car/fetchApplies?accountId=`+this.auditCarId,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).catch((function(e){x.error(e)}));this.auditOptions=t.data.data},async contact(e){window.open("https://linux.do/u/"+e+"/summary")},closeModal(){this.modalVisible=!1,this.shareAddFlag=!1,this.currentIndex=null},async submitForm(){const e={...this.formData};if(this.currentIndex)e.id=this.currentIndex,e.duration=parseInt(e.duration),y.patch(`${b.apiBaseUrl}/redemption/update`,e,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).catch((function(e){x.error(e)}));else{console.log(e),e.accountId=parseInt(e.accountId),e.count=parseInt(e.count),e.duration=parseInt(e.duration);const t=await y.post(`${b.apiBaseUrl}/redemption/add`,e,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).catch((function(e){x.error(e)}));t.data.status?x.success("新增成功"):x.error(t.data.message),this.closeModal()}this.fetchItems(""),this.closeModal()},resetFormFields(){this.shareAdd=!1,this.formData={},this.formFields.forEach((e=>{const t="checkbox"!==e.type&&"";e.value=t,this.formData[e.id]=t}))},emailQuery(){this.fetchItems(this.email)},handleCurrentChange(e){console.log(e),this.fetchItems("")},async handleSelectChange({type:e,field:t,value:a}){console.log(e,t,a)}},mounted(){this.fetchItems("")}},Ze=We,et=(0,n.A)(Ze,Ye,Xe,!1,null,"abf9c924",null),tt=et.exports,at={components:{EnhancedDialog:ue,FormInput:le},name:"NaviPage",data(){return{avatar:"img/linuxdo.webp",activeMenu:"accountNav",currentComponent:ke,modalVisible:!1,itemData:"",modalTitle:"",formFields:[{id:"code",label:"兑换码",type:"text",value:"",required:!0}]}},methods:{loadAvatar(){const e=localStorage.getItem("img");e&&(this.avatar=e)},handleUpdateValue(e,t){this.itemData=t;const a=this.formFields.findIndex((t=>t.id===e));-1!==a&&(this.formFields[a].value=t)},showModal(){console.log(111),this.modalTitle="兑换码激活",this.resetFormFields(),this.modalVisible=!0},closeModal(){this.modalVisible=!1},async submitForm(){console.log(this.itemData);const e=await y.get(`${b.apiBaseUrl}/redemption/activate?code=`+this.itemData,{withCredentials:!0,headers:{Authorization:"Bearer "+localStorage.getItem("token")}});e.data.status?(this.modalVisible=!0,x.success("兑换成功")):x.error(e.data.message)},resetFormFields(){this.formData={},this.formFields.forEach((e=>{const t="checkbox"!==e.type&&"";e.value=t,this.formData[e.id]=t}))},handleMenuSelect(e){switch(this.activeMenu=e,e){case"accountNav":this.currentComponent=ke;break;case"shareNav":this.currentComponent=qe;break;case"redemptionNav":this.currentComponent=Qe;break;case"carNav":this.currentComponent=tt;break;case"freeNav":this.currentComponent=Le;break;default:this.currentComponent=qe}},logout(){this.$router.replace({name:"home"}),localStorage.removeItem("token"),localStorage.removeItem("img")}},created(){this.loadAvatar(),Je.$on("envVariableChanged",(e=>{switch(e){case"jump":this.currentComponent=Le;break;case"car":this.currentComponent=tt;break}}))}},it=at,st=(0,n.A)(it,W,Z,!1,null,"acbb5f92",null),lt=st.exports;i["default"].use(u.Ay);const ot=[{path:"/",component:S,name:"home",meta:{title:"首页"}},{path:"/account",component:ke,name:"account",meta:{title:"账号管理"}},{path:"/share",component:qe,name:"share",meta:{title:"分享管理"}},{path:"/redemption",component:Qe,name:"redemption",meta:{title:"兑换码"}},{path:"/car",component:tt,name:"car",meta:{title:"停车场"}},{path:"/jump",component:Le,name:"jump",meta:{title:"秋名山"}},{path:"/reset",component:B,name:"reset",meta:{title:"重置密码"}},{path:"/pandora",component:E,name:"pandora",meta:{title:"Pandora"}},{path:"/loading",component:R,name:"loading",meta:{title:"Loading"}},{path:"/claude",component:J,name:"claude",meta:{title:"Fuclaude"}},{path:"/navi",component:lt,name:"navi",meta:{title:"Helper"}}],rt=new u.Ay({mode:"history",routes:ot});function nt(e){let t=document.querySelector("link[rel~='icon']");t||(t=document.createElement("link"),t.rel="icon",document.getElementsByTagName("head")[0].appendChild(t)),t.href=e,t.type="iamge/svg+xml"}rt.beforeEach(((e,t,a)=>{e.meta.title?(document.title=e.meta.title,nt("favicon.svg")):document.title="Pandora",a()}));var ct=rt;i["default"].use(C()),i["default"].config.productionTip=!1;const dt={install(e){e.prototype.$config=b}};async function ut(){await g(),new i["default"]({render:e=>e(d),router:ct}).$mount("#app")}i["default"].use(dt),ut()},7343:function(e,t,a){e.exports=a.p+"img/chatgpt.7fecc220.svg"},864:function(e,t,a){e.exports=a.p+"img/claude.b7c39d41.svg"},8902:function(e,t,a){e.exports=a.p+"img/ph--user-switch.8dbf8a86.svg"},4832:function(e,t,a){e.exports=a.p+"img/linuxdo.7bff183f.webp"}},t={};function a(i){var s=t[i];if(void 0!==s)return s.exports;var l=t[i]={id:i,loaded:!1,exports:{}};return e[i].call(l.exports,l,l.exports,a),l.loaded=!0,l.exports}a.m=e,function(){a.amdO={}}(),function(){var e=[];a.O=function(t,i,s,l){if(!i){var o=1/0;for(d=0;d<e.length;d++){i=e[d][0],s=e[d][1],l=e[d][2];for(var r=!0,n=0;n<i.length;n++)(!1&l||o>=l)&&Object.keys(a.O).every((function(e){return a.O[e](i[n])}))?i.splice(n--,1):(r=!1,l<o&&(o=l));if(r){e.splice(d--,1);var c=s();void 0!==c&&(t=c)}}return t}l=l||0;for(var d=e.length;d>0&&e[d-1][2]>l;d--)e[d]=e[d-1];e[d]=[i,s,l]}}(),function(){a.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return a.d(t,{a:t}),t}}(),function(){a.d=function(e,t){for(var i in t)a.o(t,i)&&!a.o(e,i)&&Object.defineProperty(e,i,{enumerable:!0,get:t[i]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){a.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){a.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}}(),function(){a.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){a.p="/"}(),function(){var e={524:0};a.O.j=function(t){return 0===e[t]};var t=function(t,i){var s,l,o=i[0],r=i[1],n=i[2],c=0;if(o.some((function(t){return 0!==e[t]}))){for(s in r)a.o(r,s)&&(a.m[s]=r[s]);if(n)var d=n(a)}for(t&&t(i);c<o.length;c++)l=o[c],a.o(e,l)&&e[l]&&e[l][0](),e[l]=0;return a.O(d)},i=self["webpackChunkpandora_helper"]=self["webpackChunkpandora_helper"]||[];i.forEach(t.bind(null,0)),i.push=t.bind(null,i.push.bind(i))}();var i=a.O(void 0,[504],(function(){return a(5399)}));i=a.O(i)})();
//# sourceMappingURL=app.ea727216.js.map