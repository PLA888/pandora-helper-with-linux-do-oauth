(function(){"use strict";var t={2248:function(t,e,a){var i=a(2856),s=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("router-view")],1)},l=[],o={name:"App"},n=o,r=a(1656),c=(0,r.A)(n,s,l,!1,null,null,null),d=c.exports,u=a(184),h=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"app"}},[e("div",{staticClass:"login-container"},[e("h1",{staticStyle:{"margin-left":"10px"}},[t._v(" Panel "),e("span",{staticClass:"toggle-icon-container",on:{mouseenter:function(e){t.showExtraIcons=!0},mouseleave:function(e){t.showExtraIcons=!1}}},[e("img",{attrs:{src:a(8902),alt:"switch"},on:{click:function(e){return t.switchToIndex()}}}),e("transition",{attrs:{name:"fade"}},[t.showExtraIcons?e("div",{staticClass:"extra-icons"},[e("img",{attrs:{src:a(7343),alt:"Icon 2"},on:{click:function(e){return t.navigateTo("pandora")}}}),e("img",{attrs:{src:a(864),alt:"Icon 1"},on:{click:function(e){return t.navigateTo("claude")}}})]):t._e()])],1)]),e("form",{on:{submit:function(e){return e.preventDefault(),t.userlogin()}}},[e("input",{attrs:{type:"text",id:"username",placeholder:"用户名",required:""}}),e("input",{attrs:{type:"password",id:"password",placeholder:"密码",required:""}}),t._m(0)]),t._m(1),e("div",{staticClass:"alternative-login"},[e("div",{staticClass:"oauth-buttons"},[e("img",{attrs:{src:a(4832),alt:"LINUX DO"},on:{click:function(e){return t.initiateOAuth()}}})]),e("button",{attrs:{type:"button"},on:{click:function(e){return t.reset()}}},[t._v("重置密码")])]),e("div",{staticClass:"footer",on:{click:function(e){return t.index()}}},[e("a",{attrs:{href:"https://github.com/Kylsky/pandora-helper-with-linux-do-oauth",target:"_blank"}},[t._v("Powered by Yeelo")])])])])},p=[function(){var t=this,e=t._self._c;return e("button",{attrs:{type:"submit"}},[e("span",{staticClass:"btn-text"},[t._v("登录")]),e("span",{staticClass:"spinner"})])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"divider"},[e("span",[t._v("OR")])])}],m=a(7423);const f={apiBaseUrl:"https://connect.yeelo.fun"},g=async()=>{try{const t=await m.A.get("/oauth2/config");console.log(t.data),f.apiBaseUrl=t.data||f.apiBaseUrl}catch(t){console.error("Error loading config:",t)}};var v=f;a(4114);const b=m.A.create({baseURL:"https://127.0.0.1:8080",headers:{"Content-Type":"application/json"},timeout:1e4});b.interceptors.response.use((t=>t),(t=>{const{response:e}=t;if(console.log(t),e){if(302===e.status){const t=e.headers["location"];t&&(window.location.href=t)}401!==e.status&&403!==e.status||ce.push({path:"/"})}return Promise.reject(t)}));var y=b,C=a(2457),w=a.n(C);const _={success(t,e=3e3){(0,C.Message)({message:t,type:"success",duration:e,showClose:!0})},error(t,e=3e3){(0,C.Message)({message:t,type:"error",duration:e,showClose:!0})},warning(t,e=3e3){(0,C.Message)({message:t,type:"warning",duration:e,showClose:!0})},info(t,e=3e3){(0,C.Message)({message:t,type:"info",duration:e,showClose:!0})},handleResponse(t,e="操作成功"){return t.data.status?(this.success(e),!0):(this.error(t.data.message||"操作失败"),!1)},handleError(t){t.response?this.error(t.response.data.message||"请求失败"):t.request?this.error("网络连接失败，请检查网络"):this.error("请求配置错误")}};var k=_,I={name:"IndexPage",props:{},data(){return{showExtraIcons:!1}},methods:{reset(){this.$router.replace({name:"reset"})},async userlogin(){const t=document.querySelector('button[type="submit"]');t.classList.add("loading");var e=document.getElementById("username").value,a=document.getElementById("password").value;try{const i=await y.post(`${v.apiBaseUrl}/user/login`,{username:e,password:a});this.loading=!1;const s=i.data.status;if(!s)return k.error(i.data.message),t.classList.remove("loading"),!1;const l=i.data,o=l.data.jwt,n=l.data.avatarUrl;localStorage.setItem("token",o),n&&localStorage.setItem("img",n),t.classList.remove("loading"),this.$router.replace({name:"navi"})}catch(s){t.classList.remove("loading");var i=i;k.error(i)}},async initiateOAuth(){try{const e=await y.get(`${v.apiBaseUrl}/oauth2/initiate?type=panel`);var t=e;console.log(t),t.data?window.location=t.data:console.error("No redirect URL provided")}catch(e){console.error("Request failed with status:",e)}},switchToIndex(){},navigateTo(t){this.$router.replace({name:t})}}},x=I,S=(0,r.A)(x,h,p,!1,null,"c520d34e",null),A=S.exports,V=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"reset"}},[e("div",{staticClass:"reset-container"},[e("h1",[t._v("重置密码")]),e("form",{on:{submit:function(e){return e.preventDefault(),t.resetPassword()}}},[e("input",{attrs:{type:"text",id:"username",placeholder:"用户名",required:""}}),e("input",{attrs:{type:"password",id:"oldPassword",placeholder:"旧密码",required:""}}),e("input",{attrs:{type:"password",id:"newPassword",placeholder:"新密码",required:""}}),e("input",{attrs:{type:"password",id:"confirmPassword",placeholder:"再次确认新密码",required:""}}),e("button",{attrs:{type:"submit"}},[t._v("重置")]),e("button",{staticClass:"home-button",attrs:{type:"button"},on:{click:function(e){return t.goHome()}}},[t._v("返回主页")])]),e("div",{staticClass:"footer"},[t._v(" Powered by Yeelo ")])])])},F=[],D={name:"ResetPage",methods:{async resetPassword(){var t=document.getElementById("username").value,e=document.getElementById("oldPassword").value,a=document.getElementById("newPassword").value,i=document.getElementById("confirmPassword").value;if(e===a)return alert("新密码不能和旧密码相同，请重新输入。"),!1;if(a.length<8)return alert("密码长度必须超过大于等于8位，请重新输入。"),!1;if(a!==i)return alert("两次输入的密码不一致，请重新输入。"),!1;try{const s=await y.post(`${v.apiBaseUrl}/pandora/reset`,{username:t,oldPassword:e,newPassword:a,confirmPassword:i}),l=s.data.status;l?(alert("密码重置成功！"),this.$router.replace({name:"home"})):alert(s.data.message)}catch(s){alert(s)}},async goHome(){this.$router.replace({name:"home"})}}},P=D,T=(0,r.A)(P,V,F,!1,null,"ca797f4e",null),B=T.exports,M=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"pandora"}},[e("div",{staticClass:"login-container"},[e("h1",{staticStyle:{"margin-left":"10px"}},[t._v("Pandora"),e("span",{staticClass:"toggle-icon",on:{click:function(e){return t.switchToFuclaude()}}},[e("img",{attrs:{src:a(8902),title:"切换至Panel",alt:"hi"}})])]),e("form",{on:{submit:function(e){return e.preventDefault(),t.userlogin()}}},[e("input",{attrs:{type:"text",id:"username",placeholder:"用户名",required:""}}),e("input",{attrs:{type:"password",id:"password",placeholder:"密码",required:""}}),t._m(0)]),t._m(1),e("div",{staticClass:"alternative-login"},[e("div",{staticClass:"oauth-buttons"},[e("img",{attrs:{src:a(4832),alt:"LINUX DO"},on:{click:function(e){return t.initiateOAuth()}}})]),e("button",{attrs:{type:"button"},on:{click:function(e){return t.reset()}}},[t._v("重置密码")])]),e("div",{staticClass:"footer"},[t._v(" Powered by Pandora ")])])])},$=[function(){var t=this,e=t._self._c;return e("button",{attrs:{type:"submit"}},[e("span",{staticClass:"btn-text"},[t._v("登录")]),e("span",{staticClass:"spinner"})])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"divider"},[e("span",[t._v("OR")])])}],z={name:"PandoraPage",methods:{reset(){this.$router.replace({name:"reset"})},async userlogin(){const t=document.querySelector('button[type="submit"]');t.classList.add("loading");var e=document.getElementById("username").value,a=document.getElementById("password").value;try{const s=await y.post(`${v.apiBaseUrl}/pandora/login`,{username:e,password:a}),l=s.data.status;if(l)t.classList.remove("loading"),window.open(s.data.data);else{var i=s.data.message;t.classList.remove("loading"),k.error(i)}}catch(s){t.classList.remove("loading"),k.error(s)}},async initiateOAuth(){try{const e=await y.get(`${v.apiBaseUrl}/oauth2/initiate?type=ChatGPT`);var t=e;console.log(t),t.data?window.location=t.data:console.error("No redirect URL provided")}catch(e){k.error(e)}},switchToFuclaude(){this.$router.replace({name:"home"})}}},E=z,U=(0,r.A)(E,M,$,!1,null,"e9d46b36",null),q=U.exports,O=function(){var t=this;t._self._c;return t._m(0)},L=[function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"loading"}},[e("div",{staticClass:"loading-container"},[e("div",{staticClass:"loader-wrapper"},[e("div",{staticClass:"loader"}),e("div",{staticClass:"loader-inner"})]),e("p",{staticClass:"message"},[t._v("正在授权，请稍候...")]),e("p",{staticClass:"sub-message"},[t._v("Loading...")])])])}],N=(a(4603),a(7566),a(8721),{name:"LoadingPage",methods:{async fetchToken(t,e){console.log(t,e);const a=await y.get(`${v.apiBaseUrl}/oauth2/callback?code=${t}&state=${e}`,{withCredentials:!0});if(a.data.status){let t=JSON.parse(a.data.data);console.log(t.avatar_url),localStorage.setItem("img",t.avatar_url),"ChatGPT"===t.shareType?await this.startGPTChat(t.username,t.jmc):"Claude"===t.shareType?await this.startClaudeChat(t.username,t.jmc):"panel"===t.shareType&&await this.startPanel(t.username,t.jmc)}},async startGPTChat(t,e){const a=await y.get(`${v.apiBaseUrl}/pandora/checkUser?username=${t}&jmc=${e}`,{withCredentials:!0});a.data.status&&a.data.data.isShared?window.open(a.data.data.address):(k.error("您的账号未激活，请联系管理员"),this.$router.replace({name:"pandora"}))},async startClaudeChat(t,e){const a=await y.get(`${v.apiBaseUrl}/fuclaude/checkUser?username=${t}&jmc=${e}`,{withCredentials:!0});a.data.status?window.open(a.data.data):(k.error("您的账号未激活，请联系管理员"),this.$router.replace({name:"claude"}))},async startPanel(t,e){console.log("hi");const a=await y.get(`${v.apiBaseUrl}/share/checkUser?username=${t}&jmc=${e}`,{withCredentials:!0});a.data.status?(localStorage.setItem("token",a.data.data),this.$router.replace({name:"navi"})):(k.error(a.data.message),this.$router.replace({name:""}))}},mounted(){const t=new URL(window.location.href),e=new URLSearchParams(t.search),a=e.get("code"),i=e.get("state");a&&i&&this.fetchToken(a,i)}}),j=N,G=(0,r.A)(j,O,L,!1,null,"26bcbb86",null),R=G.exports,K=function(){var t=this,e=t._self._c;return e("div",{attrs:{id:"claude"}},[e("div",{staticClass:"login-container"},[e("h1",{staticStyle:{"margin-left":"10px"}},[t._v("Fuclaude"),e("span",{staticClass:"toggle-icon",on:{click:function(e){return t.switchToPandora()}}},[e("img",{attrs:{src:a(8902),title:"切换至Panel",alt:"hi"}})])]),e("form",{on:{submit:function(e){return e.preventDefault(),t.userlogin()}}},[e("input",{attrs:{type:"text",id:"username",placeholder:"用户名",required:""}}),e("input",{attrs:{type:"password",id:"password",placeholder:"密码",required:""}}),t._m(0)]),t._m(1),e("div",{staticClass:"alternative-login"},[e("div",{staticClass:"oauth-buttons"},[e("img",{attrs:{src:a(4832),alt:"LINUX DO"},on:{click:function(e){return t.initiateOAuth()}}})]),e("button",{attrs:{type:"button"},on:{click:function(e){return t.reset()}}},[t._v("重置密码")])]),e("div",{staticClass:"footer"},[t._v(" Powered by Fuclaude ")])])])},Y=[function(){var t=this,e=t._self._c;return e("button",{attrs:{type:"submit"}},[e("span",{staticClass:"btn-text"},[t._v("登录")]),e("span",{staticClass:"spinner"})])},function(){var t=this,e=t._self._c;return e("div",{staticClass:"divider"},[e("span",[t._v("OR")])])}],H={name:"ClaudePage",methods:{reset(){this.$router.replace({name:"reset"})},async userlogin(){const t=document.querySelector('button[type="submit"]');t.classList.add("loading");var e=document.getElementById("username").value,a=document.getElementById("password").value;try{const s=await y.post(`${v.apiBaseUrl}/fuclaude/login`,{username:e,password:a}),l=s.data.status;if(l)t.classList.remove("loading"),window.open(s.data.data);else{t.classList.remove("loading");var i=s.data.message;alert(i)}}catch(s){t.classList.remove("loading"),alert(s)}},async initiateOAuth(){try{const e=await y.get(`${v.apiBaseUrl}/oauth2/initiate?type=Claude`);var t=e;console.log(t),t.data?window.location=t.data:console.error("No redirect URL provided")}catch(e){alert(e)}},switchToPandora(){this.$router.replace({name:"home"})}}},Q=H,W=(0,r.A)(Q,K,Y,!1,null,"58a7c43c",null),X=W.exports,J=function(){var t=this,e=t._self._c;return e("el-container",{attrs:{id:"navi"}},[t.isMobile&&!t.isCollapse?e("div",{staticClass:"mobile-overlay",on:{click:t.toggleCollapse}}):t._e(),e("el-aside",{class:["sidebar",{"mobile-sidebar":t.isMobile,collapsed:t.isCollapse}],attrs:{width:t.getSidebarWidth}},[e("div",{staticClass:"sidebar-header"},[e("h2",{directives:[{name:"show",rawName:"v-show",value:!t.isCollapse,expression:"!isCollapse"}],staticClass:"site-title"},[t._v("Pandora Helper")]),t.isMobile?t._e():e("el-button",{staticClass:"collapse-btn",attrs:{icon:t.isCollapse?"el-icon-s-unfold":"el-icon-s-fold"},on:{click:t.toggleCollapse}})],1),e("el-menu",{staticClass:"el-menu-vertical-demo",attrs:{"default-active":"accountNav","background-color":"#ffffff","text-color":"#333","active-text-color":"#fff",collapse:t.isCollapse,"collapse-transition":!1},on:{select:t.handleMenuSelect}},[e("el-menu-item",{attrs:{index:"accountNav"}},[e("i",{staticClass:"el-icon-s-custom"}),e("span",{attrs:{slot:"title"},slot:"title"},[t._v("账号管理")])]),e("el-menu-item",{attrs:{index:"shareNav"}},[e("i",{staticClass:"el-icon-share"}),e("span",{attrs:{slot:"title"},slot:"title"},[t._v("分享管理")])]),e("el-menu-item",{attrs:{index:"redemptionNav"}},[e("i",{staticClass:"el-icon-shopping-cart-full"}),e("span",{attrs:{slot:"title"},slot:"title"},[t._v("兑换码")])]),e("el-menu-item",{attrs:{index:"carNav"}},[e("i",{staticClass:"el-icon-truck"}),e("span",{attrs:{slot:"title"},slot:"title"},[t._v("停车场")])]),e("el-menu-item",{attrs:{index:"freeNav"}},[e("i",{staticClass:"el-icon-medal"}),e("span",{attrs:{slot:"title"},slot:"title"},[t._v("免费号池")])])],1),e("el-dropdown",{staticClass:"user-menu",attrs:{trigger:"click","popper-class":"user-dropdown"}},[e("span",{staticClass:"el-dropdown-link"},[e("el-avatar",{staticClass:"user-avatar",attrs:{size:40,src:t.avatar}})],1),e("el-dropdown-menu",{attrs:{slot:"dropdown"},slot:"dropdown"},[e("el-dropdown-item",{nativeOn:{click:function(e){return t.showModal.apply(null,arguments)}}},[e("i",{staticClass:"el-icon-key"}),e("span",[t._v("兑换码激活")])]),e("el-dropdown-item",{nativeOn:{click:function(e){return t.logout.apply(null,arguments)}}},[e("i",{staticClass:"el-icon-switch-button"}),e("span",[t._v("退出登录")])])],1)],1)],1),e("el-main",{class:["main-content",{"mobile-main":t.isMobile}]},[t.isMobile&&t.isCollapse?e("div",{staticClass:"menu-trigger",on:{click:t.toggleCollapse}},[e("i",{staticClass:"el-icon-s-operation"})]):t._e(),e("enhanced-dialog",{attrs:{isVisible:t.modalVisible,title:t.modalTitle},on:{close:t.closeModal,confirm:t.submitForm}},t._l(t.formFields,(function(a,i){return e("form-input",{key:i,attrs:{field:a},on:{updateValue:t.handleUpdateValue}})})),1),e(t.currentComponent,{tag:"component"})],1)],1)},Z=[],tt=function(){var t=this,e=t._self._c;return e("div",{staticClass:"form-group"},[t.field.hideLabel?t._e():e("label",{staticClass:"form-label",attrs:{for:t.field.id}},[t._v(t._s(t.field.label))]),"checkbox"===t.field.type&&!t.field.hideLabel&&"number"===t.field.type|"text"===t.field.type|"date"===t.field.type|"password"===t.field.type?e("input",{directives:[{name:"model",rawName:"v-model",value:t.localValue,expression:"localValue"}],staticClass:"form-input",attrs:{id:t.field.id,type:"checkbox"},domProps:{checked:Array.isArray(t.localValue)?t._i(t.localValue,null)>-1:t.localValue},on:{change:function(e){var a=t.localValue,i=e.target,s=!!i.checked;if(Array.isArray(a)){var l=null,o=t._i(a,l);i.checked?o<0&&(t.localValue=a.concat([l])):o>-1&&(t.localValue=a.slice(0,o).concat(a.slice(o+1)))}else t.localValue=s}}}):"radio"===t.field.type&&!t.field.hideLabel&&"number"===t.field.type|"text"===t.field.type|"date"===t.field.type|"password"===t.field.type?e("input",{directives:[{name:"model",rawName:"v-model",value:t.localValue,expression:"localValue"}],staticClass:"form-input",attrs:{id:t.field.id,type:"radio"},domProps:{checked:t._q(t.localValue,null)},on:{change:function(e){t.localValue=null}}}):!t.field.hideLabel&&"number"===t.field.type|"text"===t.field.type|"date"===t.field.type|"password"===t.field.type?e("input",{directives:[{name:"model",rawName:"v-model",value:t.localValue,expression:"localValue"}],staticClass:"form-input",attrs:{id:t.field.id,type:t.field.type},domProps:{value:t.localValue},on:{input:function(e){e.target.composing||(t.localValue=e.target.value)}}}):t._e(),"select"===t.field.type?e("select",{directives:[{name:"model",rawName:"v-model",value:t.localValue,expression:"localValue"}],staticClass:"form-select",attrs:{id:t.field.id},on:{change:[function(e){var a=Array.prototype.filter.call(e.target.options,(function(t){return t.selected})).map((function(t){var e="_value"in t?t._value:t.value;return e}));t.localValue=e.target.multiple?a:a[0]},function(e){return t.handleSelectChange(e)}]}},t._l(t.field.options,(function(a){return e("option",{key:a.value,domProps:{value:a.value}},[t._v(" "+t._s(a.text)+" ")])})),0):t._e(),"checkbox"===t.field.type?e("div",{staticClass:"switch-wrapper"},[e("input",{directives:[{name:"model",rawName:"v-model",value:t.localValue,expression:"localValue"}],staticClass:"switch-input",attrs:{type:"checkbox",id:t.field.id},domProps:{checked:Array.isArray(t.localValue)?t._i(t.localValue,null)>-1:t.localValue},on:{change:function(e){var a=t.localValue,i=e.target,s=!!i.checked;if(Array.isArray(a)){var l=null,o=t._i(a,l);i.checked?o<0&&(t.localValue=a.concat([l])):o>-1&&(t.localValue=a.slice(0,o).concat(a.slice(o+1)))}else t.localValue=s}}}),e("label",{staticClass:"switch-label",attrs:{for:t.field.id}},[e("span",{staticClass:"switch-button"})])]):t._e()])},et=[],at={props:{field:Object},data(){return{localValue:this.initializeValue()}},methods:{initializeValue(){return"select"===this.field.type&&this.field.options&&this.field.options.length>0?this.field.value||this.field.options[0].value:this.field.value},handleSelectChange(t){const e=t.target.value;this.$emit("handleSelectChange",{type:1,field:this.field,value:e})}},watch:{localValue(t){this.$emit("updateValue",this.field.id,t)},field:{handler(){this.localValue=this.initializeValue()},deep:!0,immediate:!0}}},it=at,st=(0,r.A)(it,tt,et,!1,null,"2886aa49",null),lt=st.exports,ot=function(){var t=this,e=t._self._c;return e("transition",{attrs:{name:"modal"}},[t.isVisible?e("div",{staticClass:"modal-overlay",on:{click:t.close}},[e("div",{staticClass:"modal-content",attrs:{role:"dialog","aria-modal":"true","aria-labelledby":t.title},on:{click:function(t){t.stopPropagation()}}},[e("header",{staticClass:"modal-header"},[e("h3",{attrs:{id:t.title}},[t._v(t._s(t.title))]),e("button",{staticClass:"close-button",attrs:{"aria-label":"关闭对话框"},on:{click:t.close}},[e("svg",{staticClass:"close-icon",attrs:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor"}},[e("path",{attrs:{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"}})])])]),e("main",{staticClass:"modal-body"},[t._t("default")],2),e("footer",{staticClass:"modal-footer"},[e("button",{staticClass:"btn btn-cancel",on:{click:t.close}},[t._v("取消")]),e("button",{staticClass:"btn btn-confirm",on:{click:t.confirm}},[t._v("确认")])])])]):t._e()])},nt=[],rt={props:{isVisible:{type:Boolean,default:!1},title:{type:String,default:"标题"}},mounted(){this.isVisible&&this.preventBodyScroll(),window.addEventListener("keydown",this.handleKeydown)},beforeDestroy(){this.enableBodyScroll(),window.removeEventListener("keydown",this.handleKeydown)},watch:{isVisible(t){t?this.preventBodyScroll():this.enableBodyScroll()}},methods:{close(){this.$emit("close")},confirm(){this.$emit("confirm")},handleKeydown(t){this.isVisible&&"Escape"===t.key&&this.close()},preventBodyScroll(){document.body.style.overflow="hidden",document.body.style.position="fixed",document.body.style.width="100%"},enableBodyScroll(){document.body.style.overflow="",document.body.style.position="",document.body.style.width=""}}},ct=rt,dt=(0,r.A)(ct,ot,nt,!1,null,"235e7244",null),ut=dt.exports,ht=function(){var t=this,e=t._self._c;return e("el-container",{staticClass:"panel",attrs:{id:"accountPanel"}},[e("el-header",[e("h2",[t._v("账号管理")])]),e("el-main",[e("el-row",{staticClass:"search-bar",attrs:{gutter:20}},[e("el-col",{attrs:{xs:24,sm:24,md:18}},[e("el-input",{staticClass:"search-input",attrs:{id:"email-query",placeholder:"请输入邮箱"},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}},[e("el-button",{attrs:{slot:"append"},on:{click:t.emailQuery},slot:"append"},[t._v("查询")])],1)],1),e("el-col",{staticClass:"create-btn-wrapper",attrs:{xs:24,sm:24,md:6}},[e("el-button",{staticClass:"create-new",attrs:{type:"primary"},on:{click:function(e){return t.showModal()}}},[t._v("新增")])],1)],1),e("div",{staticClass:"pc-view"},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,fit:!0}},[e("el-table-column",{attrs:{prop:"email",label:"邮箱","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{prop:"type",label:"账号类型","show-overflow-tooltip":""}}),e("el-table-column",{attrs:{prop:"shared",label:"共享","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(t){return[1===t.row.shared?e("i",{staticClass:"el-icon-circle-check",staticStyle:{color:"green"}}):e("i",{staticClass:"el-icon-circle-close",staticStyle:{color:"red"}})]}}])}),e("el-table-column",{attrs:{prop:"updateTime",label:"更新时间"}}),e("el-table-column",{attrs:{label:"操作",width:"350"},scopedSlots:t._u([{key:"default",fn:function(a){return[1===a.row.accountType?e("el-button",{attrs:{type:"info",size:"mini"},on:{click:function(e){return t.refresh(a.row.id)}}},[t._v("刷新")]):t._e(),e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.showShareModal(a.row.id)}}},[t._v("共享")]),e("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(e){return t.editItem(a.row.id)}}},[t._v("编辑")]),e("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(e){return t.showConfirmDialog(a.row.id)}}},[t._v("删除")])]}}])})],1)],1),e("div",{staticClass:"mobile-view"},t._l(t.tableData,(function(a,i){return e("div",{key:i,staticClass:"mobile-card"},[e("div",{staticClass:"mobile-card-header"},[e("div",{staticClass:"email-badge"},[e("i",{staticClass:"el-icon-message"}),t._v(" "+t._s(a.email)+" ")]),e("div",{staticClass:"status-badge",class:{"status-shared":1===a.shared}},[t._v(" "+t._s(1===a.shared?"已共享":"未共享")+" ")])]),e("div",{staticClass:"mobile-card-content"},[e("div",{staticClass:"info-row"},[e("div",{staticClass:"info-item"},[e("div",{staticClass:"info-label"},[e("i",{staticClass:"el-icon-user"}),t._v(" 账号类型 ")]),e("div",{staticClass:"info-value"},[t._v(t._s(a.type))])]),e("div",{staticClass:"info-item"},[e("div",{staticClass:"info-label"},[e("i",{staticClass:"el-icon-time"}),t._v(" 更新时间 ")]),e("div",{staticClass:"info-value"},[t._v(t._s(a.updateTime))])])])]),e("div",{staticClass:"mobile-card-divider"}),e("div",{staticClass:"mobile-card-actions"},[e("div",{staticClass:"action-row"},[1===a.accountType?e("el-button",{attrs:{type:"info",size:"mini"},on:{click:function(e){return t.refresh(a.id)}}},[e("i",{staticClass:"el-icon-refresh"}),t._v(" 刷新 ")]):t._e(),e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.showShareModal(a.id)}}},[e("i",{staticClass:"el-icon-share"}),t._v(" 共享 ")]),e("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(e){return t.editItem(a.id)}}},[e("i",{staticClass:"el-icon-edit"}),t._v(" 编辑 ")])],1),e("div",{staticClass:"action-row"},[e("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){return t.showConfirmDialog(a.id)}}},[e("i",{staticClass:"el-icon-delete"}),t._v(" 删除 ")])],1)])])})),0),e("div",{staticClass:"pagination-container"},[e("el-pagination",{staticClass:"pagination-wrapper",attrs:{"current-page":t.currentPage,"page-size":10,layout:t.isMobile?"prev, pager, next":"prev, pager, next, jumper","pager-count":t.isMobile?5:7,total:t.total},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e}}})],1),e("enhanced-dialog",{attrs:{isVisible:t.modalVisible,title:t.modalTitle},on:{close:t.closeModal,confirm:t.submitForm}},t._l(t.formFields,(function(a,i){return e("form-input",{key:i,attrs:{field:a},on:{updateValue:t.handleUpdateValue}})})),1),e("confirm-dialog",{attrs:{visible:t.isDialogVisible,title:"确认删除",message:"你确定要删除这个账号吗？"},on:{"update:visible":function(e){t.isDialogVisible=e},confirm:t.handleDelete}}),t.chartsVisible?e("div",{staticClass:"chart-overlay"},[e("div",{staticClass:"chart-container"},[e("div",{ref:"chart",staticClass:"chart-content"}),e("el-button",{attrs:{type:"primary",size:"small"},on:{click:t.closeChart}},[t._v("关闭")])],1)]):t._e()],1)],1)},pt=[],mt=a(3944),ft=function(){var t=this,e=t._self._c;return e("transition",{attrs:{name:"zoom"}},[t.localVisible?e("div",{staticClass:"dialog-overlay",on:{click:function(e){return e.target!==e.currentTarget?null:t.handleClose.apply(null,arguments)}}},[e("div",{staticClass:"dialog-container"},[e("div",{staticClass:"dialog-header"},[e("h3",[t._v(t._s(t.title))]),e("button",{staticClass:"close-button",on:{click:t.handleClose}},[t._v("×")])]),e("div",{staticClass:"dialog-body"},[e("i",{staticClass:"icon-warning"}),e("p",[t._v(t._s(t.message))])]),e("div",{staticClass:"dialog-footer"},[e("button",{staticClass:"btn btn-confirm",on:{click:t.handleConfirm}},[t._v("确定")]),e("button",{staticClass:"btn btn-cancel",on:{click:t.handleClose}},[t._v("取消")])])])]):t._e()])},gt=[],vt={props:{visible:{type:Boolean,default:!1},title:{type:String,default:"确认"},message:{type:String,default:"你确定要执行这个操作吗？"}},data(){return{localVisible:this.visible}},watch:{visible(t){this.localVisible=t}},methods:{handleClose(){this.localVisible=!1,this.$emit("update:visible",!1)},handleConfirm(){this.$emit("confirm"),this.handleClose()}}},bt=vt,yt=(0,r.A)(bt,ft,gt,!1,null,"3891bc9e",null),Ct=yt.exports,wt={name:"AccountPage",components:{ConfirmDialog:Ct,EnhancedDialog:ut,FormInput:lt},data(){return{isMobile:!1,email:"",tableData:[],currentPage:1,shareAddFlag:!1,total:0,isDialogVisible:!1,isAccDialogVisible:!1,modalVisible:!1,modalTitle:"新增项目",currentIndex:null,chart:null,chartData:[],chartsVisible:!1,formData:{},shareFormData:{},formFields:[{id:"name",label:"账号名称",type:"text",value:"",required:!0},{id:"email",label:"邮箱地址",type:"text",value:"",required:!0},{id:"accountType",label:"账号类型",type:"select",value:"ChatGPT",options:[{value:1,text:"ChatGPT"},{value:2,text:"Claude"}],required:!0},{id:"userLimit",label:"分享人数上限",type:"text",value:"",required:!0},{id:"accessToken",label:"ACCESS_TOKEN",type:"text",value:"",required:!0},{id:"refreshToken",label:"REFRESH_TOKEN",type:"text",value:"",required:!1},{id:"shared",label:"是否共享",type:"checkbox",value:!1,required:!0},{id:"auto",label:"自动加入",type:"checkbox",value:!1,required:!0}],accountFields:[{id:"name",label:"账号名称",type:"text",value:"",required:!0},{id:"email",label:"邮箱地址",type:"text",value:"",required:!0},{id:"accountType",label:"账号类型",type:"select",value:"ChatGPT",options:[{value:1,text:"ChatGPT"},{value:2,text:"Claude"},{value:3,text:"API"}],required:!0},{id:"userLimit",label:"分享人数上限",type:"text",value:"",required:!0},{id:"accessToken",label:"ACCESS_TOKEN",type:"text",value:"",required:!0},{id:"refreshToken",label:"REFRESH_TOKEN",type:"text",value:"",hideLabel:!1},{id:"shared",label:"是否共享",type:"checkbox",value:!1,required:!0},{id:"auto",label:"自动加入",type:"checkbox",value:!1,required:!0}],shareFields:[{id:"username",label:"用户名",type:"text",value:"",required:!0},{id:"password",label:"密码",type:"password",value:"",required:!0},{id:"comment",label:"备注",type:"text",value:"",required:!0},{id:"expiresAt",label:"过期时间",type:"date",value:"",required:!0}]}},methods:{checkIsMobile(){this.isMobile=window.innerWidth<=768},initChart(){this.chart&&this.chart.dispose(),this.chart=mt.Ts(this.$refs.chart);const t={title:{text:"GPT使用情况",left:"center"},tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{data:["GPT-4o","GPT-4","GPT-4o-mini","o1-preview","o1-mini"],top:"bottom"},xAxis:{type:"category",data:this.chartData.map((t=>t.uniqueName)),axisLabel:{rotate:45}},yAxis:{type:"value",name:"使用次数"},series:[{name:"GPT-4o",type:"bar",data:this.chartData.map((t=>t.usage.gpt4o)),itemStyle:{color:"#91cc75"}},{name:"GPT-4",type:"bar",data:this.chartData.map((t=>t.usage.gpt4)),itemStyle:{color:"#5470c6"}},{name:"GPT-4o-mini",type:"bar",data:this.chartData.map((t=>t.usage.gpt4omini)),itemStyle:{color:"#fac858"}},{name:"o1-preview",type:"bar",data:this.chartData.map((t=>t.usage.o1Preview)),itemStyle:{color:"#2980b9"}},{name:"o1-mini",type:"bar",data:this.chartData.map((t=>t.usage.o1Mini)),itemStyle:{color:"#f0ad5e"}}]};this.chart.setOption(t)},async statistic(t){try{this.chartsVisible=!0;const e=await y.get(`${v.apiBaseUrl}/account/statistic?id=${t}`,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});e.data.status?(this.chartData=e.data.data,this.$nextTick((()=>{this.initChart()}))):this.$message.error("获取统计数据失败")}catch(e){console.error("Error fetching statistics:",e),this.$message.error("获取统计数据时发生错误")}},closeChart(){this.chartsVisible=!1,this.chart&&(this.chart.dispose(),this.chart=null)},showConfirmDialog(t){this.currentIndex=t,this.isDialogVisible=!0},async fetchAccounts(t){try{const e=await y.get(`${v.apiBaseUrl}/account/list?page=`+this.currentPage+"&size=10&emailAddr="+t,{withCredentials:!0,headers:{Authorization:"Bearer "+localStorage.getItem("token")}});e.data.status&&e.data.data.total>0&&(this.tableData=e.data.data.data,this.total=e.data.data.total)}catch(e){console.log(e)}},handleUpdateValue(t,e){this.$set(this.formData,t,e);const a=this.formFields.findIndex((e=>e.id===t));if(-1!==a&&(this.formFields[a].value=e),"accountType"===t){const t=this.formFields.find((t=>"accessToken"===t.id));switch(e){case 1:t.label="ACCESS_TOKEN";break;case 2:t.label="SESSION_KEY";break;case 3:t.label="API_PROXY";break;default:t.label="ChatGPT"}const a=this.formFields.find((t=>"refreshToken"===t.id));switch(a.hideLabel=!1,e){case 1:a.hideLabel=!1,a.label="REFRESH_TOKEN";break;case 2:a.hideLabel=!0;break;case 3:a.hideLabel=!1,a.label="API_KEY";break;default:a.hideLabel=!1,a.label="ChatGPT"}}},showModal(){this.modalTitle="新增账号",this.currentIndex=null,this.formFields=this.accountFields,this.resetFormFields(),this.modalVisible=!0},showShareModal(t){this.shareAddFlag=!0,this.modalTitle="新增共享",this.currentIndex=t,this.formFields=this.shareFields,this.resetFormFields(),this.modalVisible=!0},async editItem(t){this.modalTitle="编辑账号",this.formFields=this.accountFields,this.currentIndex=t;const e=await y.get(`${v.apiBaseUrl}/account/getById?id=`+t,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});let a=e.data.data,i=1;this.formFields.forEach((t=>{t.value=a[t.id],"accountType"===t.id&&(i=t.value),this.formData[t.id]=a[t.id]}));const s=this.formFields.find((t=>"accessToken"===t.id)),l=this.formFields.find((t=>"refreshToken"===t.id));switch(i){case 1:l.hideLabel=!1,s.label="ACCESS_TOKEN",l.label="REFRESH_TOKEN";break;case 2:s.label="SESSION_KEY",l.hideLabel=!0;break;case 3:s.label="API_PROXY",l.hideLabel=!1,l.label="API_KEY";break;default:l.hideLabel=!1,l.label="ChatGPT"}this.modalVisible=!0},closeModal(){this.currentIndex=null,this.modalVisible=!1,this.shareAddFlag=!1},async submitForm(){console.log(this.formData);const t={...this.formData};if(this.shareAddFlag){t.uniqueName=t.username,t.accountId=this.currentIndex,console.log(t);const e=await y.post(`${v.apiBaseUrl}/share/add`,t,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).catch((function(t){k.error(t)}));e.data.status?k.success("新增账号共享成功"):k.error(e.data.message)}else null!==this.currentIndex?(t.auto=t.auto?1:0,t.shared=t.shared?1:0,t.accountType=""===t.accountType?1:t.accountType,t.id=this.currentIndex,y.patch(`${v.apiBaseUrl}/account/update`,t,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).catch((function(t){k.error(t)})),k.success("修改成功")):(t.auto=t.auto?1:0,t.shared=t.shared?1:0,t.accountType=""===t.accountType?1:t.accountType,y.post(`${v.apiBaseUrl}/account/add`,t,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).catch((function(t){k.error(t)})),k.success("新增成功"));this.fetchAccounts(""),this.closeModal()},resetFormFields(){this.shareAdd=!1,this.formData={},this.formFields.forEach((t=>{const e="checkbox"!==t.type&&"";t.value=e,this.formData[t.id]=e}))},emailQuery(){console.log(this.email),this.fetchAccounts(this.email)},handleEdit(t){console.log(t+123123123)},handleAdd(){console.log()},async handleDelete(){const t=await y.delete(`${v.apiBaseUrl}/account/delete?id=`+this.currentIndex,{withCredentials:!0,headers:{Authorization:"Bearer "+localStorage.getItem("token")}});t.data.status?k.success("删除成功"):k.error("删除失败，请稍后重试"),this.fetchAccounts(""),this.currentIndex=null,this.isDialogVisible=!1},handleCurrentChange(t){console.log(t),this.fetchAccounts("")},async refresh(t){const e=await y.post(`${v.apiBaseUrl}/account/refresh?id=`+t,{},{withCredentials:!0,headers:{Authorization:"Bearer "+localStorage.getItem("token")}});e.data.status?k.success("刷新成功"):k.error(e.data.msg)}},mounted(){this.fetchAccounts(""),this.checkIsMobile(),window.addEventListener("resize",this.checkIsMobile)},beforeDestroy(){window.removeEventListener("resize",this.checkIsMobile)}},_t=wt,kt=(0,r.A)(_t,ht,pt,!1,null,"f9d43884",null),It=kt.exports,xt=function(){var t=this,e=t._self._c;return e("el-container",{staticClass:"panel",attrs:{id:"sharePanel"}},[e("el-header",[e("h2",[t._v("分享管理")])]),e("el-main",[e("el-row",{staticClass:"search-bar"},[e("el-col",{attrs:{xs:24,sm:18,md:18}},[e("el-input",{attrs:{id:"email-query",placeholder:"请输入邮箱或用户名"},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}},[e("el-button",{attrs:{slot:"append"},on:{click:t.emailQuery},slot:"append"},[t._v("查询")])],1)],1)],1),e("div",{staticClass:"pc-view"},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData,fit:!0}},[e("el-table-column",{attrs:{prop:"uniqueName",label:"用户名"}}),e("el-table-column",{attrs:{prop:"gptCarName",label:"ChatGPT账号",width:"180"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("split-button",{attrs:{name:a.row.gptCarName,count:a.row.gptUserCount||0,type:"gpt",loading:a.row.loading},on:{click:function(e){return t.openChat(a.row.gptConfigId,1,a)}}})]}}])}),e("el-table-column",{attrs:{prop:"claudeCarName",label:"Claude账号",width:"180"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("split-button",{attrs:{name:a.row.claudeCarName,count:a.row.claudeUserCount||0,type:"claude",loading:a.row.loading},on:{click:function(e){return t.openChat(a.row.claudeConfigId,2,a)}}})]}}])}),e("el-table-column",{attrs:{prop:"apiCarName",label:"API账号",width:"180"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("split-button",{attrs:{name:a.row.apiCarName,count:a.row.apiUserCount||0,type:"api",loading:a.row.loading},on:{click:function(e){return t.openChat(a.row.apiConfigId,3,a)}}})]}}])}),e("el-table-column",{attrs:{prop:"expiresAt",label:"过期时间"}}),e("el-table-column",{attrs:{label:"操作",width:"250"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticClass:"action-row"},[e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.showShareModal(a.row.id)}}},[t._v("激活")]),e("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(e){return t.editItem(a.row.id)}}},[t._v("编辑")]),e("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){return t.showConfirmDialog(a.row.id)}}},[t._v("删除")])],1)]}}])})],1)],1),e("div",{staticClass:"mobile-view"},t._l(t.tableData,(function(a,i){return e("div",{key:i,staticClass:"mobile-card"},[e("div",{staticClass:"mobile-card-header"},[e("div",{staticClass:"username-badge"},[e("i",{staticClass:"el-icon-user"}),t._v(" "+t._s(a.uniqueName)+" ")]),e("div",{staticClass:"expires-badge"},[t._v(" "+t._s(a.expiresAt)+" ")])]),e("div",{staticClass:"mobile-card-content"},[a.gptCarName?e("div",{staticClass:"account-item"},[e("div",{staticClass:"account-label"},[t._v("ChatGPT账号")]),e("div",{staticClass:"account-value"},[e("split-button",{attrs:{name:a.gptCarName,count:a.gptUserCount||0,type:"gpt",loading:a.loading},on:{click:function(e){return t.openChat(a.gptConfigId,1,a)}}})],1)]):t._e(),a.claudeCarName?e("div",{staticClass:"account-item"},[e("div",{staticClass:"account-label"},[t._v("Claude账号")]),e("div",{staticClass:"account-value"},[e("split-button",{attrs:{name:a.claudeCarName,count:a.claudeUserCount||0,type:"claude",loading:a.loading},on:{click:function(e){return t.openChat(a.claudeConfigId,2,a)}}})],1)]):t._e(),a.apiCarName?e("div",{staticClass:"account-item"},[e("div",{staticClass:"account-label"},[t._v("API账号")]),e("div",{staticClass:"account-value"},[e("split-button",{attrs:{name:a.apiCarName,count:a.apiUserCount||0,type:"api",loading:a.loading},on:{click:function(e){return t.openChat(a.apiConfigId,3,a)}}})],1)]):t._e()]),e("div",{staticClass:"mobile-card-divider"}),e("div",{staticClass:"mobile-card-actions"},[e("div",{staticClass:"action-row"},[e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.showShareModal(a.id)}}},[t._v("激活")]),e("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(e){return t.editItem(a.id)}}},[t._v("编辑")]),e("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){return t.showConfirmDialog(a.id)}}},[t._v("删除")])],1)])])})),0),e("div",{staticClass:"pagination-container"},[e("el-pagination",{staticClass:"pagination-wrapper",attrs:{"current-page":t.currentPage,"page-size":10,layout:t.isMobile?"prev, pager, next":"prev, pager, next, jumper","pager-count":t.isMobile?5:7,total:t.total},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e}}})],1),e("enhanced-dialog",{attrs:{isVisible:t.modalVisible,title:t.modalTitle},on:{close:t.closeModal,confirm:t.submitForm}},t._l(t.formFields,(function(a,i){return e("form-input",{key:i,attrs:{field:a},on:{updateValue:t.handleUpdateValue,handleSelectChange:t.handleSelectChange}})})),1),e("confirm-dialog",{attrs:{visible:t.isDialogVisible,title:"确认删除",message:"你确定要删除这个共享账户吗？"},on:{"update:visible":function(e){t.isDialogVisible=e},confirm:t.handleDelete}})],1)],1)},St=[],At=function(){var t=this,e=t._self._c;return e("el-tooltip",{attrs:{content:t.tooltipContent,placement:"top",effect:"light"}},[e("button",{staticClass:"split-button",class:[t.type,{disabled:0===t.count}],on:{click:t.handleClick}},[e("span",{staticClass:"name-section"},[e("i",{staticClass:"type-icon",class:t.typeIcon}),t._v(" "+t._s(t.shortName)+" ")]),e("span",{staticClass:"count-section"},[e("i",{staticClass:"el-icon-user user-icon"}),t._v(" "+t._s(t.count)+" ")])])])},Vt=[],Ft={name:"SplitButton",props:{name:{type:String,required:!0},count:{type:[String,Number],default:0},type:{type:String,default:"gpt",validator:function(t){return-1!==["gpt","claude","api"].indexOf(t)}},maxLength:{type:Number,default:10}},computed:{typeIcon(){const t={gpt:"el-icon-chat-dot-round",claude:"el-icon-message",api:"el-icon-connection"};return t[this.type]||"el-icon-chat-dot-round"},shortName(){return this.name.length>this.maxLength?this.name.substring(0,this.maxLength)+"...":this.name},tooltipContent(){return 0===Number(this.count)?"用户暂未拥有该类型账号":"点击开始对话"}},methods:{handleClick(){Number(this.count)>0&&this.$emit("click")}}},Dt=Ft,Pt=(0,r.A)(Dt,At,Vt,!1,null,"544e47f8",null),Tt=Pt.exports,Bt={name:"SharePage",components:{ConfirmDialog:Ct,EnhancedDialog:ut,FormInput:lt,SplitButton:Tt},data(){return{isMobile:!1,email:"",tableData:[],currentPage:1,total:0,isDialogVisible:!1,isAccDialogVisible:!1,modalVisible:!1,modalTitle:"新增项目",currentIndex:null,activateFlag:!1,accountOpts:[],formData:{},shareFormData:{},formFields:[{id:"uniqueName",label:"用户名",type:"text",value:"",required:!0,readonly:"1"},{id:"comment",label:"备注",type:"text",value:"",required:!0,readonly:!0},{id:"expiresAt",label:"过期时间",type:"date",value:"",required:!0}],accountFields:[{id:"uniqueName",label:"用户名",type:"text",value:"",required:!0},{id:"comment",label:"备注",type:"text",value:"",required:!0},{id:"expiresAt",label:"过期时间",type:"date",value:"",required:!0}],shareFields:[{id:"accountType",label:"账号类型",type:"select",value:"ChatGPT",options:[{value:1,text:"ChatGPT"},{value:2,text:"Claude"},{value:3,text:"API"}],required:!0},{id:"accountOptions",label:"选择账号",type:"select",value:"",options:this.accountOpts}]}},methods:{checkIsMobile(){this.isMobile=window.innerWidth<=768},async openChat(t,e,a){if(null===t)return;const i=C.Loading.service({target:a?a.el:document.body,text:"加载中...",spinner:"el-icon-loading",background:"rgba(255, 255, 255, 0.7)"});try{if(1===e){const e=await y.get(`${v.apiBaseUrl}/share/getGptShare?gptConfigId=`+t,{withCredentials:!0,headers:{Authorization:"Bearer "+localStorage.getItem("token")}});e.data.status&&window.open(e.data.data)}else if(2===e){const e=await y.get(`${v.apiBaseUrl}/share/getClaudeShare?claudeConfigId=`+t,{withCredentials:!0,headers:{Authorization:"Bearer "+localStorage.getItem("token")}});e.data.status&&window.open(e.data.data)}else if(3===e){const e=await y.get(`${v.apiBaseUrl}/share/getApiShare?apiConfigId=`+t,{withCredentials:!0,headers:{Authorization:"Bearer "+localStorage.getItem("token")}});e.data.status&&window.open(e.data.data)}}catch(s){console.error("请求失败:",s),this.$message.error("操作失败，请重试")}finally{i.close()}},showConfirmDialog(t){this.currentIndex=t,this.isDialogVisible=!0},async fetchItems(t){try{const e=await y.get(`${v.apiBaseUrl}/share/list?page=`+this.currentPage+"&size=10&emailAddr="+t,{withCredentials:!0,headers:{Authorization:"Bearer "+localStorage.getItem("token")}});e.data.status&&(this.tableData=e.data.data.data,this.total=e.data.data.total)}catch(e){k.error(e)}},handleUpdateValue(t,e){this.$set(this.formData,t,e);const a=this.formFields.findIndex((e=>e.id===t));-1!==a&&(this.formFields[a].value=e)},showModal(){this.modalTitle="新增账号",this.currentIndex=null,this.formFields=this.accountFields,this.resetFormFields(),this.modalVisible=!0},async showShareModal(t){this.shareAddFlag=!0,this.modalTitle="激活",this.currentIndex=t,this.formFields=this.shareFields,this.resetFormFields(),this.modalVisible=!0,this.activateFlag=!0;const e=await y.get(`${v.apiBaseUrl}/account/options?type=1`,{withCredentials:!0,headers:{Authorization:"Bearer "+localStorage.getItem("token")}});this.accountOpts=e.data.data;const a=this.shareFields.find((t=>"accountOptions"===t.id));a&&(a.options=this.accountOpts,this.formData={accountId:parseInt(this.accountOpts[0].value),id:t})},async editItem(t){this.modalTitle="编辑共享",this.formFields=this.accountFields,this.currentIndex=t;const e=await y.get(`${v.apiBaseUrl}/share/getById?id=`+t,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});let a=e.data.data;this.formFields.forEach((t=>{t.value=a[t.id],this.formData[t.id]=a[t.id]})),this.modalVisible=!0},closeModal(){this.modalVisible=!1,this.shareAddFlag=!1},async submitForm(){const t={...this.formData};if(this.activateFlag){console.log(t),t.accountId=t.accountOptions?parseInt(t.accountOptions):t.accountId,t.id=this.currentIndex,t.accountType=parseInt(t.accountType);const e=await y.post(`${v.apiBaseUrl}/share/distribute`,t,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).catch((function(t){k.error(t)}));e.data.status?k.success("激活成功"):k.error(e.data.message),this.fetchItems(""),this.currentIndex=null,this.activateFlag=!1}else if(null!==this.currentIndex){t.id=this.currentIndex;const e=await y.patch(`${v.apiBaseUrl}/share/update`,t,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).catch((function(t){k.error(t)}));e.data.status&&k.success("编辑成功")}this.fetchItems(""),this.closeModal()},resetFormFields(){this.shareAdd=!1,this.formData={},this.formFields.forEach((t=>{const e="checkbox"!==t.type&&"";t.value=e,this.formData[t.id]=e}))},emailQuery(){this.fetchItems(this.email)},async handleDelete(){const t=await y.delete(`${v.apiBaseUrl}/share/delete?id=`+this.currentIndex,{withCredentials:!0,headers:{Authorization:"Bearer "+localStorage.getItem("token")}});t.data.status?k.success("删除成功"):k.error("删除失败，请稍后重试"),this.fetchItems(""),this.isDialogVisible=!1},handleCurrentChange(t){console.log(t),this.fetchItems("")},async handleSelectChange({type:t,field:e,value:a}){if(1==t&&"accountOptions"!=e.id){const t=await y.get(`${v.apiBaseUrl}/account/options?type=`+a,{withCredentials:!0,headers:{Authorization:"Bearer "+localStorage.getItem("token")}});this.accountOpts=t.data.data,e.value=a;const i=this.shareFields.find((t=>"accountOptions"===t.id));i&&(i.options=this.accountOpts)}else console.log(e)}},mounted(){this.fetchItems(""),this.fetchItems(""),this.checkIsMobile(),window.addEventListener("resize",this.checkIsMobile)},beforeDestroy(){window.removeEventListener("resize",this.checkIsMobile)}},Mt=Bt,$t=(0,r.A)(Mt,xt,St,!1,null,"4ed1df34",null),zt=$t.exports,Et=function(){var t=this,e=t._self._c;return e("el-container",{staticClass:"panel"},[e("el-header",[e("div",{staticClass:"header-content"},[e("h2",[t._v("免费号池")]),e("el-switch",{attrs:{"active-color":"#0e8f6f","active-text":"Claude","inactive-text":"ChatGPT"},on:{change:t.toggleAIType},model:{value:t.showClaude,callback:function(e){t.showClaude=e},expression:"showClaude"}})],1)]),e("el-main",[e("el-row",{attrs:{gutter:20}},t._l(t.filteredAccounts,(function(a,i){return e("el-col",{key:i,staticStyle:{"padding-bottom":"15px"},attrs:{xs:24,sm:12,md:8,lg:6,xl:4}},[e("el-card",{class:{busy:"1"===a.sessionToken}},[e("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e("span",[t._v(t._s(a.type)+"账号 "+t._s(i+1))]),e("el-tag",{staticStyle:{float:"right"},attrs:{type:""===a.sessionToken?"success":"danger",size:"small"}},[t._v(" "+t._s(""!=a.sessionToken?"繁忙":"空闲")+" ")])],1),e("el-button",{attrs:{type:"primary",disabled:""!=a.sessionToken},on:{click:function(e){return t.useAccount(a.id)}}},[t._v(" 使用账号 ")])],1)],1)})),1)],1)],1)},Ut=[],qt={name:"App",data(){return{accounts:[],showClaude:!0}},computed:{filteredAccounts(){return this.accounts.filter((t=>this.showClaude?"Claude"===t.type:"ChatGPT"===t.type))}},created(){this.fetchAccounts()},methods:{handleSelect(t,e){console.log(t,e)},async fetchAccounts(){try{const t=await y.get(`${v.apiBaseUrl}/account/list?type=`+(this.showClaude?2:1),{withCredentials:!0,headers:{Authorization:"Bearer "+localStorage.getItem("token")}});t.data.status&&(this.accounts=t.data.data.data)}catch(t){k.error(t)}},async useAccount(t){try{const e=await y.get(`${v.apiBaseUrl}/account/share?id=`+t,{withCredentials:!0,headers:{Authorization:"Bearer "+localStorage.getItem("token")}});e.data.status?window.open(e.data.data):k.error(e.data.message)}catch(e){k.error(e)}},toggleAIType(){this.fetchAccounts()},handleCheckboxChange(t,e){console.log(`Account ${t.id} selection changed to ${e}`)}}},Ot=qt,Lt=(0,r.A)(Ot,Et,Ut,!1,null,"47331061",null),Nt=Lt.exports,jt=function(){var t=this,e=t._self._c;return e("el-container",{staticClass:"panel",attrs:{id:"redemptionPanel"}},[e("el-header",[e("h2",[t._v("兑换码管理")])]),e("el-main",[e("el-row",{staticClass:"search-bar"},[e("el-col",{attrs:{xs:24,sm:18,md:18}},[e("el-input",{attrs:{id:"email-query",placeholder:"请输入邮箱"},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}},[e("el-button",{attrs:{slot:"append"},on:{click:t.emailQuery},slot:"append"},[t._v("查询")])],1)],1),e("el-col",{staticClass:"btn-col",attrs:{xs:24,sm:6,md:6}},[e("el-button",{staticClass:"create-new",attrs:{type:"primary"},on:{click:function(e){return t.showModal()}}},[t._v("新增")])],1)],1),e("div",{staticClass:"pc-view"},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData}},[e("el-table-column",{attrs:{prop:"email",label:"邮箱"}}),e("el-table-column",{attrs:{prop:"accountType",label:"账号类型"}}),e("el-table-column",{attrs:{prop:"code",label:"兑换码"}}),e("el-table-column",{attrs:{prop:"duration",label:"兑换时长(天)"}}),e("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticClass:"action-row"},[e("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(e){return t.editItem(a.row.id)}}},[t._v("编辑")]),e("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(e){return t.showConfirmDialog(a.row.id)}}},[t._v("删除")])],1)]}}])})],1)],1),e("div",{staticClass:"mobile-view"},t._l(t.tableData,(function(a,i){return e("div",{key:i,staticClass:"mobile-card"},[e("div",{staticClass:"mobile-card-header"},[e("div",{staticClass:"email-badge"},[e("i",{staticClass:"el-icon-message"}),t._v(" "+t._s(a.email)+" ")]),e("div",{staticClass:"type-badge"},[t._v(" "+t._s(a.accountType)+" ")])]),e("div",{staticClass:"mobile-card-content"},[e("div",{staticClass:"info-row"},[e("div",{staticClass:"info-item"},[e("div",{staticClass:"info-label"},[e("i",{staticClass:"el-icon-key"}),t._v(" 兑换码 ")]),e("div",{staticClass:"info-value"},[t._v(t._s(a.code))])]),e("div",{staticClass:"info-item"},[e("div",{staticClass:"info-label"},[e("i",{staticClass:"el-icon-time"}),t._v(" 兑换时长 ")]),e("div",{staticClass:"info-value"},[t._v(t._s(a.duration)+" 天")])])])]),e("div",{staticClass:"mobile-card-divider"}),e("div",{staticClass:"mobile-card-actions"},[e("div",{staticClass:"action-row"},[e("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(e){return t.editItem(a.id)}}},[e("i",{staticClass:"el-icon-edit"}),t._v(" 编辑 ")]),e("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(e){return t.showConfirmDialog(a.id)}}},[e("i",{staticClass:"el-icon-delete"}),t._v(" 删除 ")])],1)])])})),0),e("div",{staticClass:"pagination-container"},[e("el-pagination",{staticClass:"pagination-wrapper",attrs:{"current-page":t.currentPage,"page-size":10,layout:t.isMobile?"prev, pager, next":"prev, pager, next, jumper","pager-count":t.isMobile?5:7,total:t.total},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e}}})],1),e("enhanced-dialog",{attrs:{isVisible:t.modalVisible,title:t.modalTitle},on:{close:t.closeModal,confirm:t.submitForm}},t._l(t.formFields,(function(a,i){return e("form-input",{key:i,attrs:{field:a},on:{updateValue:t.handleUpdateValue,handleSelectChange:t.handleSelectChange}})})),1),e("confirm-dialog",{attrs:{visible:t.isDialogVisible,title:"确认删除",message:"你确定要删除这个兑换码吗？"},on:{"update:visible":function(e){t.isDialogVisible=e},confirm:t.handleDelete}})],1)],1)},Gt=[],Rt={name:"SharePage",components:{ConfirmDialog:Ct,EnhancedDialog:ut,FormInput:lt},data(){return{isMobile:!1,email:"",tableData:[],currentPage:1,total:0,isDialogVisible:!1,isAccDialogVisible:!1,modalVisible:!1,modalTitle:"新增项目",currentIndex:null,activateFlag:!1,accountOpts:[],formData:{},shareFormData:{},formFields:[{id:"accountId",label:"账号",type:"select",value:"",required:!0,readonly:"1",options:[]},{id:"duration",label:"兑换时长(天)",type:"number",value:"",required:!0,readonly:!0},{id:"count",label:"兑换数量",type:"number",value:"",required:!0}],accountFields:[{id:"accountId",label:"账号",type:"select",value:"",required:!0,readonly:"1",options:[]},{id:"duration",label:"兑换时长(天)",type:"number",value:"",required:!0,readonly:!0},{id:"count",label:"兑换数量",type:"number",value:"",required:!0}],shareFields:[{id:"duration",label:"兑换时长(天)",type:"number",value:"",required:!0,readonly:!0}]}},methods:{checkIsMobile(){this.isMobile=window.innerWidth<=768},showConfirmDialog(t){this.currentIndex=t,this.isDialogVisible=!0},async fetchItems(t){try{const e=await y.get(`${v.apiBaseUrl}/redemption/list?page=`+this.currentPage+"&size=10&emailAddr="+t,{withCredentials:!0,headers:{Authorization:"Bearer "+localStorage.getItem("token")}});console.log(e.data.data),e.data.status&&(this.tableData=e.data.data.data,this.total=e.data.data.total)}catch(e){k.error(e)}},handleUpdateValue(t,e){this.$set(this.formData,t,e);const a=this.formFields.findIndex((e=>e.id===t));-1!==a&&(this.formFields[a].value=e)},async showModal(){this.modalTitle="新增兑换码",this.currentIndex=null,this.formFields=this.accountFields,this.resetFormFields(),this.modalVisible=!0;const t=await y.get(`${v.apiBaseUrl}/account/list`,{withCredentials:!0,headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).catch((function(t){k.error(t)})),e=this.accountFields.find((t=>"accountId"===t.id));if(e){let a=[];console.log(t.data.data.data);for(const e of t.data.data.data){let t=e.name+"("+(1===e.accountType?"ChatGPT":"Claude")+")",i=e.id,s={text:t,value:i};a.push(s)}e.options=a,console.log(e)}t.data.data},async editItem(t){this.modalTitle="编辑兑换码",this.formFields=this.shareFields,this.currentIndex=t;const e=await y.get(`${v.apiBaseUrl}/redemption/getById?id=`+t,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}});let a=e.data.data;this.formFields.forEach((t=>{t.value=a[t.id],this.formData[t.id]=a[t.id]})),this.modalVisible=!0},closeModal(){this.modalVisible=!1,this.shareAddFlag=!1,this.currentIndex=null},async submitForm(){const t={...this.formData};if(this.currentIndex){t.id=this.currentIndex,t.duration=parseInt(t.duration);const e=await y.patch(`${v.apiBaseUrl}/redemption/update`,t,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).catch((function(t){k.error(t)}));e.data.status?k.success("更新成功"):k.error("更新异常，请稍后重试")}else{console.log(t),t.accountId=parseInt(t.accountId),t.count=parseInt(t.count),t.duration=parseInt(t.duration);const e=await y.post(`${v.apiBaseUrl}/redemption/add`,t,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).catch((function(t){k.error(t)}));e.data.status?k.success("新增成功"):k.error(e.data.message),this.closeModal()}this.fetchItems(""),this.closeModal()},resetFormFields(){this.shareAdd=!1,this.formData={},this.formFields.forEach((t=>{const e="checkbox"!==t.type&&"";t.value=e,this.formData[t.id]=e}))},emailQuery(){this.fetchItems(this.email)},async handleDelete(){const t=await y.delete(`${v.apiBaseUrl}/redemption/delete?id=`+this.currentIndex,{withCredentials:!0,headers:{Authorization:"Bearer "+localStorage.getItem("token")}});t.data.status?k.success("删除成功"):k.error("删除失败，请稍后重试"),this.fetchItems(""),this.isDialogVisible=!1},handleCurrentChange(t){console.log(t),this.fetchItems("")},async handleSelectChange({type:t,field:e,value:a}){console.log(t,e,a)}},mounted(){this.fetchItems(""),this.checkIsMobile(),window.addEventListener("resize",this.checkIsMobile)},beforeDestroy(){window.removeEventListener("resize",this.checkIsMobile)}},Kt=Rt,Yt=(0,r.A)(Kt,jt,Gt,!1,null,"74ced31c",null),Ht=Yt.exports,Qt=function(){var t=this,e=t._self._c;return e("el-container",{staticClass:"panel",attrs:{id:"carPanel"}},[e("el-header",[e("h2",[t._v("停车场")])]),e("el-main",[e("el-row",{staticClass:"search-bar"},[e("el-col",{attrs:{xs:24,sm:18,md:18}},[e("el-input",{attrs:{id:"email-query",placeholder:"输入车主名称查询"},model:{value:t.email,callback:function(e){t.email=e},expression:"email"}},[e("el-button",{attrs:{slot:"append"},on:{click:t.emailQuery},slot:"append"},[t._v("查询")])],1)],1)],1),e("div",{staticClass:"pc-view"},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData}},[e("el-table-column",{attrs:{prop:"email",label:"账号"}}),e("el-table-column",{attrs:{prop:"type",label:"账号类型"}}),e("el-table-column",{attrs:{prop:"auto",label:"自动上车"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("span",{class:["status-tag",1===a.row.auto?"status-yes":"status-no"]},[t._v(" "+t._s(1===a.row.auto?"yes!":"No")+" ")])]}}])}),e("el-table-column",{attrs:{prop:"usernameDesc",label:"车主"}}),e("el-table-column",{attrs:{prop:"countDesc",label:"已上车人数 / 总人数"}}),e("el-table-column",{attrs:{label:"操作",width:"300"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("div",{staticClass:"action-buttons"},[!0===a.row.authorized?e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.showModal(a.row.id)}}},[t._v("审核")]):t._e(),e("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(e){return t.contact(a.row.username)}}},[t._v("联系车主")]),e("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(e){return t.applyCar(a.row.id)}}},[t._v("我要上车")])],1)]}}])})],1)],1),e("div",{staticClass:"mobile-view"},t._l(t.tableData,(function(a,i){return e("div",{key:i,staticClass:"mobile-card"},[e("div",{staticClass:"mobile-card-header"},[e("div",{staticClass:"account-badge"},[e("i",{staticClass:"el-icon-user"}),t._v(" "+t._s(a.email)+" ")]),e("div",{class:["auto-badge",1===a.auto?"auto-yes":"auto-no"]},[t._v(" "+t._s(1===a.auto?"自动上车":"手动上车")+" ")])]),e("div",{staticClass:"mobile-card-content"},[e("div",{staticClass:"info-row"},[e("div",{staticClass:"info-item"},[e("div",{staticClass:"info-label"},[e("i",{staticClass:"el-icon-key"}),t._v(" 账号类型 ")]),e("div",{staticClass:"info-value"},[t._v(t._s(a.type))])]),e("div",{staticClass:"info-item"},[e("div",{staticClass:"info-label"},[e("i",{staticClass:"el-icon-user"}),t._v(" 车主 ")]),e("div",{staticClass:"info-value"},[t._v(t._s(a.usernameDesc))])]),e("div",{staticClass:"info-item"},[e("div",{staticClass:"info-label"},[e("i",{staticClass:"el-icon-s-data"}),t._v(" 上车情况 ")]),e("div",{staticClass:"info-value"},[t._v(t._s(a.countDesc))])])])]),e("div",{staticClass:"mobile-card-divider"}),e("div",{staticClass:"mobile-card-actions"},[e("div",{staticClass:"action-row"},[!0===a.authorized?e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(e){return t.showModal(a.id)}}},[e("i",{staticClass:"el-icon-check"}),t._v(" 审核 ")]):t._e(),e("el-button",{attrs:{type:"warning",size:"mini"},on:{click:function(e){return t.contact(a.username)}}},[e("i",{staticClass:"el-icon-message"}),t._v(" 联系车主 ")]),e("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(e){return t.applyCar(a.id)}}},[e("i",{staticClass:"el-icon-plus"}),t._v(" 上车 ")])],1)])])})),0),e("div",{staticClass:"pagination-container"},[e("el-pagination",{staticClass:"pagination-wrapper",attrs:{"current-page":t.currentPage,"page-size":10,layout:t.isMobile?"prev, pager, next":"prev, pager, next, jumper","pager-count":t.isMobile?5:7,total:t.total},on:{"current-change":t.handleCurrentChange,"update:currentPage":function(e){t.currentPage=e},"update:current-page":function(e){t.currentPage=e}}})],1),e("el-dialog",{attrs:{visible:t.auditVisible,title:"审核申请",width:t.isMobile?"95%":"360px",fullscreen:!1,"custom-class":"modern-audit-dialog"},on:{"update:visible":function(e){t.auditVisible=e}}},[e("div",{staticClass:"audit-content"},[e("el-checkbox-group",{staticClass:"audit-checkbox-group",model:{value:t.auditValues,callback:function(e){t.auditValues=e},expression:"auditValues"}},t._l(t.auditOptions,(function(a){return e("el-checkbox",{key:a.value,staticClass:"audit-checkbox-item",attrs:{label:a.value}},[t._v(" "+t._s(a.label)+" ")])})),1)],1),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{attrs:{size:"small",type:"danger"},on:{click:function(e){return t.submitAudit(0)}}},[t._v("拒绝")]),e("el-button",{attrs:{size:"small",type:"primary"},on:{click:function(e){return t.submitAudit(1)}}},[t._v("通过")])],1)])],1)],1)},Wt=[];const Xt=new i["default"];var Jt={name:"SharePage",data(){return{isMobile:!1,email:"",tableData:[],currentPage:1,total:0,isDialogVisible:!1,isAccDialogVisible:!1,modalVisible:!1,modalTitle:"新增项目",currentIndex:null,activateFlag:!1,accountOpts:[],auditVisible:!1,auditValues:[],auditOptions:[],auditCarId:null,formData:{},shareFormData:{},formFields:[{id:"accountId",label:"账号",type:"select",value:"",required:!0,readonly:"1",options:[]},{id:"duration",label:"兑换时长(天)",type:"number",value:"",required:!0,readonly:!0},{id:"count",label:"兑换数量",type:"number",value:"",required:!0}],accountFields:[{id:"accountId",label:"账号",type:"select",value:"",required:!0,readonly:"1",options:[]},{id:"duration",label:"兑换时长(天)",type:"number",value:"",required:!0,readonly:!0},{id:"count",label:"兑换数量",type:"number",value:"",required:!0}],shareFields:[{id:"duration",label:"兑换时长(天)",type:"number",value:"",required:!0,readonly:!0}]}},methods:{checkIsMobile(){this.isMobile=window.innerWidth<=768},async jump(){Xt.$emit("envVariableChanged","jump")},async submitAudit(t){console.log("提交审核",this.auditCarId,this.auditValues);const e=await y.post(`${v.apiBaseUrl}/car/audit`,{accountId:this.auditCarId,allowApply:t,ids:this.auditValues},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).catch((function(t){k.error(t)}));e.data.status?(console.log("audit success"),k.success("审核成功")):k.error(e.data.message),this.auditVisible=!1,this.auditValues=[],this.auditCarId=null,this.fetchItems("")},async applyCar(t){const e=await y.post(`${v.apiBaseUrl}/car/apply`,{accountId:t},{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).catch((function(t){k.error(t)}));e.data.status?k.success("申请成功"):k.error(e.data.message),this.closeModal()},async fetchItems(t){try{const e=await y.get(`${v.apiBaseUrl}/car/list?page=`+this.currentPage+"&size=10&owner="+t,{withCredentials:!0,headers:{Authorization:"Bearer "+localStorage.getItem("token")}});e.data.status&&(this.tableData=e.data.data.data,this.total=e.data.data.total)}catch(e){k.error(e)}},handleUpdateValue(t,e){this.$set(this.formData,t,e);const a=this.formFields.findIndex((e=>e.id===t));-1!==a&&(this.formFields[a].value=e)},async showModal(t){console.log(this.auditVisible),this.auditVisible=!0,this.auditCarId=t;const e=await y.get(`${v.apiBaseUrl}/car/fetchApplies?accountId=`+this.auditCarId,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).catch((function(t){k.error(t)}));this.auditOptions=e.data.data},async contact(t){window.open("https://linux.do/u/"+t+"/summary")},closeModal(){this.modalVisible=!1,this.shareAddFlag=!1,this.currentIndex=null},async submitForm(){const t={...this.formData};if(this.currentIndex)t.id=this.currentIndex,t.duration=parseInt(t.duration),y.patch(`${v.apiBaseUrl}/redemption/update`,t,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).catch((function(t){k.error(t)}));else{console.log(t),t.accountId=parseInt(t.accountId),t.count=parseInt(t.count),t.duration=parseInt(t.duration);const e=await y.post(`${v.apiBaseUrl}/redemption/add`,t,{headers:{Authorization:"Bearer "+localStorage.getItem("token")}}).catch((function(t){k.error(t)}));e.data.status?k.success("新增成功"):k.error(e.data.message),this.closeModal()}this.fetchItems(""),this.closeModal()},resetFormFields(){this.shareAdd=!1,this.formData={},this.formFields.forEach((t=>{const e="checkbox"!==t.type&&"";t.value=e,this.formData[t.id]=e}))},emailQuery(){this.fetchItems(this.email)},handleCurrentChange(t){console.log(t),this.fetchItems("")},async handleSelectChange({type:t,field:e,value:a}){console.log(t,e,a)}},mounted(){this.fetchItems(""),this.checkIsMobile(),window.addEventListener("resize",this.checkIsMobile)},beforeDestroy(){window.removeEventListener("resize",this.checkIsMobile)}},Zt=Jt,te=(0,r.A)(Zt,Qt,Wt,!1,null,"2ded8af5",null),ee=te.exports,ae={components:{EnhancedDialog:ut,FormInput:lt},name:"NaviPage",data(){return{isMenuVisible:!1,touchStartX:0,touchStartY:0,swipeWidth:30,isMobile:!1,avatar:"img/linuxdo.webp",activeMenu:"accountNav",currentComponent:It,modalVisible:!1,itemData:"",modalTitle:"",isCollapse:!1,formFields:[{id:"code",label:"兑换码",type:"text",value:"",required:!0}]}},computed:{getSidebarWidth(){return this.isMobile?this.isCollapse?"0":"240px":this.isCollapse?"66px":"240px"}},methods:{toggleMenu(){this.isMenuVisible=!this.isMenuVisible},handleClickOutside(t){const e=document.querySelector(".user-menu-container");e&&!e.contains(t.target)&&(this.isMenuVisible=!1)},checkMobile(){this.isMobile=window.innerWidth<=768,this.isMobile&&(this.isCollapse=!0)},toggleCollapse(){this.isCollapse=!this.isCollapse},loadAvatar(){const t=localStorage.getItem("img");t&&(this.avatar=t)},handleUpdateValue(t,e){this.itemData=e;const a=this.formFields.findIndex((e=>e.id===t));-1!==a&&(this.formFields[a].value=e)},showModal(){this.modalTitle="兑换码激活",this.resetFormFields(),this.modalVisible=!0},closeModal(){this.modalVisible=!1},async submitForm(){const t=await y.get(`${v.apiBaseUrl}/redemption/activate?code=`+this.itemData,{withCredentials:!0,headers:{Authorization:"Bearer "+localStorage.getItem("token")}});t.data.status?(this.modalVisible=!1,k.success("兑换成功")):k.error(t.data.message)},resetFormFields(){this.formData={},this.formFields.forEach((t=>{const e="checkbox"!==t.type&&"";t.value=e,this.formData[t.id]=e}))},handleMenuSelect(t){switch(this.activeMenu=t,this.isMobile&&(this.isCollapse=!0),this.activeMenu=t,t){case"accountNav":this.currentComponent=It;break;case"shareNav":this.currentComponent=zt;break;case"redemptionNav":this.currentComponent=Ht;break;case"carNav":this.currentComponent=ee;break;case"freeNav":this.currentComponent=Nt;break;default:this.currentComponent=zt}},logout(){this.$router.replace({name:"home"}),localStorage.removeItem("token"),localStorage.removeItem("img")}},created(){this.loadAvatar(),Xt.$on("envVariableChanged",(t=>{switch(t){case"jump":this.currentComponent=Nt;break;case"car":this.currentComponent=ee;break}})),this.checkMobile(),window.addEventListener("resize",this.checkMobile),"undefined"!==typeof document&&(document.addEventListener("touchstart",this.handleTouchStart),document.addEventListener("touchend",this.handleTouchEnd))},destroyed(){window.removeEventListener("resize",this.checkMobile),"undefined"!==typeof document&&(document.removeEventListener("touchstart",this.handleTouchStart),document.removeEventListener("touchend",this.handleTouchEnd))},mounted(){document.addEventListener("click",this.handleClickOutside)},beforeDestroy(){document.removeEventListener("click",this.handleClickOutside)}},ie=ae,se=(0,r.A)(ie,J,Z,!1,null,"59f91b58",null),le=se.exports;i["default"].use(u.Ay);const oe=[{path:"/",component:A,name:"home",meta:{title:"首页"}},{path:"/account",component:It,name:"account",meta:{title:"账号管理"}},{path:"/share",component:zt,name:"share",meta:{title:"分享管理"}},{path:"/redemption",component:Ht,name:"redemption",meta:{title:"兑换码"}},{path:"/car",component:ee,name:"car",meta:{title:"停车场"}},{path:"/jump",component:Nt,name:"jump",meta:{title:"秋名山"}},{path:"/reset",component:B,name:"reset",meta:{title:"重置密码"}},{path:"/pandora",component:q,name:"pandora",meta:{title:"Pandora"}},{path:"/loading",component:R,name:"loading",meta:{title:"Loading"}},{path:"/claude",component:X,name:"claude",meta:{title:"Fuclaude"}},{path:"/navi",component:le,name:"navi",meta:{title:"Helper"}}],ne=new u.Ay({mode:"history",routes:oe});function re(t){let e=document.querySelector("link[rel~='icon']");e||(e=document.createElement("link"),e.rel="icon",document.getElementsByTagName("head")[0].appendChild(e)),e.href=t,e.type="iamge/svg+xml"}ne.beforeEach(((t,e,a)=>{t.meta.title?(document.title=t.meta.title,re("favicon.svg")):document.title="Pandora",a()}));var ce=ne;i["default"].use(w()),i["default"].config.productionTip=!1;const de={install(t){t.prototype.$config=v}};async function ue(){await g(),new i["default"]({render:t=>t(d),router:ce}).$mount("#app")}i["default"].use(de),ue()},7343:function(t,e,a){t.exports=a.p+"img/chatgpt.7fecc220.svg"},864:function(t,e,a){t.exports=a.p+"img/claude.b7c39d41.svg"},8902:function(t,e,a){t.exports=a.p+"img/ph--user-switch.8dbf8a86.svg"},4832:function(t,e,a){t.exports=a.p+"img/linuxdo.7bff183f.webp"}},e={};function a(i){var s=e[i];if(void 0!==s)return s.exports;var l=e[i]={id:i,loaded:!1,exports:{}};return t[i].call(l.exports,l,l.exports,a),l.loaded=!0,l.exports}a.m=t,function(){a.amdO={}}(),function(){var t=[];a.O=function(e,i,s,l){if(!i){var o=1/0;for(d=0;d<t.length;d++){i=t[d][0],s=t[d][1],l=t[d][2];for(var n=!0,r=0;r<i.length;r++)(!1&l||o>=l)&&Object.keys(a.O).every((function(t){return a.O[t](i[r])}))?i.splice(r--,1):(n=!1,l<o&&(o=l));if(n){t.splice(d--,1);var c=s();void 0!==c&&(e=c)}}return e}l=l||0;for(var d=t.length;d>0&&t[d-1][2]>l;d--)t[d]=t[d-1];t[d]=[i,s,l]}}(),function(){a.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return a.d(e,{a:e}),e}}(),function(){a.d=function(t,e){for(var i in e)a.o(e,i)&&!a.o(t,i)&&Object.defineProperty(t,i,{enumerable:!0,get:e[i]})}}(),function(){a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"===typeof window)return window}}()}(),function(){a.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}}(),function(){a.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}}(),function(){a.nmd=function(t){return t.paths=[],t.children||(t.children=[]),t}}(),function(){a.p="/"}(),function(){var t={524:0};a.O.j=function(e){return 0===t[e]};var e=function(e,i){var s,l,o=i[0],n=i[1],r=i[2],c=0;if(o.some((function(e){return 0!==t[e]}))){for(s in n)a.o(n,s)&&(a.m[s]=n[s]);if(r)var d=r(a)}for(e&&e(i);c<o.length;c++)l=o[c],a.o(t,l)&&t[l]&&t[l][0](),t[l]=0;return a.O(d)},i=self["webpackChunkpandora_helper"]=self["webpackChunkpandora_helper"]||[];i.forEach(e.bind(null,0)),i.push=e.bind(null,i.push.bind(i))}();var i=a.O(void 0,[504],(function(){return a(2248)}));i=a.O(i)})();
//# sourceMappingURL=app.fc9dbd06.js.map